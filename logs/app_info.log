2025-08-18 14:57:51,495 - INFO - src.config.logging - Logging configurado. Root level: DEBUG. Handlers: console, info_file, error_file
2025-08-18 14:57:51,495 - INFO - __main__ - Iniciando o backend de transferência de ficheiros...
2025-08-18 14:57:51,496 - INFO - src.services.provider_service - A buscar configurações de fornecedores ativos via ORM...
2025-08-18 14:57:51,683 - INFO - sqlalchemy.engine.Engine - select @@version
2025-08-18 14:57:51,684 - INFO - sqlalchemy.engine.Engine - [raw sql] {}
2025-08-18 14:57:51,701 - INFO - sqlalchemy.engine.Engine - SELECT schema_name()
2025-08-18 14:57:51,701 - INFO - sqlalchemy.engine.Engine - [generated in 0.00068s] {}
2025-08-18 14:57:51,774 - INFO - sqlalchemy.engine.Engine - SELECT CAST('test max support' AS NVARCHAR(max))
2025-08-18 14:57:51,774 - INFO - sqlalchemy.engine.Engine - [generated in 0.00203s] {}
2025-08-18 14:57:51,806 - INFO - sqlalchemy.engine.Engine - SELECT 1 FROM fn_listextendedproperty(default, default, default, default, default, default, default)
2025-08-18 14:57:51,806 - INFO - sqlalchemy.engine.Engine - [generated in 0.00042s] {}
2025-08-18 14:57:51,854 - INFO - sqlalchemy.engine.Engine - BEGIN (implicit)
2025-08-18 14:57:51,869 - INFO - sqlalchemy.engine.Engine - SELECT [MINP].[ZEDIPAR].[BPRNUM_0] AS [MINP_ZEDIPAR_BPRNUM_0], [MINP].[ZEDIPAR].[BPRNAM_0] AS [MINP_ZEDIPAR_BPRNAM_0], [MINP].[ZEDIPAR].[ENAFLG_0] AS [MINP_ZEDIPAR_ENAFLG_0], [MINP].[ZEDIPAR].[BPRID_0] AS [MINP_ZEDIPAR_BPRID_0], [MINP].[ZEDIPAR].[FTPFLG_0] AS [MINP_ZEDIPAR_FTPFLG_0], [MINP].[ZEDIPAR].[FTPTYP_0] AS [MINP_ZEDIPAR_FTPTYP_0], [MINP].[ZEDIPAR].[FTPURL_0] AS [MINP_ZEDIPAR_FTPURL_0], [MINP].[ZEDIPAR].[FTPUSR_0] AS [MINP_ZEDIPAR_FTPUSR_0], [MINP].[ZEDIPAR].[FTPPSW_0] AS [MINP_ZEDIPAR_FTPPSW_0], [MINP].[ZEDIPAR].[FTPMOD_0] AS [MINP_ZEDIPAR_FTPMOD_0], [MINP].[ZEDIPAR].[FTPINP_0] AS [MINP_ZEDIPAR_FTPINP_0], [MINP].[ZEDIPAR].[FTPOUT_0] AS [MINP_ZEDIPAR_FTPOUT_0], [MINP].[ZEDIPAR].[FTPFOR_0] AS [MINP_ZEDIPAR_FTPFOR_0], [MINP].[ZEDIPAR].[FTPTRT_0] AS [MINP_ZEDIPAR_FTPTRT_0], [MINP].[ZEDIPAR].[FTPFIC_0] AS [MINP_ZEDIPAR_FTPFIC_0], [MINP].[ZEDIPAR].[FTPEXP_0] AS [MINP_ZEDIPAR_FTPEXP_0], [MINP].[ZEDIPAR].[FTPUNI_0] AS [MINP_ZEDIPAR_FTPUNI_0], [MINP].[ZEDIPAR].[DRTINP_0] AS [MINP_ZEDIPAR_DRTINP_0], [MINP].[ZEDIPAR].[EXTINP_0] AS [MINP_ZEDIPAR_EXTINP_0], [MINP].[ZEDIPAR].[DRTOUT_0] AS [MINP_ZEDIPAR_DRTOUT_0], [MINP].[ZEDIPAR].[EXTOUT_0] AS [MINP_ZEDIPAR_EXTOUT_0], [MINP].[ZEDIPAR].[FICEXT_0] AS [MINP_ZEDIPAR_FICEXT_0], [MINP].[ZEDIPAR].[FICSEP_0] AS [MINP_ZEDIPAR_FICSEP_0], [MINP].[ZEDIPAR].[FICFLG_0] AS [MINP_ZEDIPAR_FICFLG_0], [MINP].[ZEDIPAR].[FICFLG_1] AS [MINP_ZEDIPAR_FICFLG_1], [MINP].[ZEDIPAR].[FICFLG_2] AS [MINP_ZEDIPAR_FICFLG_2], [MINP].[ZEDIPAR].[FICFLG_3] AS [MINP_ZEDIPAR_FICFLG_3], [MINP].[ZEDIPAR].[FICFLG_4] AS [MINP_ZEDIPAR_FICFLG_4], [MINP].[ZEDIPAR].[FICFLG_5] AS [MINP_ZEDIPAR_FICFLG_5], [MINP].[ZEDIPAR].[FICFLG_6] AS [MINP_ZEDIPAR_FICFLG_6], [MINP].[ZEDIPAR].[FICFLG_7] AS [MINP_ZEDIPAR_FICFLG_7], [MINP].[ZEDIPAR].[FICFLG_8] AS [MINP_ZEDIPAR_FICFLG_8], [MINP].[ZEDIPAR].[FICFLG_9] AS [MINP_ZEDIPAR_FICFLG_9], [MINP].[ZEDIPAR].[FICPRE_0] AS [MINP_ZEDIPAR_FICPRE_0], [MINP].[ZEDIPAR].[FICPRE_1] AS [MINP_ZEDIPAR_FICPRE_1], [MINP].[ZEDIPAR].[FICPRE_2] AS [MINP_ZEDIPAR_FICPRE_2], [MINP].[ZEDIPAR].[FICPRE_3] AS [MINP_ZEDIPAR_FICPRE_3], [MINP].[ZEDIPAR].[FICPRE_4] AS [MINP_ZEDIPAR_FICPRE_4], [MINP].[ZEDIPAR].[FICPRE_5] AS [MINP_ZEDIPAR_FICPRE_5], [MINP].[ZEDIPAR].[FICPRE_6] AS [MINP_ZEDIPAR_FICPRE_6], [MINP].[ZEDIPAR].[FICPRE_7] AS [MINP_ZEDIPAR_FICPRE_7], [MINP].[ZEDIPAR].[FICPRE_8] AS [MINP_ZEDIPAR_FICPRE_8], [MINP].[ZEDIPAR].[FICPRE_9] AS [MINP_ZEDIPAR_FICPRE_9], [MINP].[ZEDIPAR].[FICCOU_0] AS [MINP_ZEDIPAR_FICCOU_0], [MINP].[ZEDIPAR].[FICCOU_1] AS [MINP_ZEDIPAR_FICCOU_1], [MINP].[ZEDIPAR].[FICCOU_2] AS [MINP_ZEDIPAR_FICCOU_2], [MINP].[ZEDIPAR].[FICCOU_3] AS [MINP_ZEDIPAR_FICCOU_3], [MINP].[ZEDIPAR].[FICCOU_4] AS [MINP_ZEDIPAR_FICCOU_4], [MINP].[ZEDIPAR].[FICCOU_5] AS [MINP_ZEDIPAR_FICCOU_5], [MINP].[ZEDIPAR].[FICCOU_6] AS [MINP_ZEDIPAR_FICCOU_6], [MINP].[ZEDIPAR].[FICCOU_7] AS [MINP_ZEDIPAR_FICCOU_7], [MINP].[ZEDIPAR].[FICCOU_8] AS [MINP_ZEDIPAR_FICCOU_8], [MINP].[ZEDIPAR].[FICCOU_9] AS [MINP_ZEDIPAR_FICCOU_9], [MINP].[ZEDIPAR].[FICDES_0] AS [MINP_ZEDIPAR_FICDES_0], [MINP].[ZEDIPAR].[FICDES_1] AS [MINP_ZEDIPAR_FICDES_1], [MINP].[ZEDIPAR].[FICDES_2] AS [MINP_ZEDIPAR_FICDES_2], [MINP].[ZEDIPAR].[FICDES_3] AS [MINP_ZEDIPAR_FICDES_3], [MINP].[ZEDIPAR].[FICDES_4] AS [MINP_ZEDIPAR_FICDES_4], [MINP].[ZEDIPAR].[FICDES_5] AS [MINP_ZEDIPAR_FICDES_5], [MINP].[ZEDIPAR].[FICDES_6] AS [MINP_ZEDIPAR_FICDES_6], [MINP].[ZEDIPAR].[FICDES_7] AS [MINP_ZEDIPAR_FICDES_7], [MINP].[ZEDIPAR].[FICDES_8] AS [MINP_ZEDIPAR_FICDES_8], [MINP].[ZEDIPAR].[FICDES_9] AS [MINP_ZEDIPAR_FICDES_9], [MINP].[ZEDIPAR].[FICPRO_0] AS [MINP_ZEDIPAR_FICPRO_0], [MINP].[ZEDIPAR].[FICPRO_1] AS [MINP_ZEDIPAR_FICPRO_1], [MINP].[ZEDIPAR].[FICPRO_2] AS [MINP_ZEDIPAR_FICPRO_2], [MINP].[ZEDIPAR].[FICPRO_3] AS [MINP_ZEDIPAR_FICPRO_3], [MINP].[ZEDIPAR].[FICPRO_4] AS [MINP_ZEDIPAR_FICPRO_4], [MINP].[ZEDIPAR].[FICPRO_5] AS [MINP_ZEDIPAR_FICPRO_5], [MINP].[ZEDIPAR].[FICPRO_6] AS [MINP_ZEDIPAR_FICPRO_6], [MINP].[ZEDIPAR].[FICPRO_7] AS [MINP_ZEDIPAR_FICPRO_7], [MINP].[ZEDIPAR].[FICPRO_8] AS [MINP_ZEDIPAR_FICPRO_8], [MINP].[ZEDIPAR].[FICPRO_9] AS [MINP_ZEDIPAR_FICPRO_9], [MINP].[ZEDIPAR].[FICDIR_0] AS [MINP_ZEDIPAR_FICDIR_0], [MINP].[ZEDIPAR].[FICDIR_1] AS [MINP_ZEDIPAR_FICDIR_1], [MINP].[ZEDIPAR].[FICDIR_2] AS [MINP_ZEDIPAR_FICDIR_2], [MINP].[ZEDIPAR].[FICDIR_3] AS [MINP_ZEDIPAR_FICDIR_3], [MINP].[ZEDIPAR].[FICDIR_4] AS [MINP_ZEDIPAR_FICDIR_4], [MINP].[ZEDIPAR].[FICDIR_5] AS [MINP_ZEDIPAR_FICDIR_5], [MINP].[ZEDIPAR].[FICDIR_6] AS [MINP_ZEDIPAR_FICDIR_6], [MINP].[ZEDIPAR].[FICDIR_7] AS [MINP_ZEDIPAR_FICDIR_7], [MINP].[ZEDIPAR].[FICDIR_8] AS [MINP_ZEDIPAR_FICDIR_8], [MINP].[ZEDIPAR].[FICDIR_9] AS [MINP_ZEDIPAR_FICDIR_9], [MINP].[ZEDIPAR].[FICDAT_0] AS [MINP_ZEDIPAR_FICDAT_0], [MINP].[ZEDIPAR].[FICDAT_1] AS [MINP_ZEDIPAR_FICDAT_1], [MINP].[ZEDIPAR].[FICDAT_2] AS [MINP_ZEDIPAR_FICDAT_2], [MINP].[ZEDIPAR].[FICDAT_3] AS [MINP_ZEDIPAR_FICDAT_3], [MINP].[ZEDIPAR].[FICDAT_4] AS [MINP_ZEDIPAR_FICDAT_4], [MINP].[ZEDIPAR].[FICDAT_5] AS [MINP_ZEDIPAR_FICDAT_5], [MINP].[ZEDIPAR].[FICDAT_6] AS [MINP_ZEDIPAR_FICDAT_6], [MINP].[ZEDIPAR].[FICDAT_7] AS [MINP_ZEDIPAR_FICDAT_7], [MINP].[ZEDIPAR].[FICDAT_8] AS [MINP_ZEDIPAR_FICDAT_8], [MINP].[ZEDIPAR].[FICDAT_9] AS [MINP_ZEDIPAR_FICDAT_9], [MINP].[ZEDIPAR].[FICDEL_0] AS [MINP_ZEDIPAR_FICDEL_0], [MINP].[ZEDIPAR].[FICDEL_1] AS [MINP_ZEDIPAR_FICDEL_1], [MINP].[ZEDIPAR].[FICDEL_2] AS [MINP_ZEDIPAR_FICDEL_2], [MINP].[ZEDIPAR].[FICDEL_3] AS [MINP_ZEDIPAR_FICDEL_3], [MINP].[ZEDIPAR].[FICDEL_4] AS [MINP_ZEDIPAR_FICDEL_4], [MINP].[ZEDIPAR].[FICDEL_5] AS [MINP_ZEDIPAR_FICDEL_5], [MINP].[ZEDIPAR].[FICDEL_6] AS [MINP_ZEDIPAR_FICDEL_6], [MINP].[ZEDIPAR].[FICDEL_7] AS [MINP_ZEDIPAR_FICDEL_7], [MINP].[ZEDIPAR].[FICDEL_8] AS [MINP_ZEDIPAR_FICDEL_8], [MINP].[ZEDIPAR].[FICDEL_9] AS [MINP_ZEDIPAR_FICDEL_9], [MINP].[ZEDIPAR].[FICFOR_0] AS [MINP_ZEDIPAR_FICFOR_0], [MINP].[ZEDIPAR].[FICFOR_1] AS [MINP_ZEDIPAR_FICFOR_1], [MINP].[ZEDIPAR].[FICFOR_2] AS [MINP_ZEDIPAR_FICFOR_2], [MINP].[ZEDIPAR].[FICFOR_3] AS [MINP_ZEDIPAR_FICFOR_3], [MINP].[ZEDIPAR].[FICFOR_4] AS [MINP_ZEDIPAR_FICFOR_4], [MINP].[ZEDIPAR].[FICFOR_5] AS [MINP_ZEDIPAR_FICFOR_5], [MINP].[ZEDIPAR].[FICFOR_6] AS [MINP_ZEDIPAR_FICFOR_6], [MINP].[ZEDIPAR].[FICFOR_7] AS [MINP_ZEDIPAR_FICFOR_7], [MINP].[ZEDIPAR].[FICFOR_8] AS [MINP_ZEDIPAR_FICFOR_8], [MINP].[ZEDIPAR].[FICFOR_9] AS [MINP_ZEDIPAR_FICFOR_9], [MINP].[ZEDIPAR].[FICNUM_0] AS [MINP_ZEDIPAR_FICNUM_0], [MINP].[ZEDIPAR].[FICNUM_1] AS [MINP_ZEDIPAR_FICNUM_1], [MINP].[ZEDIPAR].[FICNUM_2] AS [MINP_ZEDIPAR_FICNUM_2], [MINP].[ZEDIPAR].[FICNUM_3] AS [MINP_ZEDIPAR_FICNUM_3], [MINP].[ZEDIPAR].[FICNUM_4] AS [MINP_ZEDIPAR_FICNUM_4], [MINP].[ZEDIPAR].[FICNUM_5] AS [MINP_ZEDIPAR_FICNUM_5], [MINP].[ZEDIPAR].[FICNUM_6] AS [MINP_ZEDIPAR_FICNUM_6], [MINP].[ZEDIPAR].[FICNUM_7] AS [MINP_ZEDIPAR_FICNUM_7], [MINP].[ZEDIPAR].[FICNUM_8] AS [MINP_ZEDIPAR_FICNUM_8], [MINP].[ZEDIPAR].[FICNUM_9] AS [MINP_ZEDIPAR_FICNUM_9], [MINP].[ZEDIPAR].[PEREDI_0] AS [MINP_ZEDIPAR_PEREDI_0], [MINP].[ZEDIPAR].[PEREDI_1] AS [MINP_ZEDIPAR_PEREDI_1], [MINP].[ZEDIPAR].[PEREDI_2] AS [MINP_ZEDIPAR_PEREDI_2], [MINP].[ZEDIPAR].[PEREDI_3] AS [MINP_ZEDIPAR_PEREDI_3], [MINP].[ZEDIPAR].[PEREDI_4] AS [MINP_ZEDIPAR_PEREDI_4], [MINP].[ZEDIPAR].[PEREDI_5] AS [MINP_ZEDIPAR_PEREDI_5], [MINP].[ZEDIPAR].[PEREDI_6] AS [MINP_ZEDIPAR_PEREDI_6], [MINP].[ZEDIPAR].[PEREDI_7] AS [MINP_ZEDIPAR_PEREDI_7], [MINP].[ZEDIPAR].[PEREDI_8] AS [MINP_ZEDIPAR_PEREDI_8], [MINP].[ZEDIPAR].[PEREDI_9] AS [MINP_ZEDIPAR_PEREDI_9], [MINP].[ZEDIPAR].[PERIODI_0] AS [MINP_ZEDIPAR_PERIODI_0], [MINP].[ZEDIPAR].[PERIODI_1] AS [MINP_ZEDIPAR_PERIODI_1], [MINP].[ZEDIPAR].[PERIODI_2] AS [MINP_ZEDIPAR_PERIODI_2], [MINP].[ZEDIPAR].[PERIODI_3] AS [MINP_ZEDIPAR_PERIODI_3], [MINP].[ZEDIPAR].[PERIODI_4] AS [MINP_ZEDIPAR_PERIODI_4], [MINP].[ZEDIPAR].[PERIODI_5] AS [MINP_ZEDIPAR_PERIODI_5], [MINP].[ZEDIPAR].[PERIODI_6] AS [MINP_ZEDIPAR_PERIODI_6], [MINP].[ZEDIPAR].[PERIODI_7] AS [MINP_ZEDIPAR_PERIODI_7], [MINP].[ZEDIPAR].[PERIODI_8] AS [MINP_ZEDIPAR_PERIODI_8], [MINP].[ZEDIPAR].[PERIODI_9] AS [MINP_ZEDIPAR_PERIODI_9], [MINP].[ZEDIPAR].[MDL_0] AS [MINP_ZEDIPAR_MDL_0], [MINP].[ZEDIPAR].[MDL_1] AS [MINP_ZEDIPAR_MDL_1], [MINP].[ZEDIPAR].[MDL_2] AS [MINP_ZEDIPAR_MDL_2], [MINP].[ZEDIPAR].[MDL_3] AS [MINP_ZEDIPAR_MDL_3], [MINP].[ZEDIPAR].[MDL_4] AS [MINP_ZEDIPAR_MDL_4], [MINP].[ZEDIPAR].[MDLTIM_0] AS [MINP_ZEDIPAR_MDLTIM_0], [MINP].[ZEDIPAR].[MDLTIM_1] AS [MINP_ZEDIPAR_MDLTIM_1], [MINP].[ZEDIPAR].[MDLTIM_2] AS [MINP_ZEDIPAR_MDLTIM_2], [MINP].[ZEDIPAR].[MDLTIM_3] AS [MINP_ZEDIPAR_MDLTIM_3], [MINP].[ZEDIPAR].[MDLTIM_4] AS [MINP_ZEDIPAR_MDLTIM_4], [MINP].[ZEDIPAR].[PUBGES_0] AS [MINP_ZEDIPAR_PUBGES_0], [MINP].[ZEDIPAR].[PUBANA_0] AS [MINP_ZEDIPAR_PUBANA_0], [MINP].[ZEDIPAR].[FLGBAS_0] AS [MINP_ZEDIPAR_FLGBAS_0], [MINP].[ZEDIPAR].[FLGQTY_0] AS [MINP_ZEDIPAR_FLGQTY_0], [MINP].[ZEDIPAR].[FLGNUM_0] AS [MINP_ZEDIPAR_FLGNUM_0], [MINP].[ZEDIPAR].[FLGXLS_0] AS [MINP_ZEDIPAR_FLGXLS_0], [MINP].[ZEDIPAR].[FLGPAC_0] AS [MINP_ZEDIPAR_FLGPAC_0], [MINP].[ZEDIPAR].[COLOR_0] AS [MINP_ZEDIPAR_COLOR_0], [MINP].[ZEDIPAR].[DSCBPS_0] AS [MINP_ZEDIPAR_DSCBPS_0], [MINP].[ZEDIPAR].[ROWID] AS [MINP_ZEDIPAR_ROWID], [MINP].[ZEDIPAR].[CREUSR_0] AS [MINP_ZEDIPAR_CREUSR_0], [MINP].[ZEDIPAR].[UPDUSR_0] AS [MINP_ZEDIPAR_UPDUSR_0], [MINP].[ZEDIPAR].[CREDATTIM_0] AS [MINP_ZEDIPAR_CREDATTIM_0], [MINP].[ZEDIPAR].[UPDDATTIM_0] AS [MINP_ZEDIPAR_UPDDATTIM_0], [MINP].[ZEDIPAR].[AUUID_0] AS [MINP_ZEDIPAR_AUUID_0], [MINP].[ZEDIPAR].[UPDTICK_0] AS [MINP_ZEDIPAR_UPDTICK_0] 
FROM [MINP].[ZEDIPAR] 
WHERE [MINP].[ZEDIPAR].[ENAFLG_0] = %(ENAFLG_0_1)s AND [MINP].[ZEDIPAR].[FTPFLG_0] = %(FTPFLG_0_1)s
2025-08-18 14:57:51,872 - INFO - sqlalchemy.engine.Engine - [generated in 0.00162s] {'ENAFLG_0_1': <YesNo.YES: 2>, 'FTPFLG_0_1': <YesNo.YES: 2>}
2025-08-18 14:57:51,899 - INFO - src.services.provider_service - Encontrados 1 fornecedores ativos.
2025-08-18 14:57:51,900 - INFO - sqlalchemy.engine.Engine - ROLLBACK
2025-08-18 14:57:51,943 - INFO - __main__ - Fornecedores carregados com sucesso:
2025-08-18 14:57:51,950 - INFO - src.services.transfer_service - A iniciar processamento para o fornecedor: 1510 com protocolo: 'FTP'
2025-08-18 14:58:06,175 - INFO - src.services.strategies - Fornecedor '1510' usará a classe de estratégia: MlpStrategy
2025-08-18 14:58:14,487 - INFO - src.transfer.ftp_manager - A conectar ao servidor FTP em export.mlp.fr:21...
2025-08-18 14:58:14,756 - INFO - src.transfer.ftp_manager - Conexão FTP com 'export.mlp.fr' estabelecida com sucesso.
2025-08-18 14:58:20,486 - INFO - src.services.strategies - [1510] Valor inválido na configuração da Tarefa 5: 0 is not a valid ImportExport. Ignorar tarefa.
2025-08-18 14:58:20,486 - INFO - src.services.strategies - [1510] Valor inválido na configuração da Tarefa 6: 0 is not a valid ImportExport. Ignorar tarefa.
2025-08-18 14:58:20,486 - INFO - src.services.strategies - [1510] Valor inválido na configuração da Tarefa 7: 0 is not a valid ImportExport. Ignorar tarefa.
2025-08-18 14:58:20,486 - INFO - src.services.strategies - [1510] Valor inválido na configuração da Tarefa 8: 0 is not a valid ImportExport. Ignorar tarefa.
2025-08-18 14:58:20,486 - INFO - src.services.strategies - [1510] Valor inválido na configuração da Tarefa 9: 0 is not a valid ImportExport. Ignorar tarefa.
2025-08-18 14:58:20,486 - INFO - src.services.strategies - [1510] Foram selecionadas 5 tarefas para execução.
2025-08-18 14:58:40,445 - INFO - src.services.strategies - [1510] A executar a estratégia: MlpStrategy
2025-08-18 14:58:47,816 - INFO - src.services.strategies - [1510] Tarefa 0 usará o padrão de ficheiro: 'R*'
2025-08-18 14:58:55,585 - INFO - src.services.strategies - [1510] A processar Tarefa 0: Direção=IMPORT/DOWNLOAD, Prefixo="R"
2025-08-18 16:33:16,932 - INFO - src.config.logging - Logging configurado. Root level: DEBUG. Handlers: console, info_file, error_file
2025-08-18 16:33:16,932 - INFO - __main__ - Iniciando o backend de transferência de ficheiros...
2025-08-18 16:33:16,932 - INFO - src.services.provider_service - A buscar configurações de fornecedores ativos via ORM...
2025-08-18 16:33:17,224 - INFO - sqlalchemy.engine.Engine - select @@version
2025-08-18 16:33:17,224 - INFO - sqlalchemy.engine.Engine - [raw sql] {}
2025-08-18 16:33:17,237 - INFO - sqlalchemy.engine.Engine - SELECT schema_name()
2025-08-18 16:33:17,237 - INFO - sqlalchemy.engine.Engine - [generated in 0.00087s] {}
2025-08-18 16:33:17,315 - INFO - sqlalchemy.engine.Engine - SELECT CAST('test max support' AS NVARCHAR(max))
2025-08-18 16:33:17,316 - INFO - sqlalchemy.engine.Engine - [generated in 0.00038s] {}
2025-08-18 16:33:17,334 - INFO - sqlalchemy.engine.Engine - SELECT 1 FROM fn_listextendedproperty(default, default, default, default, default, default, default)
2025-08-18 16:33:17,334 - INFO - sqlalchemy.engine.Engine - [generated in 0.00044s] {}
2025-08-18 16:33:17,392 - INFO - sqlalchemy.engine.Engine - BEGIN (implicit)
2025-08-18 16:33:17,402 - INFO - sqlalchemy.engine.Engine - SELECT [MINP].[ZEDIPAR].[BPRNUM_0] AS [MINP_ZEDIPAR_BPRNUM_0], [MINP].[ZEDIPAR].[BPRNAM_0] AS [MINP_ZEDIPAR_BPRNAM_0], [MINP].[ZEDIPAR].[ENAFLG_0] AS [MINP_ZEDIPAR_ENAFLG_0], [MINP].[ZEDIPAR].[BPRID_0] AS [MINP_ZEDIPAR_BPRID_0], [MINP].[ZEDIPAR].[FTPFLG_0] AS [MINP_ZEDIPAR_FTPFLG_0], [MINP].[ZEDIPAR].[FTPTYP_0] AS [MINP_ZEDIPAR_FTPTYP_0], [MINP].[ZEDIPAR].[FTPURL_0] AS [MINP_ZEDIPAR_FTPURL_0], [MINP].[ZEDIPAR].[FTPUSR_0] AS [MINP_ZEDIPAR_FTPUSR_0], [MINP].[ZEDIPAR].[FTPPSW_0] AS [MINP_ZEDIPAR_FTPPSW_0], [MINP].[ZEDIPAR].[FTPMOD_0] AS [MINP_ZEDIPAR_FTPMOD_0], [MINP].[ZEDIPAR].[FTPINP_0] AS [MINP_ZEDIPAR_FTPINP_0], [MINP].[ZEDIPAR].[FTPOUT_0] AS [MINP_ZEDIPAR_FTPOUT_0], [MINP].[ZEDIPAR].[FTPFOR_0] AS [MINP_ZEDIPAR_FTPFOR_0], [MINP].[ZEDIPAR].[FTPTRT_0] AS [MINP_ZEDIPAR_FTPTRT_0], [MINP].[ZEDIPAR].[FTPFIC_0] AS [MINP_ZEDIPAR_FTPFIC_0], [MINP].[ZEDIPAR].[FTPEXP_0] AS [MINP_ZEDIPAR_FTPEXP_0], [MINP].[ZEDIPAR].[FTPUNI_0] AS [MINP_ZEDIPAR_FTPUNI_0], [MINP].[ZEDIPAR].[DRTINP_0] AS [MINP_ZEDIPAR_DRTINP_0], [MINP].[ZEDIPAR].[EXTINP_0] AS [MINP_ZEDIPAR_EXTINP_0], [MINP].[ZEDIPAR].[DRTOUT_0] AS [MINP_ZEDIPAR_DRTOUT_0], [MINP].[ZEDIPAR].[EXTOUT_0] AS [MINP_ZEDIPAR_EXTOUT_0], [MINP].[ZEDIPAR].[FICEXT_0] AS [MINP_ZEDIPAR_FICEXT_0], [MINP].[ZEDIPAR].[FICSEP_0] AS [MINP_ZEDIPAR_FICSEP_0], [MINP].[ZEDIPAR].[FICFLG_0] AS [MINP_ZEDIPAR_FICFLG_0], [MINP].[ZEDIPAR].[FICFLG_1] AS [MINP_ZEDIPAR_FICFLG_1], [MINP].[ZEDIPAR].[FICFLG_2] AS [MINP_ZEDIPAR_FICFLG_2], [MINP].[ZEDIPAR].[FICFLG_3] AS [MINP_ZEDIPAR_FICFLG_3], [MINP].[ZEDIPAR].[FICFLG_4] AS [MINP_ZEDIPAR_FICFLG_4], [MINP].[ZEDIPAR].[FICFLG_5] AS [MINP_ZEDIPAR_FICFLG_5], [MINP].[ZEDIPAR].[FICFLG_6] AS [MINP_ZEDIPAR_FICFLG_6], [MINP].[ZEDIPAR].[FICFLG_7] AS [MINP_ZEDIPAR_FICFLG_7], [MINP].[ZEDIPAR].[FICFLG_8] AS [MINP_ZEDIPAR_FICFLG_8], [MINP].[ZEDIPAR].[FICFLG_9] AS [MINP_ZEDIPAR_FICFLG_9], [MINP].[ZEDIPAR].[FICPRE_0] AS [MINP_ZEDIPAR_FICPRE_0], [MINP].[ZEDIPAR].[FICPRE_1] AS [MINP_ZEDIPAR_FICPRE_1], [MINP].[ZEDIPAR].[FICPRE_2] AS [MINP_ZEDIPAR_FICPRE_2], [MINP].[ZEDIPAR].[FICPRE_3] AS [MINP_ZEDIPAR_FICPRE_3], [MINP].[ZEDIPAR].[FICPRE_4] AS [MINP_ZEDIPAR_FICPRE_4], [MINP].[ZEDIPAR].[FICPRE_5] AS [MINP_ZEDIPAR_FICPRE_5], [MINP].[ZEDIPAR].[FICPRE_6] AS [MINP_ZEDIPAR_FICPRE_6], [MINP].[ZEDIPAR].[FICPRE_7] AS [MINP_ZEDIPAR_FICPRE_7], [MINP].[ZEDIPAR].[FICPRE_8] AS [MINP_ZEDIPAR_FICPRE_8], [MINP].[ZEDIPAR].[FICPRE_9] AS [MINP_ZEDIPAR_FICPRE_9], [MINP].[ZEDIPAR].[FICCOU_0] AS [MINP_ZEDIPAR_FICCOU_0], [MINP].[ZEDIPAR].[FICCOU_1] AS [MINP_ZEDIPAR_FICCOU_1], [MINP].[ZEDIPAR].[FICCOU_2] AS [MINP_ZEDIPAR_FICCOU_2], [MINP].[ZEDIPAR].[FICCOU_3] AS [MINP_ZEDIPAR_FICCOU_3], [MINP].[ZEDIPAR].[FICCOU_4] AS [MINP_ZEDIPAR_FICCOU_4], [MINP].[ZEDIPAR].[FICCOU_5] AS [MINP_ZEDIPAR_FICCOU_5], [MINP].[ZEDIPAR].[FICCOU_6] AS [MINP_ZEDIPAR_FICCOU_6], [MINP].[ZEDIPAR].[FICCOU_7] AS [MINP_ZEDIPAR_FICCOU_7], [MINP].[ZEDIPAR].[FICCOU_8] AS [MINP_ZEDIPAR_FICCOU_8], [MINP].[ZEDIPAR].[FICCOU_9] AS [MINP_ZEDIPAR_FICCOU_9], [MINP].[ZEDIPAR].[FICDES_0] AS [MINP_ZEDIPAR_FICDES_0], [MINP].[ZEDIPAR].[FICDES_1] AS [MINP_ZEDIPAR_FICDES_1], [MINP].[ZEDIPAR].[FICDES_2] AS [MINP_ZEDIPAR_FICDES_2], [MINP].[ZEDIPAR].[FICDES_3] AS [MINP_ZEDIPAR_FICDES_3], [MINP].[ZEDIPAR].[FICDES_4] AS [MINP_ZEDIPAR_FICDES_4], [MINP].[ZEDIPAR].[FICDES_5] AS [MINP_ZEDIPAR_FICDES_5], [MINP].[ZEDIPAR].[FICDES_6] AS [MINP_ZEDIPAR_FICDES_6], [MINP].[ZEDIPAR].[FICDES_7] AS [MINP_ZEDIPAR_FICDES_7], [MINP].[ZEDIPAR].[FICDES_8] AS [MINP_ZEDIPAR_FICDES_8], [MINP].[ZEDIPAR].[FICDES_9] AS [MINP_ZEDIPAR_FICDES_9], [MINP].[ZEDIPAR].[FICPRO_0] AS [MINP_ZEDIPAR_FICPRO_0], [MINP].[ZEDIPAR].[FICPRO_1] AS [MINP_ZEDIPAR_FICPRO_1], [MINP].[ZEDIPAR].[FICPRO_2] AS [MINP_ZEDIPAR_FICPRO_2], [MINP].[ZEDIPAR].[FICPRO_3] AS [MINP_ZEDIPAR_FICPRO_3], [MINP].[ZEDIPAR].[FICPRO_4] AS [MINP_ZEDIPAR_FICPRO_4], [MINP].[ZEDIPAR].[FICPRO_5] AS [MINP_ZEDIPAR_FICPRO_5], [MINP].[ZEDIPAR].[FICPRO_6] AS [MINP_ZEDIPAR_FICPRO_6], [MINP].[ZEDIPAR].[FICPRO_7] AS [MINP_ZEDIPAR_FICPRO_7], [MINP].[ZEDIPAR].[FICPRO_8] AS [MINP_ZEDIPAR_FICPRO_8], [MINP].[ZEDIPAR].[FICPRO_9] AS [MINP_ZEDIPAR_FICPRO_9], [MINP].[ZEDIPAR].[FICDIR_0] AS [MINP_ZEDIPAR_FICDIR_0], [MINP].[ZEDIPAR].[FICDIR_1] AS [MINP_ZEDIPAR_FICDIR_1], [MINP].[ZEDIPAR].[FICDIR_2] AS [MINP_ZEDIPAR_FICDIR_2], [MINP].[ZEDIPAR].[FICDIR_3] AS [MINP_ZEDIPAR_FICDIR_3], [MINP].[ZEDIPAR].[FICDIR_4] AS [MINP_ZEDIPAR_FICDIR_4], [MINP].[ZEDIPAR].[FICDIR_5] AS [MINP_ZEDIPAR_FICDIR_5], [MINP].[ZEDIPAR].[FICDIR_6] AS [MINP_ZEDIPAR_FICDIR_6], [MINP].[ZEDIPAR].[FICDIR_7] AS [MINP_ZEDIPAR_FICDIR_7], [MINP].[ZEDIPAR].[FICDIR_8] AS [MINP_ZEDIPAR_FICDIR_8], [MINP].[ZEDIPAR].[FICDIR_9] AS [MINP_ZEDIPAR_FICDIR_9], [MINP].[ZEDIPAR].[FICDAT_0] AS [MINP_ZEDIPAR_FICDAT_0], [MINP].[ZEDIPAR].[FICDAT_1] AS [MINP_ZEDIPAR_FICDAT_1], [MINP].[ZEDIPAR].[FICDAT_2] AS [MINP_ZEDIPAR_FICDAT_2], [MINP].[ZEDIPAR].[FICDAT_3] AS [MINP_ZEDIPAR_FICDAT_3], [MINP].[ZEDIPAR].[FICDAT_4] AS [MINP_ZEDIPAR_FICDAT_4], [MINP].[ZEDIPAR].[FICDAT_5] AS [MINP_ZEDIPAR_FICDAT_5], [MINP].[ZEDIPAR].[FICDAT_6] AS [MINP_ZEDIPAR_FICDAT_6], [MINP].[ZEDIPAR].[FICDAT_7] AS [MINP_ZEDIPAR_FICDAT_7], [MINP].[ZEDIPAR].[FICDAT_8] AS [MINP_ZEDIPAR_FICDAT_8], [MINP].[ZEDIPAR].[FICDAT_9] AS [MINP_ZEDIPAR_FICDAT_9], [MINP].[ZEDIPAR].[FICDEL_0] AS [MINP_ZEDIPAR_FICDEL_0], [MINP].[ZEDIPAR].[FICDEL_1] AS [MINP_ZEDIPAR_FICDEL_1], [MINP].[ZEDIPAR].[FICDEL_2] AS [MINP_ZEDIPAR_FICDEL_2], [MINP].[ZEDIPAR].[FICDEL_3] AS [MINP_ZEDIPAR_FICDEL_3], [MINP].[ZEDIPAR].[FICDEL_4] AS [MINP_ZEDIPAR_FICDEL_4], [MINP].[ZEDIPAR].[FICDEL_5] AS [MINP_ZEDIPAR_FICDEL_5], [MINP].[ZEDIPAR].[FICDEL_6] AS [MINP_ZEDIPAR_FICDEL_6], [MINP].[ZEDIPAR].[FICDEL_7] AS [MINP_ZEDIPAR_FICDEL_7], [MINP].[ZEDIPAR].[FICDEL_8] AS [MINP_ZEDIPAR_FICDEL_8], [MINP].[ZEDIPAR].[FICDEL_9] AS [MINP_ZEDIPAR_FICDEL_9], [MINP].[ZEDIPAR].[FICFOR_0] AS [MINP_ZEDIPAR_FICFOR_0], [MINP].[ZEDIPAR].[FICFOR_1] AS [MINP_ZEDIPAR_FICFOR_1], [MINP].[ZEDIPAR].[FICFOR_2] AS [MINP_ZEDIPAR_FICFOR_2], [MINP].[ZEDIPAR].[FICFOR_3] AS [MINP_ZEDIPAR_FICFOR_3], [MINP].[ZEDIPAR].[FICFOR_4] AS [MINP_ZEDIPAR_FICFOR_4], [MINP].[ZEDIPAR].[FICFOR_5] AS [MINP_ZEDIPAR_FICFOR_5], [MINP].[ZEDIPAR].[FICFOR_6] AS [MINP_ZEDIPAR_FICFOR_6], [MINP].[ZEDIPAR].[FICFOR_7] AS [MINP_ZEDIPAR_FICFOR_7], [MINP].[ZEDIPAR].[FICFOR_8] AS [MINP_ZEDIPAR_FICFOR_8], [MINP].[ZEDIPAR].[FICFOR_9] AS [MINP_ZEDIPAR_FICFOR_9], [MINP].[ZEDIPAR].[FICNUM_0] AS [MINP_ZEDIPAR_FICNUM_0], [MINP].[ZEDIPAR].[FICNUM_1] AS [MINP_ZEDIPAR_FICNUM_1], [MINP].[ZEDIPAR].[FICNUM_2] AS [MINP_ZEDIPAR_FICNUM_2], [MINP].[ZEDIPAR].[FICNUM_3] AS [MINP_ZEDIPAR_FICNUM_3], [MINP].[ZEDIPAR].[FICNUM_4] AS [MINP_ZEDIPAR_FICNUM_4], [MINP].[ZEDIPAR].[FICNUM_5] AS [MINP_ZEDIPAR_FICNUM_5], [MINP].[ZEDIPAR].[FICNUM_6] AS [MINP_ZEDIPAR_FICNUM_6], [MINP].[ZEDIPAR].[FICNUM_7] AS [MINP_ZEDIPAR_FICNUM_7], [MINP].[ZEDIPAR].[FICNUM_8] AS [MINP_ZEDIPAR_FICNUM_8], [MINP].[ZEDIPAR].[FICNUM_9] AS [MINP_ZEDIPAR_FICNUM_9], [MINP].[ZEDIPAR].[PEREDI_0] AS [MINP_ZEDIPAR_PEREDI_0], [MINP].[ZEDIPAR].[PEREDI_1] AS [MINP_ZEDIPAR_PEREDI_1], [MINP].[ZEDIPAR].[PEREDI_2] AS [MINP_ZEDIPAR_PEREDI_2], [MINP].[ZEDIPAR].[PEREDI_3] AS [MINP_ZEDIPAR_PEREDI_3], [MINP].[ZEDIPAR].[PEREDI_4] AS [MINP_ZEDIPAR_PEREDI_4], [MINP].[ZEDIPAR].[PEREDI_5] AS [MINP_ZEDIPAR_PEREDI_5], [MINP].[ZEDIPAR].[PEREDI_6] AS [MINP_ZEDIPAR_PEREDI_6], [MINP].[ZEDIPAR].[PEREDI_7] AS [MINP_ZEDIPAR_PEREDI_7], [MINP].[ZEDIPAR].[PEREDI_8] AS [MINP_ZEDIPAR_PEREDI_8], [MINP].[ZEDIPAR].[PEREDI_9] AS [MINP_ZEDIPAR_PEREDI_9], [MINP].[ZEDIPAR].[PERIODI_0] AS [MINP_ZEDIPAR_PERIODI_0], [MINP].[ZEDIPAR].[PERIODI_1] AS [MINP_ZEDIPAR_PERIODI_1], [MINP].[ZEDIPAR].[PERIODI_2] AS [MINP_ZEDIPAR_PERIODI_2], [MINP].[ZEDIPAR].[PERIODI_3] AS [MINP_ZEDIPAR_PERIODI_3], [MINP].[ZEDIPAR].[PERIODI_4] AS [MINP_ZEDIPAR_PERIODI_4], [MINP].[ZEDIPAR].[PERIODI_5] AS [MINP_ZEDIPAR_PERIODI_5], [MINP].[ZEDIPAR].[PERIODI_6] AS [MINP_ZEDIPAR_PERIODI_6], [MINP].[ZEDIPAR].[PERIODI_7] AS [MINP_ZEDIPAR_PERIODI_7], [MINP].[ZEDIPAR].[PERIODI_8] AS [MINP_ZEDIPAR_PERIODI_8], [MINP].[ZEDIPAR].[PERIODI_9] AS [MINP_ZEDIPAR_PERIODI_9], [MINP].[ZEDIPAR].[MDL_0] AS [MINP_ZEDIPAR_MDL_0], [MINP].[ZEDIPAR].[MDL_1] AS [MINP_ZEDIPAR_MDL_1], [MINP].[ZEDIPAR].[MDL_2] AS [MINP_ZEDIPAR_MDL_2], [MINP].[ZEDIPAR].[MDL_3] AS [MINP_ZEDIPAR_MDL_3], [MINP].[ZEDIPAR].[MDL_4] AS [MINP_ZEDIPAR_MDL_4], [MINP].[ZEDIPAR].[MDLTIM_0] AS [MINP_ZEDIPAR_MDLTIM_0], [MINP].[ZEDIPAR].[MDLTIM_1] AS [MINP_ZEDIPAR_MDLTIM_1], [MINP].[ZEDIPAR].[MDLTIM_2] AS [MINP_ZEDIPAR_MDLTIM_2], [MINP].[ZEDIPAR].[MDLTIM_3] AS [MINP_ZEDIPAR_MDLTIM_3], [MINP].[ZEDIPAR].[MDLTIM_4] AS [MINP_ZEDIPAR_MDLTIM_4], [MINP].[ZEDIPAR].[PUBGES_0] AS [MINP_ZEDIPAR_PUBGES_0], [MINP].[ZEDIPAR].[PUBANA_0] AS [MINP_ZEDIPAR_PUBANA_0], [MINP].[ZEDIPAR].[FLGBAS_0] AS [MINP_ZEDIPAR_FLGBAS_0], [MINP].[ZEDIPAR].[FLGQTY_0] AS [MINP_ZEDIPAR_FLGQTY_0], [MINP].[ZEDIPAR].[FLGNUM_0] AS [MINP_ZEDIPAR_FLGNUM_0], [MINP].[ZEDIPAR].[FLGXLS_0] AS [MINP_ZEDIPAR_FLGXLS_0], [MINP].[ZEDIPAR].[FLGPAC_0] AS [MINP_ZEDIPAR_FLGPAC_0], [MINP].[ZEDIPAR].[COLOR_0] AS [MINP_ZEDIPAR_COLOR_0], [MINP].[ZEDIPAR].[DSCBPS_0] AS [MINP_ZEDIPAR_DSCBPS_0], [MINP].[ZEDIPAR].[ROWID] AS [MINP_ZEDIPAR_ROWID], [MINP].[ZEDIPAR].[CREUSR_0] AS [MINP_ZEDIPAR_CREUSR_0], [MINP].[ZEDIPAR].[UPDUSR_0] AS [MINP_ZEDIPAR_UPDUSR_0], [MINP].[ZEDIPAR].[CREDATTIM_0] AS [MINP_ZEDIPAR_CREDATTIM_0], [MINP].[ZEDIPAR].[UPDDATTIM_0] AS [MINP_ZEDIPAR_UPDDATTIM_0], [MINP].[ZEDIPAR].[AUUID_0] AS [MINP_ZEDIPAR_AUUID_0], [MINP].[ZEDIPAR].[UPDTICK_0] AS [MINP_ZEDIPAR_UPDTICK_0] 
FROM [MINP].[ZEDIPAR] 
WHERE [MINP].[ZEDIPAR].[ENAFLG_0] = %(ENAFLG_0_1)s AND [MINP].[ZEDIPAR].[FTPFLG_0] = %(FTPFLG_0_1)s
2025-08-18 16:33:17,402 - INFO - sqlalchemy.engine.Engine - [generated in 0.00148s] {'ENAFLG_0_1': <YesNo.YES: 2>, 'FTPFLG_0_1': <YesNo.YES: 2>}
2025-08-18 16:33:17,433 - INFO - src.services.provider_service - Encontrados 1 fornecedores ativos.
2025-08-18 16:33:17,433 - INFO - sqlalchemy.engine.Engine - ROLLBACK
2025-08-18 16:33:17,483 - INFO - __main__ - Fornecedores carregados com sucesso:
2025-08-18 16:33:17,483 - INFO - src.services.transfer_service - A iniciar processamento para o fornecedor: 1510 com protocolo: 'FTP'
2025-08-18 16:33:29,489 - INFO - src.services.strategies - Fornecedor '1510' usará a classe de estratégia: MlpStrategy
2025-08-18 16:33:35,888 - INFO - src.transfer.ftp_manager - A conectar ao servidor FTP em export.mlp.fr:21...
2025-08-18 16:33:36,089 - INFO - src.transfer.ftp_manager - Conexão FTP com 'export.mlp.fr' estabelecida com sucesso.
2025-08-18 16:33:39,315 - INFO - src.services.strategies - [1510] Valor inválido na configuração da Tarefa 5: 0 is not a valid ImportExport. Ignorar tarefa.
2025-08-18 16:33:39,315 - INFO - src.services.strategies - [1510] Valor inválido na configuração da Tarefa 6: 0 is not a valid ImportExport. Ignorar tarefa.
2025-08-18 16:33:39,315 - INFO - src.services.strategies - [1510] Valor inválido na configuração da Tarefa 7: 0 is not a valid ImportExport. Ignorar tarefa.
2025-08-18 16:33:39,315 - INFO - src.services.strategies - [1510] Valor inválido na configuração da Tarefa 8: 0 is not a valid ImportExport. Ignorar tarefa.
2025-08-18 16:33:39,315 - INFO - src.services.strategies - [1510] Valor inválido na configuração da Tarefa 9: 0 is not a valid ImportExport. Ignorar tarefa.
2025-08-18 16:33:39,315 - INFO - src.services.strategies - [1510] Foram selecionadas 5 tarefas para execução.
2025-08-18 16:33:49,828 - INFO - src.services.strategies - [1510] A executar a estratégia: MlpStrategy
2025-08-18 16:34:02,224 - INFO - src.services.strategies - [1510][MLP] Processar ficheiros para a 20250818 com o prefixo "R".
2025-08-18 16:34:23,024 - INFO - src.services.strategies - [1510] A processar Tarefa 0: Direção=IMPORT/DOWNLOAD, Prefixo="R"
2025-08-18 16:35:41,966 - INFO - src.transfer.ftp_manager - Listar ficheiros em '/Input'...
2025-08-18 16:36:04,111 - INFO - src.services.strategies - [1510] Tarefa 0: Nenhum ficheiro encontrado em /Input com o prefixo "R".
2025-08-18 16:36:12,472 - INFO - src.services.strategies - [1510][MLP] Processar ficheiros para a 20250818 com o prefixo "E".
2025-08-18 16:36:20,822 - INFO - src.services.strategies - [1510] A processar Tarefa 1: Direção=IMPORT/DOWNLOAD, Prefixo="E"
2025-08-18 16:45:56,652 - INFO - src.config.logging - Logging configurado. Root level: DEBUG. Handlers: console, info_file, error_file
2025-08-18 16:45:56,654 - INFO - __main__ - Iniciando o backend de transferência de ficheiros...
2025-08-18 16:45:56,655 - INFO - src.services.provider_service - A buscar configurações de fornecedores ativos via ORM...
2025-08-18 16:45:56,855 - INFO - sqlalchemy.engine.Engine - select @@version
2025-08-18 16:45:56,855 - INFO - sqlalchemy.engine.Engine - [raw sql] {}
2025-08-18 16:45:56,868 - INFO - sqlalchemy.engine.Engine - SELECT schema_name()
2025-08-18 16:45:56,868 - INFO - sqlalchemy.engine.Engine - [generated in 0.00053s] {}
2025-08-18 16:45:56,946 - INFO - sqlalchemy.engine.Engine - SELECT CAST('test max support' AS NVARCHAR(max))
2025-08-18 16:45:56,946 - INFO - sqlalchemy.engine.Engine - [generated in 0.00106s] {}
2025-08-18 16:45:56,973 - INFO - sqlalchemy.engine.Engine - SELECT 1 FROM fn_listextendedproperty(default, default, default, default, default, default, default)
2025-08-18 16:45:56,973 - INFO - sqlalchemy.engine.Engine - [generated in 0.00055s] {}
2025-08-18 16:45:57,023 - INFO - sqlalchemy.engine.Engine - BEGIN (implicit)
2025-08-18 16:45:57,036 - INFO - sqlalchemy.engine.Engine - SELECT [MINP].[ZEDIPAR].[BPRNUM_0] AS [MINP_ZEDIPAR_BPRNUM_0], [MINP].[ZEDIPAR].[BPRNAM_0] AS [MINP_ZEDIPAR_BPRNAM_0], [MINP].[ZEDIPAR].[ENAFLG_0] AS [MINP_ZEDIPAR_ENAFLG_0], [MINP].[ZEDIPAR].[BPRID_0] AS [MINP_ZEDIPAR_BPRID_0], [MINP].[ZEDIPAR].[FTPFLG_0] AS [MINP_ZEDIPAR_FTPFLG_0], [MINP].[ZEDIPAR].[FTPTYP_0] AS [MINP_ZEDIPAR_FTPTYP_0], [MINP].[ZEDIPAR].[FTPURL_0] AS [MINP_ZEDIPAR_FTPURL_0], [MINP].[ZEDIPAR].[FTPUSR_0] AS [MINP_ZEDIPAR_FTPUSR_0], [MINP].[ZEDIPAR].[FTPPSW_0] AS [MINP_ZEDIPAR_FTPPSW_0], [MINP].[ZEDIPAR].[FTPMOD_0] AS [MINP_ZEDIPAR_FTPMOD_0], [MINP].[ZEDIPAR].[FTPINP_0] AS [MINP_ZEDIPAR_FTPINP_0], [MINP].[ZEDIPAR].[FTPOUT_0] AS [MINP_ZEDIPAR_FTPOUT_0], [MINP].[ZEDIPAR].[FTPFOR_0] AS [MINP_ZEDIPAR_FTPFOR_0], [MINP].[ZEDIPAR].[FTPTRT_0] AS [MINP_ZEDIPAR_FTPTRT_0], [MINP].[ZEDIPAR].[FTPFIC_0] AS [MINP_ZEDIPAR_FTPFIC_0], [MINP].[ZEDIPAR].[FTPEXP_0] AS [MINP_ZEDIPAR_FTPEXP_0], [MINP].[ZEDIPAR].[FTPUNI_0] AS [MINP_ZEDIPAR_FTPUNI_0], [MINP].[ZEDIPAR].[DRTINP_0] AS [MINP_ZEDIPAR_DRTINP_0], [MINP].[ZEDIPAR].[EXTINP_0] AS [MINP_ZEDIPAR_EXTINP_0], [MINP].[ZEDIPAR].[DRTOUT_0] AS [MINP_ZEDIPAR_DRTOUT_0], [MINP].[ZEDIPAR].[EXTOUT_0] AS [MINP_ZEDIPAR_EXTOUT_0], [MINP].[ZEDIPAR].[FICEXT_0] AS [MINP_ZEDIPAR_FICEXT_0], [MINP].[ZEDIPAR].[FICSEP_0] AS [MINP_ZEDIPAR_FICSEP_0], [MINP].[ZEDIPAR].[FICFLG_0] AS [MINP_ZEDIPAR_FICFLG_0], [MINP].[ZEDIPAR].[FICFLG_1] AS [MINP_ZEDIPAR_FICFLG_1], [MINP].[ZEDIPAR].[FICFLG_2] AS [MINP_ZEDIPAR_FICFLG_2], [MINP].[ZEDIPAR].[FICFLG_3] AS [MINP_ZEDIPAR_FICFLG_3], [MINP].[ZEDIPAR].[FICFLG_4] AS [MINP_ZEDIPAR_FICFLG_4], [MINP].[ZEDIPAR].[FICFLG_5] AS [MINP_ZEDIPAR_FICFLG_5], [MINP].[ZEDIPAR].[FICFLG_6] AS [MINP_ZEDIPAR_FICFLG_6], [MINP].[ZEDIPAR].[FICFLG_7] AS [MINP_ZEDIPAR_FICFLG_7], [MINP].[ZEDIPAR].[FICFLG_8] AS [MINP_ZEDIPAR_FICFLG_8], [MINP].[ZEDIPAR].[FICFLG_9] AS [MINP_ZEDIPAR_FICFLG_9], [MINP].[ZEDIPAR].[FICPRE_0] AS [MINP_ZEDIPAR_FICPRE_0], [MINP].[ZEDIPAR].[FICPRE_1] AS [MINP_ZEDIPAR_FICPRE_1], [MINP].[ZEDIPAR].[FICPRE_2] AS [MINP_ZEDIPAR_FICPRE_2], [MINP].[ZEDIPAR].[FICPRE_3] AS [MINP_ZEDIPAR_FICPRE_3], [MINP].[ZEDIPAR].[FICPRE_4] AS [MINP_ZEDIPAR_FICPRE_4], [MINP].[ZEDIPAR].[FICPRE_5] AS [MINP_ZEDIPAR_FICPRE_5], [MINP].[ZEDIPAR].[FICPRE_6] AS [MINP_ZEDIPAR_FICPRE_6], [MINP].[ZEDIPAR].[FICPRE_7] AS [MINP_ZEDIPAR_FICPRE_7], [MINP].[ZEDIPAR].[FICPRE_8] AS [MINP_ZEDIPAR_FICPRE_8], [MINP].[ZEDIPAR].[FICPRE_9] AS [MINP_ZEDIPAR_FICPRE_9], [MINP].[ZEDIPAR].[FICCOU_0] AS [MINP_ZEDIPAR_FICCOU_0], [MINP].[ZEDIPAR].[FICCOU_1] AS [MINP_ZEDIPAR_FICCOU_1], [MINP].[ZEDIPAR].[FICCOU_2] AS [MINP_ZEDIPAR_FICCOU_2], [MINP].[ZEDIPAR].[FICCOU_3] AS [MINP_ZEDIPAR_FICCOU_3], [MINP].[ZEDIPAR].[FICCOU_4] AS [MINP_ZEDIPAR_FICCOU_4], [MINP].[ZEDIPAR].[FICCOU_5] AS [MINP_ZEDIPAR_FICCOU_5], [MINP].[ZEDIPAR].[FICCOU_6] AS [MINP_ZEDIPAR_FICCOU_6], [MINP].[ZEDIPAR].[FICCOU_7] AS [MINP_ZEDIPAR_FICCOU_7], [MINP].[ZEDIPAR].[FICCOU_8] AS [MINP_ZEDIPAR_FICCOU_8], [MINP].[ZEDIPAR].[FICCOU_9] AS [MINP_ZEDIPAR_FICCOU_9], [MINP].[ZEDIPAR].[FICDES_0] AS [MINP_ZEDIPAR_FICDES_0], [MINP].[ZEDIPAR].[FICDES_1] AS [MINP_ZEDIPAR_FICDES_1], [MINP].[ZEDIPAR].[FICDES_2] AS [MINP_ZEDIPAR_FICDES_2], [MINP].[ZEDIPAR].[FICDES_3] AS [MINP_ZEDIPAR_FICDES_3], [MINP].[ZEDIPAR].[FICDES_4] AS [MINP_ZEDIPAR_FICDES_4], [MINP].[ZEDIPAR].[FICDES_5] AS [MINP_ZEDIPAR_FICDES_5], [MINP].[ZEDIPAR].[FICDES_6] AS [MINP_ZEDIPAR_FICDES_6], [MINP].[ZEDIPAR].[FICDES_7] AS [MINP_ZEDIPAR_FICDES_7], [MINP].[ZEDIPAR].[FICDES_8] AS [MINP_ZEDIPAR_FICDES_8], [MINP].[ZEDIPAR].[FICDES_9] AS [MINP_ZEDIPAR_FICDES_9], [MINP].[ZEDIPAR].[FICPRO_0] AS [MINP_ZEDIPAR_FICPRO_0], [MINP].[ZEDIPAR].[FICPRO_1] AS [MINP_ZEDIPAR_FICPRO_1], [MINP].[ZEDIPAR].[FICPRO_2] AS [MINP_ZEDIPAR_FICPRO_2], [MINP].[ZEDIPAR].[FICPRO_3] AS [MINP_ZEDIPAR_FICPRO_3], [MINP].[ZEDIPAR].[FICPRO_4] AS [MINP_ZEDIPAR_FICPRO_4], [MINP].[ZEDIPAR].[FICPRO_5] AS [MINP_ZEDIPAR_FICPRO_5], [MINP].[ZEDIPAR].[FICPRO_6] AS [MINP_ZEDIPAR_FICPRO_6], [MINP].[ZEDIPAR].[FICPRO_7] AS [MINP_ZEDIPAR_FICPRO_7], [MINP].[ZEDIPAR].[FICPRO_8] AS [MINP_ZEDIPAR_FICPRO_8], [MINP].[ZEDIPAR].[FICPRO_9] AS [MINP_ZEDIPAR_FICPRO_9], [MINP].[ZEDIPAR].[FICDIR_0] AS [MINP_ZEDIPAR_FICDIR_0], [MINP].[ZEDIPAR].[FICDIR_1] AS [MINP_ZEDIPAR_FICDIR_1], [MINP].[ZEDIPAR].[FICDIR_2] AS [MINP_ZEDIPAR_FICDIR_2], [MINP].[ZEDIPAR].[FICDIR_3] AS [MINP_ZEDIPAR_FICDIR_3], [MINP].[ZEDIPAR].[FICDIR_4] AS [MINP_ZEDIPAR_FICDIR_4], [MINP].[ZEDIPAR].[FICDIR_5] AS [MINP_ZEDIPAR_FICDIR_5], [MINP].[ZEDIPAR].[FICDIR_6] AS [MINP_ZEDIPAR_FICDIR_6], [MINP].[ZEDIPAR].[FICDIR_7] AS [MINP_ZEDIPAR_FICDIR_7], [MINP].[ZEDIPAR].[FICDIR_8] AS [MINP_ZEDIPAR_FICDIR_8], [MINP].[ZEDIPAR].[FICDIR_9] AS [MINP_ZEDIPAR_FICDIR_9], [MINP].[ZEDIPAR].[FICDAT_0] AS [MINP_ZEDIPAR_FICDAT_0], [MINP].[ZEDIPAR].[FICDAT_1] AS [MINP_ZEDIPAR_FICDAT_1], [MINP].[ZEDIPAR].[FICDAT_2] AS [MINP_ZEDIPAR_FICDAT_2], [MINP].[ZEDIPAR].[FICDAT_3] AS [MINP_ZEDIPAR_FICDAT_3], [MINP].[ZEDIPAR].[FICDAT_4] AS [MINP_ZEDIPAR_FICDAT_4], [MINP].[ZEDIPAR].[FICDAT_5] AS [MINP_ZEDIPAR_FICDAT_5], [MINP].[ZEDIPAR].[FICDAT_6] AS [MINP_ZEDIPAR_FICDAT_6], [MINP].[ZEDIPAR].[FICDAT_7] AS [MINP_ZEDIPAR_FICDAT_7], [MINP].[ZEDIPAR].[FICDAT_8] AS [MINP_ZEDIPAR_FICDAT_8], [MINP].[ZEDIPAR].[FICDAT_9] AS [MINP_ZEDIPAR_FICDAT_9], [MINP].[ZEDIPAR].[FICDEL_0] AS [MINP_ZEDIPAR_FICDEL_0], [MINP].[ZEDIPAR].[FICDEL_1] AS [MINP_ZEDIPAR_FICDEL_1], [MINP].[ZEDIPAR].[FICDEL_2] AS [MINP_ZEDIPAR_FICDEL_2], [MINP].[ZEDIPAR].[FICDEL_3] AS [MINP_ZEDIPAR_FICDEL_3], [MINP].[ZEDIPAR].[FICDEL_4] AS [MINP_ZEDIPAR_FICDEL_4], [MINP].[ZEDIPAR].[FICDEL_5] AS [MINP_ZEDIPAR_FICDEL_5], [MINP].[ZEDIPAR].[FICDEL_6] AS [MINP_ZEDIPAR_FICDEL_6], [MINP].[ZEDIPAR].[FICDEL_7] AS [MINP_ZEDIPAR_FICDEL_7], [MINP].[ZEDIPAR].[FICDEL_8] AS [MINP_ZEDIPAR_FICDEL_8], [MINP].[ZEDIPAR].[FICDEL_9] AS [MINP_ZEDIPAR_FICDEL_9], [MINP].[ZEDIPAR].[FICFOR_0] AS [MINP_ZEDIPAR_FICFOR_0], [MINP].[ZEDIPAR].[FICFOR_1] AS [MINP_ZEDIPAR_FICFOR_1], [MINP].[ZEDIPAR].[FICFOR_2] AS [MINP_ZEDIPAR_FICFOR_2], [MINP].[ZEDIPAR].[FICFOR_3] AS [MINP_ZEDIPAR_FICFOR_3], [MINP].[ZEDIPAR].[FICFOR_4] AS [MINP_ZEDIPAR_FICFOR_4], [MINP].[ZEDIPAR].[FICFOR_5] AS [MINP_ZEDIPAR_FICFOR_5], [MINP].[ZEDIPAR].[FICFOR_6] AS [MINP_ZEDIPAR_FICFOR_6], [MINP].[ZEDIPAR].[FICFOR_7] AS [MINP_ZEDIPAR_FICFOR_7], [MINP].[ZEDIPAR].[FICFOR_8] AS [MINP_ZEDIPAR_FICFOR_8], [MINP].[ZEDIPAR].[FICFOR_9] AS [MINP_ZEDIPAR_FICFOR_9], [MINP].[ZEDIPAR].[FICNUM_0] AS [MINP_ZEDIPAR_FICNUM_0], [MINP].[ZEDIPAR].[FICNUM_1] AS [MINP_ZEDIPAR_FICNUM_1], [MINP].[ZEDIPAR].[FICNUM_2] AS [MINP_ZEDIPAR_FICNUM_2], [MINP].[ZEDIPAR].[FICNUM_3] AS [MINP_ZEDIPAR_FICNUM_3], [MINP].[ZEDIPAR].[FICNUM_4] AS [MINP_ZEDIPAR_FICNUM_4], [MINP].[ZEDIPAR].[FICNUM_5] AS [MINP_ZEDIPAR_FICNUM_5], [MINP].[ZEDIPAR].[FICNUM_6] AS [MINP_ZEDIPAR_FICNUM_6], [MINP].[ZEDIPAR].[FICNUM_7] AS [MINP_ZEDIPAR_FICNUM_7], [MINP].[ZEDIPAR].[FICNUM_8] AS [MINP_ZEDIPAR_FICNUM_8], [MINP].[ZEDIPAR].[FICNUM_9] AS [MINP_ZEDIPAR_FICNUM_9], [MINP].[ZEDIPAR].[PEREDI_0] AS [MINP_ZEDIPAR_PEREDI_0], [MINP].[ZEDIPAR].[PEREDI_1] AS [MINP_ZEDIPAR_PEREDI_1], [MINP].[ZEDIPAR].[PEREDI_2] AS [MINP_ZEDIPAR_PEREDI_2], [MINP].[ZEDIPAR].[PEREDI_3] AS [MINP_ZEDIPAR_PEREDI_3], [MINP].[ZEDIPAR].[PEREDI_4] AS [MINP_ZEDIPAR_PEREDI_4], [MINP].[ZEDIPAR].[PEREDI_5] AS [MINP_ZEDIPAR_PEREDI_5], [MINP].[ZEDIPAR].[PEREDI_6] AS [MINP_ZEDIPAR_PEREDI_6], [MINP].[ZEDIPAR].[PEREDI_7] AS [MINP_ZEDIPAR_PEREDI_7], [MINP].[ZEDIPAR].[PEREDI_8] AS [MINP_ZEDIPAR_PEREDI_8], [MINP].[ZEDIPAR].[PEREDI_9] AS [MINP_ZEDIPAR_PEREDI_9], [MINP].[ZEDIPAR].[PERIODI_0] AS [MINP_ZEDIPAR_PERIODI_0], [MINP].[ZEDIPAR].[PERIODI_1] AS [MINP_ZEDIPAR_PERIODI_1], [MINP].[ZEDIPAR].[PERIODI_2] AS [MINP_ZEDIPAR_PERIODI_2], [MINP].[ZEDIPAR].[PERIODI_3] AS [MINP_ZEDIPAR_PERIODI_3], [MINP].[ZEDIPAR].[PERIODI_4] AS [MINP_ZEDIPAR_PERIODI_4], [MINP].[ZEDIPAR].[PERIODI_5] AS [MINP_ZEDIPAR_PERIODI_5], [MINP].[ZEDIPAR].[PERIODI_6] AS [MINP_ZEDIPAR_PERIODI_6], [MINP].[ZEDIPAR].[PERIODI_7] AS [MINP_ZEDIPAR_PERIODI_7], [MINP].[ZEDIPAR].[PERIODI_8] AS [MINP_ZEDIPAR_PERIODI_8], [MINP].[ZEDIPAR].[PERIODI_9] AS [MINP_ZEDIPAR_PERIODI_9], [MINP].[ZEDIPAR].[MDL_0] AS [MINP_ZEDIPAR_MDL_0], [MINP].[ZEDIPAR].[MDL_1] AS [MINP_ZEDIPAR_MDL_1], [MINP].[ZEDIPAR].[MDL_2] AS [MINP_ZEDIPAR_MDL_2], [MINP].[ZEDIPAR].[MDL_3] AS [MINP_ZEDIPAR_MDL_3], [MINP].[ZEDIPAR].[MDL_4] AS [MINP_ZEDIPAR_MDL_4], [MINP].[ZEDIPAR].[MDLTIM_0] AS [MINP_ZEDIPAR_MDLTIM_0], [MINP].[ZEDIPAR].[MDLTIM_1] AS [MINP_ZEDIPAR_MDLTIM_1], [MINP].[ZEDIPAR].[MDLTIM_2] AS [MINP_ZEDIPAR_MDLTIM_2], [MINP].[ZEDIPAR].[MDLTIM_3] AS [MINP_ZEDIPAR_MDLTIM_3], [MINP].[ZEDIPAR].[MDLTIM_4] AS [MINP_ZEDIPAR_MDLTIM_4], [MINP].[ZEDIPAR].[PUBGES_0] AS [MINP_ZEDIPAR_PUBGES_0], [MINP].[ZEDIPAR].[PUBANA_0] AS [MINP_ZEDIPAR_PUBANA_0], [MINP].[ZEDIPAR].[FLGBAS_0] AS [MINP_ZEDIPAR_FLGBAS_0], [MINP].[ZEDIPAR].[FLGQTY_0] AS [MINP_ZEDIPAR_FLGQTY_0], [MINP].[ZEDIPAR].[FLGNUM_0] AS [MINP_ZEDIPAR_FLGNUM_0], [MINP].[ZEDIPAR].[FLGXLS_0] AS [MINP_ZEDIPAR_FLGXLS_0], [MINP].[ZEDIPAR].[FLGPAC_0] AS [MINP_ZEDIPAR_FLGPAC_0], [MINP].[ZEDIPAR].[COLOR_0] AS [MINP_ZEDIPAR_COLOR_0], [MINP].[ZEDIPAR].[DSCBPS_0] AS [MINP_ZEDIPAR_DSCBPS_0], [MINP].[ZEDIPAR].[ROWID] AS [MINP_ZEDIPAR_ROWID], [MINP].[ZEDIPAR].[CREUSR_0] AS [MINP_ZEDIPAR_CREUSR_0], [MINP].[ZEDIPAR].[UPDUSR_0] AS [MINP_ZEDIPAR_UPDUSR_0], [MINP].[ZEDIPAR].[CREDATTIM_0] AS [MINP_ZEDIPAR_CREDATTIM_0], [MINP].[ZEDIPAR].[UPDDATTIM_0] AS [MINP_ZEDIPAR_UPDDATTIM_0], [MINP].[ZEDIPAR].[AUUID_0] AS [MINP_ZEDIPAR_AUUID_0], [MINP].[ZEDIPAR].[UPDTICK_0] AS [MINP_ZEDIPAR_UPDTICK_0] 
FROM [MINP].[ZEDIPAR] 
WHERE [MINP].[ZEDIPAR].[ENAFLG_0] = %(ENAFLG_0_1)s AND [MINP].[ZEDIPAR].[FTPFLG_0] = %(FTPFLG_0_1)s
2025-08-18 16:45:57,036 - INFO - sqlalchemy.engine.Engine - [generated in 0.00126s] {'ENAFLG_0_1': <YesNo.YES: 2>, 'FTPFLG_0_1': <YesNo.YES: 2>}
2025-08-18 16:45:57,063 - INFO - src.services.provider_service - Encontrados 1 fornecedores ativos.
2025-08-18 16:45:57,065 - INFO - sqlalchemy.engine.Engine - ROLLBACK
2025-08-18 16:45:57,115 - INFO - __main__ - Fornecedores carregados com sucesso:
2025-08-18 16:45:57,115 - INFO - src.services.transfer_service - A iniciar processamento para o fornecedor: 1510 com protocolo: 'FTP'
2025-08-18 16:46:11,736 - INFO - src.services.strategies - Fornecedor '1510' usará a classe de estratégia: MlpStrategy
2025-08-18 16:46:14,838 - INFO - src.transfer.ftp_manager - A conectar ao servidor FTP em export.mlp.fr:21...
2025-08-18 16:46:15,036 - INFO - src.transfer.ftp_manager - Conexão FTP com 'export.mlp.fr' estabelecida com sucesso.
2025-08-18 16:46:16,049 - INFO - src.services.strategies - [1510] Valor inválido na configuração da Tarefa 5: 0 is not a valid ImportExport. Ignorar tarefa.
2025-08-18 16:46:16,049 - INFO - src.services.strategies - [1510] Valor inválido na configuração da Tarefa 6: 0 is not a valid ImportExport. Ignorar tarefa.
2025-08-18 16:46:16,049 - INFO - src.services.strategies - [1510] Valor inválido na configuração da Tarefa 7: 0 is not a valid ImportExport. Ignorar tarefa.
2025-08-18 16:46:16,049 - INFO - src.services.strategies - [1510] Valor inválido na configuração da Tarefa 8: 0 is not a valid ImportExport. Ignorar tarefa.
2025-08-18 16:46:16,050 - INFO - src.services.strategies - [1510] Valor inválido na configuração da Tarefa 9: 0 is not a valid ImportExport. Ignorar tarefa.
2025-08-18 16:46:16,050 - INFO - src.services.strategies - [1510] Foram selecionadas 5 tarefas para execução.
2025-08-18 16:46:19,943 - INFO - src.services.strategies - [1510] A executar a estratégia: MlpStrategy
2025-08-18 16:46:26,232 - INFO - src.services.strategies - [1510][MLP] Processar ficheiros para a 20250818 com o prefixo "R".
2025-08-18 16:46:46,489 - INFO - src.services.strategies - [1510] A processar Tarefa 0: Direção=IMPORT/DOWNLOAD, Prefixo="R"
2025-08-18 16:47:07,588 - INFO - src.transfer.ftp_manager - Listar ficheiros em '/Output'...
2025-08-18 16:47:49,332 - INFO - src.services.strategies - [1510] Tarefa 0: Nenhum ficheiro encontrado em /Output com o prefixo "R".
2025-08-18 16:47:55,411 - INFO - src.services.strategies - [1510][MLP] Processar ficheiros para a 20250818 com o prefixo "E".
2025-08-18 16:48:01,787 - INFO - src.services.strategies - [1510] A processar Tarefa 1: Direção=IMPORT/DOWNLOAD, Prefixo="E"
2025-08-18 16:48:07,802 - INFO - src.transfer.ftp_manager - Listar ficheiros em '/Output'...
2025-08-18 16:48:19,067 - INFO - src.services.strategies - [1510] Tarefa 1: Nenhum ficheiro encontrado em /Output com o prefixo "E".
2025-08-18 16:48:22,969 - INFO - src.services.strategies - [1510][MLP] Processar ficheiros para a 20250818 com o prefixo "M".
2025-08-18 16:48:28,868 - INFO - src.services.strategies - [1510] A processar Tarefa 2: Direção=EXPORT/UPLOAD, Prefixo="M"
2025-08-18 16:48:48,975 - INFO - src.services.strategies - [1510] Tarefa 2: Nenhum ficheiro encontrado em logs\ftp\EXPORT\1510 com o prefixo M.
2025-08-18 16:48:55,297 - INFO - src.services.strategies - [1510][MLP] Processar ficheiros para a 20250818 com o prefixo "F".
2025-08-18 16:48:58,971 - INFO - src.services.strategies - [1510] A processar Tarefa 3: Direção=IMPORT/DOWNLOAD, Prefixo="F"
2025-08-18 16:49:10,574 - INFO - src.transfer.ftp_manager - Listar ficheiros em '/Output'...
2025-08-18 16:49:10,771 - INFO - src.services.strategies - [1510] Tarefa 3: Nenhum ficheiro encontrado em /Output com o prefixo "F".
2025-08-18 16:49:13,459 - INFO - src.services.strategies - [1510][MLP] Processar ficheiros para a 20250818 com o prefixo "A".
2025-08-18 16:49:17,925 - INFO - src.services.strategies - [1510] A processar Tarefa 4: Direção=IMPORT/DOWNLOAD, Prefixo="A"
2025-08-18 16:49:19,634 - INFO - src.transfer.ftp_manager - Listar ficheiros em '/Output'...
2025-08-18 16:49:19,835 - INFO - src.services.strategies - [1510] Tarefa 4: Nenhum ficheiro encontrado em /Output com o prefixo "A".
2025-08-18 16:49:22,990 - INFO - src.transfer.ftp_manager - Conexão FTP com 'export.mlp.fr' fechada.
2025-08-18 16:49:23,884 - INFO - src.services.transfer_service - Processamento para o fornecedor 1510 concluído com sucesso.
2025-08-18 16:51:02,672 - INFO - src.config.logging - Logging configurado. Root level: DEBUG. Handlers: console, info_file, error_file
2025-08-18 16:51:02,672 - INFO - __main__ - Iniciando o backend de transferência de ficheiros...
2025-08-18 16:51:02,672 - INFO - src.services.provider_service - A buscar configurações de fornecedores ativos via ORM...
2025-08-18 16:51:02,863 - INFO - sqlalchemy.engine.Engine - select @@version
2025-08-18 16:51:02,872 - INFO - sqlalchemy.engine.Engine - [raw sql] {}
2025-08-18 16:51:02,886 - INFO - sqlalchemy.engine.Engine - SELECT schema_name()
2025-08-18 16:51:02,886 - INFO - sqlalchemy.engine.Engine - [generated in 0.00061s] {}
2025-08-18 16:51:02,962 - INFO - sqlalchemy.engine.Engine - SELECT CAST('test max support' AS NVARCHAR(max))
2025-08-18 16:51:02,962 - INFO - sqlalchemy.engine.Engine - [generated in 0.00050s] {}
2025-08-18 16:51:02,988 - INFO - sqlalchemy.engine.Engine - SELECT 1 FROM fn_listextendedproperty(default, default, default, default, default, default, default)
2025-08-18 16:51:02,989 - INFO - sqlalchemy.engine.Engine - [generated in 0.00053s] {}
2025-08-18 16:51:03,038 - INFO - sqlalchemy.engine.Engine - BEGIN (implicit)
2025-08-18 16:51:03,050 - INFO - sqlalchemy.engine.Engine - SELECT [MINP].[ZEDIPAR].[BPRNUM_0] AS [MINP_ZEDIPAR_BPRNUM_0], [MINP].[ZEDIPAR].[BPRNAM_0] AS [MINP_ZEDIPAR_BPRNAM_0], [MINP].[ZEDIPAR].[ENAFLG_0] AS [MINP_ZEDIPAR_ENAFLG_0], [MINP].[ZEDIPAR].[BPRID_0] AS [MINP_ZEDIPAR_BPRID_0], [MINP].[ZEDIPAR].[FTPFLG_0] AS [MINP_ZEDIPAR_FTPFLG_0], [MINP].[ZEDIPAR].[FTPTYP_0] AS [MINP_ZEDIPAR_FTPTYP_0], [MINP].[ZEDIPAR].[FTPURL_0] AS [MINP_ZEDIPAR_FTPURL_0], [MINP].[ZEDIPAR].[FTPUSR_0] AS [MINP_ZEDIPAR_FTPUSR_0], [MINP].[ZEDIPAR].[FTPPSW_0] AS [MINP_ZEDIPAR_FTPPSW_0], [MINP].[ZEDIPAR].[FTPMOD_0] AS [MINP_ZEDIPAR_FTPMOD_0], [MINP].[ZEDIPAR].[FTPINP_0] AS [MINP_ZEDIPAR_FTPINP_0], [MINP].[ZEDIPAR].[FTPOUT_0] AS [MINP_ZEDIPAR_FTPOUT_0], [MINP].[ZEDIPAR].[FTPFOR_0] AS [MINP_ZEDIPAR_FTPFOR_0], [MINP].[ZEDIPAR].[FTPTRT_0] AS [MINP_ZEDIPAR_FTPTRT_0], [MINP].[ZEDIPAR].[FTPFIC_0] AS [MINP_ZEDIPAR_FTPFIC_0], [MINP].[ZEDIPAR].[FTPEXP_0] AS [MINP_ZEDIPAR_FTPEXP_0], [MINP].[ZEDIPAR].[FTPUNI_0] AS [MINP_ZEDIPAR_FTPUNI_0], [MINP].[ZEDIPAR].[DRTINP_0] AS [MINP_ZEDIPAR_DRTINP_0], [MINP].[ZEDIPAR].[EXTINP_0] AS [MINP_ZEDIPAR_EXTINP_0], [MINP].[ZEDIPAR].[DRTOUT_0] AS [MINP_ZEDIPAR_DRTOUT_0], [MINP].[ZEDIPAR].[EXTOUT_0] AS [MINP_ZEDIPAR_EXTOUT_0], [MINP].[ZEDIPAR].[FICEXT_0] AS [MINP_ZEDIPAR_FICEXT_0], [MINP].[ZEDIPAR].[FICSEP_0] AS [MINP_ZEDIPAR_FICSEP_0], [MINP].[ZEDIPAR].[FICFLG_0] AS [MINP_ZEDIPAR_FICFLG_0], [MINP].[ZEDIPAR].[FICFLG_1] AS [MINP_ZEDIPAR_FICFLG_1], [MINP].[ZEDIPAR].[FICFLG_2] AS [MINP_ZEDIPAR_FICFLG_2], [MINP].[ZEDIPAR].[FICFLG_3] AS [MINP_ZEDIPAR_FICFLG_3], [MINP].[ZEDIPAR].[FICFLG_4] AS [MINP_ZEDIPAR_FICFLG_4], [MINP].[ZEDIPAR].[FICFLG_5] AS [MINP_ZEDIPAR_FICFLG_5], [MINP].[ZEDIPAR].[FICFLG_6] AS [MINP_ZEDIPAR_FICFLG_6], [MINP].[ZEDIPAR].[FICFLG_7] AS [MINP_ZEDIPAR_FICFLG_7], [MINP].[ZEDIPAR].[FICFLG_8] AS [MINP_ZEDIPAR_FICFLG_8], [MINP].[ZEDIPAR].[FICFLG_9] AS [MINP_ZEDIPAR_FICFLG_9], [MINP].[ZEDIPAR].[FICPRE_0] AS [MINP_ZEDIPAR_FICPRE_0], [MINP].[ZEDIPAR].[FICPRE_1] AS [MINP_ZEDIPAR_FICPRE_1], [MINP].[ZEDIPAR].[FICPRE_2] AS [MINP_ZEDIPAR_FICPRE_2], [MINP].[ZEDIPAR].[FICPRE_3] AS [MINP_ZEDIPAR_FICPRE_3], [MINP].[ZEDIPAR].[FICPRE_4] AS [MINP_ZEDIPAR_FICPRE_4], [MINP].[ZEDIPAR].[FICPRE_5] AS [MINP_ZEDIPAR_FICPRE_5], [MINP].[ZEDIPAR].[FICPRE_6] AS [MINP_ZEDIPAR_FICPRE_6], [MINP].[ZEDIPAR].[FICPRE_7] AS [MINP_ZEDIPAR_FICPRE_7], [MINP].[ZEDIPAR].[FICPRE_8] AS [MINP_ZEDIPAR_FICPRE_8], [MINP].[ZEDIPAR].[FICPRE_9] AS [MINP_ZEDIPAR_FICPRE_9], [MINP].[ZEDIPAR].[FICCOU_0] AS [MINP_ZEDIPAR_FICCOU_0], [MINP].[ZEDIPAR].[FICCOU_1] AS [MINP_ZEDIPAR_FICCOU_1], [MINP].[ZEDIPAR].[FICCOU_2] AS [MINP_ZEDIPAR_FICCOU_2], [MINP].[ZEDIPAR].[FICCOU_3] AS [MINP_ZEDIPAR_FICCOU_3], [MINP].[ZEDIPAR].[FICCOU_4] AS [MINP_ZEDIPAR_FICCOU_4], [MINP].[ZEDIPAR].[FICCOU_5] AS [MINP_ZEDIPAR_FICCOU_5], [MINP].[ZEDIPAR].[FICCOU_6] AS [MINP_ZEDIPAR_FICCOU_6], [MINP].[ZEDIPAR].[FICCOU_7] AS [MINP_ZEDIPAR_FICCOU_7], [MINP].[ZEDIPAR].[FICCOU_8] AS [MINP_ZEDIPAR_FICCOU_8], [MINP].[ZEDIPAR].[FICCOU_9] AS [MINP_ZEDIPAR_FICCOU_9], [MINP].[ZEDIPAR].[FICDES_0] AS [MINP_ZEDIPAR_FICDES_0], [MINP].[ZEDIPAR].[FICDES_1] AS [MINP_ZEDIPAR_FICDES_1], [MINP].[ZEDIPAR].[FICDES_2] AS [MINP_ZEDIPAR_FICDES_2], [MINP].[ZEDIPAR].[FICDES_3] AS [MINP_ZEDIPAR_FICDES_3], [MINP].[ZEDIPAR].[FICDES_4] AS [MINP_ZEDIPAR_FICDES_4], [MINP].[ZEDIPAR].[FICDES_5] AS [MINP_ZEDIPAR_FICDES_5], [MINP].[ZEDIPAR].[FICDES_6] AS [MINP_ZEDIPAR_FICDES_6], [MINP].[ZEDIPAR].[FICDES_7] AS [MINP_ZEDIPAR_FICDES_7], [MINP].[ZEDIPAR].[FICDES_8] AS [MINP_ZEDIPAR_FICDES_8], [MINP].[ZEDIPAR].[FICDES_9] AS [MINP_ZEDIPAR_FICDES_9], [MINP].[ZEDIPAR].[FICPRO_0] AS [MINP_ZEDIPAR_FICPRO_0], [MINP].[ZEDIPAR].[FICPRO_1] AS [MINP_ZEDIPAR_FICPRO_1], [MINP].[ZEDIPAR].[FICPRO_2] AS [MINP_ZEDIPAR_FICPRO_2], [MINP].[ZEDIPAR].[FICPRO_3] AS [MINP_ZEDIPAR_FICPRO_3], [MINP].[ZEDIPAR].[FICPRO_4] AS [MINP_ZEDIPAR_FICPRO_4], [MINP].[ZEDIPAR].[FICPRO_5] AS [MINP_ZEDIPAR_FICPRO_5], [MINP].[ZEDIPAR].[FICPRO_6] AS [MINP_ZEDIPAR_FICPRO_6], [MINP].[ZEDIPAR].[FICPRO_7] AS [MINP_ZEDIPAR_FICPRO_7], [MINP].[ZEDIPAR].[FICPRO_8] AS [MINP_ZEDIPAR_FICPRO_8], [MINP].[ZEDIPAR].[FICPRO_9] AS [MINP_ZEDIPAR_FICPRO_9], [MINP].[ZEDIPAR].[FICDIR_0] AS [MINP_ZEDIPAR_FICDIR_0], [MINP].[ZEDIPAR].[FICDIR_1] AS [MINP_ZEDIPAR_FICDIR_1], [MINP].[ZEDIPAR].[FICDIR_2] AS [MINP_ZEDIPAR_FICDIR_2], [MINP].[ZEDIPAR].[FICDIR_3] AS [MINP_ZEDIPAR_FICDIR_3], [MINP].[ZEDIPAR].[FICDIR_4] AS [MINP_ZEDIPAR_FICDIR_4], [MINP].[ZEDIPAR].[FICDIR_5] AS [MINP_ZEDIPAR_FICDIR_5], [MINP].[ZEDIPAR].[FICDIR_6] AS [MINP_ZEDIPAR_FICDIR_6], [MINP].[ZEDIPAR].[FICDIR_7] AS [MINP_ZEDIPAR_FICDIR_7], [MINP].[ZEDIPAR].[FICDIR_8] AS [MINP_ZEDIPAR_FICDIR_8], [MINP].[ZEDIPAR].[FICDIR_9] AS [MINP_ZEDIPAR_FICDIR_9], [MINP].[ZEDIPAR].[FICDAT_0] AS [MINP_ZEDIPAR_FICDAT_0], [MINP].[ZEDIPAR].[FICDAT_1] AS [MINP_ZEDIPAR_FICDAT_1], [MINP].[ZEDIPAR].[FICDAT_2] AS [MINP_ZEDIPAR_FICDAT_2], [MINP].[ZEDIPAR].[FICDAT_3] AS [MINP_ZEDIPAR_FICDAT_3], [MINP].[ZEDIPAR].[FICDAT_4] AS [MINP_ZEDIPAR_FICDAT_4], [MINP].[ZEDIPAR].[FICDAT_5] AS [MINP_ZEDIPAR_FICDAT_5], [MINP].[ZEDIPAR].[FICDAT_6] AS [MINP_ZEDIPAR_FICDAT_6], [MINP].[ZEDIPAR].[FICDAT_7] AS [MINP_ZEDIPAR_FICDAT_7], [MINP].[ZEDIPAR].[FICDAT_8] AS [MINP_ZEDIPAR_FICDAT_8], [MINP].[ZEDIPAR].[FICDAT_9] AS [MINP_ZEDIPAR_FICDAT_9], [MINP].[ZEDIPAR].[FICDEL_0] AS [MINP_ZEDIPAR_FICDEL_0], [MINP].[ZEDIPAR].[FICDEL_1] AS [MINP_ZEDIPAR_FICDEL_1], [MINP].[ZEDIPAR].[FICDEL_2] AS [MINP_ZEDIPAR_FICDEL_2], [MINP].[ZEDIPAR].[FICDEL_3] AS [MINP_ZEDIPAR_FICDEL_3], [MINP].[ZEDIPAR].[FICDEL_4] AS [MINP_ZEDIPAR_FICDEL_4], [MINP].[ZEDIPAR].[FICDEL_5] AS [MINP_ZEDIPAR_FICDEL_5], [MINP].[ZEDIPAR].[FICDEL_6] AS [MINP_ZEDIPAR_FICDEL_6], [MINP].[ZEDIPAR].[FICDEL_7] AS [MINP_ZEDIPAR_FICDEL_7], [MINP].[ZEDIPAR].[FICDEL_8] AS [MINP_ZEDIPAR_FICDEL_8], [MINP].[ZEDIPAR].[FICDEL_9] AS [MINP_ZEDIPAR_FICDEL_9], [MINP].[ZEDIPAR].[FICFOR_0] AS [MINP_ZEDIPAR_FICFOR_0], [MINP].[ZEDIPAR].[FICFOR_1] AS [MINP_ZEDIPAR_FICFOR_1], [MINP].[ZEDIPAR].[FICFOR_2] AS [MINP_ZEDIPAR_FICFOR_2], [MINP].[ZEDIPAR].[FICFOR_3] AS [MINP_ZEDIPAR_FICFOR_3], [MINP].[ZEDIPAR].[FICFOR_4] AS [MINP_ZEDIPAR_FICFOR_4], [MINP].[ZEDIPAR].[FICFOR_5] AS [MINP_ZEDIPAR_FICFOR_5], [MINP].[ZEDIPAR].[FICFOR_6] AS [MINP_ZEDIPAR_FICFOR_6], [MINP].[ZEDIPAR].[FICFOR_7] AS [MINP_ZEDIPAR_FICFOR_7], [MINP].[ZEDIPAR].[FICFOR_8] AS [MINP_ZEDIPAR_FICFOR_8], [MINP].[ZEDIPAR].[FICFOR_9] AS [MINP_ZEDIPAR_FICFOR_9], [MINP].[ZEDIPAR].[FICNUM_0] AS [MINP_ZEDIPAR_FICNUM_0], [MINP].[ZEDIPAR].[FICNUM_1] AS [MINP_ZEDIPAR_FICNUM_1], [MINP].[ZEDIPAR].[FICNUM_2] AS [MINP_ZEDIPAR_FICNUM_2], [MINP].[ZEDIPAR].[FICNUM_3] AS [MINP_ZEDIPAR_FICNUM_3], [MINP].[ZEDIPAR].[FICNUM_4] AS [MINP_ZEDIPAR_FICNUM_4], [MINP].[ZEDIPAR].[FICNUM_5] AS [MINP_ZEDIPAR_FICNUM_5], [MINP].[ZEDIPAR].[FICNUM_6] AS [MINP_ZEDIPAR_FICNUM_6], [MINP].[ZEDIPAR].[FICNUM_7] AS [MINP_ZEDIPAR_FICNUM_7], [MINP].[ZEDIPAR].[FICNUM_8] AS [MINP_ZEDIPAR_FICNUM_8], [MINP].[ZEDIPAR].[FICNUM_9] AS [MINP_ZEDIPAR_FICNUM_9], [MINP].[ZEDIPAR].[PEREDI_0] AS [MINP_ZEDIPAR_PEREDI_0], [MINP].[ZEDIPAR].[PEREDI_1] AS [MINP_ZEDIPAR_PEREDI_1], [MINP].[ZEDIPAR].[PEREDI_2] AS [MINP_ZEDIPAR_PEREDI_2], [MINP].[ZEDIPAR].[PEREDI_3] AS [MINP_ZEDIPAR_PEREDI_3], [MINP].[ZEDIPAR].[PEREDI_4] AS [MINP_ZEDIPAR_PEREDI_4], [MINP].[ZEDIPAR].[PEREDI_5] AS [MINP_ZEDIPAR_PEREDI_5], [MINP].[ZEDIPAR].[PEREDI_6] AS [MINP_ZEDIPAR_PEREDI_6], [MINP].[ZEDIPAR].[PEREDI_7] AS [MINP_ZEDIPAR_PEREDI_7], [MINP].[ZEDIPAR].[PEREDI_8] AS [MINP_ZEDIPAR_PEREDI_8], [MINP].[ZEDIPAR].[PEREDI_9] AS [MINP_ZEDIPAR_PEREDI_9], [MINP].[ZEDIPAR].[PERIODI_0] AS [MINP_ZEDIPAR_PERIODI_0], [MINP].[ZEDIPAR].[PERIODI_1] AS [MINP_ZEDIPAR_PERIODI_1], [MINP].[ZEDIPAR].[PERIODI_2] AS [MINP_ZEDIPAR_PERIODI_2], [MINP].[ZEDIPAR].[PERIODI_3] AS [MINP_ZEDIPAR_PERIODI_3], [MINP].[ZEDIPAR].[PERIODI_4] AS [MINP_ZEDIPAR_PERIODI_4], [MINP].[ZEDIPAR].[PERIODI_5] AS [MINP_ZEDIPAR_PERIODI_5], [MINP].[ZEDIPAR].[PERIODI_6] AS [MINP_ZEDIPAR_PERIODI_6], [MINP].[ZEDIPAR].[PERIODI_7] AS [MINP_ZEDIPAR_PERIODI_7], [MINP].[ZEDIPAR].[PERIODI_8] AS [MINP_ZEDIPAR_PERIODI_8], [MINP].[ZEDIPAR].[PERIODI_9] AS [MINP_ZEDIPAR_PERIODI_9], [MINP].[ZEDIPAR].[MDL_0] AS [MINP_ZEDIPAR_MDL_0], [MINP].[ZEDIPAR].[MDL_1] AS [MINP_ZEDIPAR_MDL_1], [MINP].[ZEDIPAR].[MDL_2] AS [MINP_ZEDIPAR_MDL_2], [MINP].[ZEDIPAR].[MDL_3] AS [MINP_ZEDIPAR_MDL_3], [MINP].[ZEDIPAR].[MDL_4] AS [MINP_ZEDIPAR_MDL_4], [MINP].[ZEDIPAR].[MDLTIM_0] AS [MINP_ZEDIPAR_MDLTIM_0], [MINP].[ZEDIPAR].[MDLTIM_1] AS [MINP_ZEDIPAR_MDLTIM_1], [MINP].[ZEDIPAR].[MDLTIM_2] AS [MINP_ZEDIPAR_MDLTIM_2], [MINP].[ZEDIPAR].[MDLTIM_3] AS [MINP_ZEDIPAR_MDLTIM_3], [MINP].[ZEDIPAR].[MDLTIM_4] AS [MINP_ZEDIPAR_MDLTIM_4], [MINP].[ZEDIPAR].[PUBGES_0] AS [MINP_ZEDIPAR_PUBGES_0], [MINP].[ZEDIPAR].[PUBANA_0] AS [MINP_ZEDIPAR_PUBANA_0], [MINP].[ZEDIPAR].[FLGBAS_0] AS [MINP_ZEDIPAR_FLGBAS_0], [MINP].[ZEDIPAR].[FLGQTY_0] AS [MINP_ZEDIPAR_FLGQTY_0], [MINP].[ZEDIPAR].[FLGNUM_0] AS [MINP_ZEDIPAR_FLGNUM_0], [MINP].[ZEDIPAR].[FLGXLS_0] AS [MINP_ZEDIPAR_FLGXLS_0], [MINP].[ZEDIPAR].[FLGPAC_0] AS [MINP_ZEDIPAR_FLGPAC_0], [MINP].[ZEDIPAR].[COLOR_0] AS [MINP_ZEDIPAR_COLOR_0], [MINP].[ZEDIPAR].[DSCBPS_0] AS [MINP_ZEDIPAR_DSCBPS_0], [MINP].[ZEDIPAR].[ROWID] AS [MINP_ZEDIPAR_ROWID], [MINP].[ZEDIPAR].[CREUSR_0] AS [MINP_ZEDIPAR_CREUSR_0], [MINP].[ZEDIPAR].[UPDUSR_0] AS [MINP_ZEDIPAR_UPDUSR_0], [MINP].[ZEDIPAR].[CREDATTIM_0] AS [MINP_ZEDIPAR_CREDATTIM_0], [MINP].[ZEDIPAR].[UPDDATTIM_0] AS [MINP_ZEDIPAR_UPDDATTIM_0], [MINP].[ZEDIPAR].[AUUID_0] AS [MINP_ZEDIPAR_AUUID_0], [MINP].[ZEDIPAR].[UPDTICK_0] AS [MINP_ZEDIPAR_UPDTICK_0] 
FROM [MINP].[ZEDIPAR] 
WHERE [MINP].[ZEDIPAR].[ENAFLG_0] = %(ENAFLG_0_1)s AND [MINP].[ZEDIPAR].[FTPFLG_0] = %(FTPFLG_0_1)s
2025-08-18 16:51:03,052 - INFO - sqlalchemy.engine.Engine - [generated in 0.00159s] {'ENAFLG_0_1': <YesNo.YES: 2>, 'FTPFLG_0_1': <YesNo.YES: 2>}
2025-08-18 16:51:03,079 - INFO - src.services.provider_service - Encontrados 1 fornecedores ativos.
2025-08-18 16:51:03,081 - INFO - sqlalchemy.engine.Engine - ROLLBACK
2025-08-18 16:51:03,122 - INFO - __main__ - Fornecedores carregados com sucesso:
2025-08-18 16:51:03,122 - INFO - src.services.transfer_service - A iniciar processamento para o fornecedor: 1510 com protocolo: 'FTP'
2025-08-18 16:51:07,568 - INFO - src.services.strategies - Fornecedor '1510' usará a classe de estratégia: MlpStrategy
2025-08-18 16:51:07,569 - INFO - src.transfer.ftp_manager - A conectar ao servidor FTP em export.mlp.fr:21...
2025-08-18 16:51:07,766 - INFO - src.transfer.ftp_manager - Conexão FTP com 'export.mlp.fr' estabelecida com sucesso.
2025-08-18 16:51:07,768 - INFO - src.services.strategies - [1510] Valor inválido na configuração da Tarefa 5: 0 is not a valid ImportExport. Ignorar tarefa.
2025-08-18 16:51:07,768 - INFO - src.services.strategies - [1510] Valor inválido na configuração da Tarefa 6: 0 is not a valid ImportExport. Ignorar tarefa.
2025-08-18 16:51:07,768 - INFO - src.services.strategies - [1510] Valor inválido na configuração da Tarefa 7: 0 is not a valid ImportExport. Ignorar tarefa.
2025-08-18 16:51:07,768 - INFO - src.services.strategies - [1510] Valor inválido na configuração da Tarefa 8: 0 is not a valid ImportExport. Ignorar tarefa.
2025-08-18 16:51:07,768 - INFO - src.services.strategies - [1510] Valor inválido na configuração da Tarefa 9: 0 is not a valid ImportExport. Ignorar tarefa.
2025-08-18 16:51:07,768 - INFO - src.services.strategies - [1510] Foram selecionadas 5 tarefas para execução.
2025-08-18 16:51:07,768 - INFO - src.services.strategies - [1510] A executar a estratégia: MlpStrategy
2025-08-18 16:51:07,768 - INFO - src.services.strategies - [1510][MLP] Processar ficheiros para a 20250814 com o prefixo "R".
2025-08-18 16:51:07,769 - INFO - src.services.strategies - [1510] A processar Tarefa 0: Direção=IMPORT/DOWNLOAD, Prefixo="R"
2025-08-18 16:51:07,769 - INFO - src.transfer.ftp_manager - Listar ficheiros em '/Output'...
2025-08-18 16:51:07,967 - INFO - src.services.strategies - [1510] Tarefa 0: Encontrados 1 ficheiros para download.
2025-08-18 16:51:07,967 - INFO - src.services.strategies - [1510] A receber: /Output/R2025081401.TXT -> logs\ftp\IMPORT\1510\R2025081401.TXT
2025-08-18 16:51:07,967 - INFO - src.transfer.ftp_manager - Iniciar download de '/Output/R2025081401.TXT' para 'logs\ftp\IMPORT\1510\R2025081401.TXT'...
2025-08-18 16:51:08,189 - ERROR - src.transfer.ftp_manager - Falha no download do ficheiro: 'utf-8' codec can't decode byte 0xe9 in position 489: invalid continuation byte
Traceback (most recent call last):
  File "d:\Python\Sage\INP\transfer-files\src\transfer\ftp_manager.py", line 122, in download_file
    self.ftp.retrlines(f'RETR {remote_path}', f.write)
  File "C:\Users\joser\.pyenv\pyenv-win\versions\3.12.7\Lib\ftplib.py", line 462, in retrlines
    line = fp.readline(self.maxline + 1)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\joser\.pyenv\pyenv-win\versions\3.12.7\Lib\codecs.py", line 322, in decode
    (result, consumed) = self._buffer_decode(data, self.errors, final)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe9 in position 489: invalid continuation byte
2025-08-18 16:51:08,222 - ERROR - src.services.strategies - [1510] Falha no download de R2025081401.TXT.
2025-08-18 16:51:08,222 - INFO - src.services.strategies - [1510][MLP] Processar ficheiros para a 20250814 com o prefixo "E".
2025-08-18 16:51:08,222 - INFO - src.services.strategies - [1510] A processar Tarefa 1: Direção=IMPORT/DOWNLOAD, Prefixo="E"
2025-08-18 16:51:08,222 - INFO - src.transfer.ftp_manager - Listar ficheiros em '/Output'...
2025-08-18 16:51:08,239 - WARNING - src.transfer.ftp_manager - Diretório remoto não encontrado ou vazio: /Output
2025-08-18 16:51:08,239 - INFO - src.services.strategies - [1510] Tarefa 1: Nenhum ficheiro encontrado em /Output com o prefixo "E".
2025-08-18 16:51:08,239 - INFO - src.services.strategies - [1510][MLP] Processar ficheiros para a 20250814 com o prefixo "M".
2025-08-18 16:51:08,239 - INFO - src.services.strategies - [1510] A processar Tarefa 2: Direção=EXPORT/UPLOAD, Prefixo="M"
2025-08-18 16:51:08,240 - INFO - src.services.strategies - [1510] Tarefa 2: Nenhum ficheiro encontrado em logs\ftp\EXPORT\1510 com o prefixo M.
2025-08-18 16:51:08,240 - INFO - src.services.strategies - [1510][MLP] Processar ficheiros para a 20250814 com o prefixo "F".
2025-08-18 16:51:08,241 - INFO - src.services.strategies - [1510] A processar Tarefa 3: Direção=IMPORT/DOWNLOAD, Prefixo="F"
2025-08-18 16:51:08,241 - INFO - src.transfer.ftp_manager - Listar ficheiros em '/Output'...
2025-08-18 16:51:08,317 - ERROR - src.transfer.ftp_manager - Falha inesperada ao listar ficheiros em '/Output': 200 Type set to A.
Traceback (most recent call last):
  File "d:\Python\Sage\INP\transfer-files\src\transfer\ftp_manager.py", line 71, in list_files
    return self.ftp.nlst(remote_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\joser\.pyenv\pyenv-win\versions\3.12.7\Lib\ftplib.py", line 547, in nlst
    self.retrlines(cmd, files.append)
  File "C:\Users\joser\.pyenv\pyenv-win\versions\3.12.7\Lib\ftplib.py", line 459, in retrlines
    with self.transfercmd(cmd) as conn, \
         ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\joser\.pyenv\pyenv-win\versions\3.12.7\Lib\ftplib.py", line 393, in transfercmd
    return self.ntransfercmd(cmd, rest)[0]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\joser\.pyenv\pyenv-win\versions\3.12.7\Lib\ftplib.py", line 353, in ntransfercmd
    host, port = self.makepasv()
                 ^^^^^^^^^^^^^^^
  File "C:\Users\joser\.pyenv\pyenv-win\versions\3.12.7\Lib\ftplib.py", line 327, in makepasv
    untrusted_host, port = parse227(self.sendcmd('PASV'))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\joser\.pyenv\pyenv-win\versions\3.12.7\Lib\ftplib.py", line 817, in parse227
    raise error_reply(resp)
ftplib.error_reply: 200 Type set to A.
2025-08-18 16:51:08,318 - INFO - src.services.strategies - [1510] Tarefa 3: Nenhum ficheiro encontrado em /Output com o prefixo "F".
2025-08-18 16:51:08,318 - INFO - src.services.strategies - [1510][MLP] Processar ficheiros para a 20250814 com o prefixo "A".
2025-08-18 16:51:08,318 - INFO - src.services.strategies - [1510] A processar Tarefa 4: Direção=IMPORT/DOWNLOAD, Prefixo="A"
2025-08-18 16:51:08,318 - INFO - src.transfer.ftp_manager - Listar ficheiros em '/Output'...
2025-08-18 16:51:08,412 - ERROR - src.transfer.ftp_manager - Falha inesperada ao listar ficheiros em '/Output': 200 Type set to A.
Traceback (most recent call last):
  File "d:\Python\Sage\INP\transfer-files\src\transfer\ftp_manager.py", line 71, in list_files
    return self.ftp.nlst(remote_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\joser\.pyenv\pyenv-win\versions\3.12.7\Lib\ftplib.py", line 547, in nlst
    self.retrlines(cmd, files.append)
  File "C:\Users\joser\.pyenv\pyenv-win\versions\3.12.7\Lib\ftplib.py", line 459, in retrlines
    with self.transfercmd(cmd) as conn, \
         ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\joser\.pyenv\pyenv-win\versions\3.12.7\Lib\ftplib.py", line 393, in transfercmd
    return self.ntransfercmd(cmd, rest)[0]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\joser\.pyenv\pyenv-win\versions\3.12.7\Lib\ftplib.py", line 353, in ntransfercmd
    host, port = self.makepasv()
                 ^^^^^^^^^^^^^^^
  File "C:\Users\joser\.pyenv\pyenv-win\versions\3.12.7\Lib\ftplib.py", line 327, in makepasv
    untrusted_host, port = parse227(self.sendcmd('PASV'))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\joser\.pyenv\pyenv-win\versions\3.12.7\Lib\ftplib.py", line 817, in parse227
    raise error_reply(resp)
ftplib.error_reply: 200 Type set to A.
2025-08-18 16:51:08,413 - INFO - src.services.strategies - [1510] Tarefa 4: Nenhum ficheiro encontrado em /Output com o prefixo "A".
2025-08-18 16:51:08,460 - INFO - src.transfer.ftp_manager - Conexão FTP com 'export.mlp.fr' fechada.
2025-08-18 16:51:08,460 - INFO - src.services.transfer_service - Processamento para o fornecedor 1510 concluído com sucesso.
2025-08-18 17:15:56,183 - INFO - src.config.logging - Logging configurado. Root level: DEBUG. Handlers: console, info_file, error_file
2025-08-18 17:15:56,183 - INFO - __main__ - Iniciando o backend de transferência de ficheiros...
2025-08-18 17:15:56,183 - INFO - src.services.provider_service - A buscar configurações de fornecedores ativos via ORM...
2025-08-18 17:15:56,373 - INFO - sqlalchemy.engine.Engine - select @@version
2025-08-18 17:15:56,373 - INFO - sqlalchemy.engine.Engine - [raw sql] {}
2025-08-18 17:15:56,391 - INFO - sqlalchemy.engine.Engine - SELECT schema_name()
2025-08-18 17:15:56,391 - INFO - sqlalchemy.engine.Engine - [generated in 0.00055s] {}
2025-08-18 17:15:56,465 - INFO - sqlalchemy.engine.Engine - SELECT CAST('test max support' AS NVARCHAR(max))
2025-08-18 17:15:56,465 - INFO - sqlalchemy.engine.Engine - [generated in 0.00030s] {}
2025-08-18 17:15:56,492 - INFO - sqlalchemy.engine.Engine - SELECT 1 FROM fn_listextendedproperty(default, default, default, default, default, default, default)
2025-08-18 17:15:56,492 - INFO - sqlalchemy.engine.Engine - [generated in 0.00038s] {}
2025-08-18 17:15:56,543 - INFO - sqlalchemy.engine.Engine - BEGIN (implicit)
2025-08-18 17:15:56,554 - INFO - sqlalchemy.engine.Engine - SELECT [MINP].[ZEDIPAR].[BPRNUM_0] AS [MINP_ZEDIPAR_BPRNUM_0], [MINP].[ZEDIPAR].[BPRNAM_0] AS [MINP_ZEDIPAR_BPRNAM_0], [MINP].[ZEDIPAR].[ENAFLG_0] AS [MINP_ZEDIPAR_ENAFLG_0], [MINP].[ZEDIPAR].[BPRID_0] AS [MINP_ZEDIPAR_BPRID_0], [MINP].[ZEDIPAR].[FTPFLG_0] AS [MINP_ZEDIPAR_FTPFLG_0], [MINP].[ZEDIPAR].[FTPTYP_0] AS [MINP_ZEDIPAR_FTPTYP_0], [MINP].[ZEDIPAR].[FTPURL_0] AS [MINP_ZEDIPAR_FTPURL_0], [MINP].[ZEDIPAR].[FTPUSR_0] AS [MINP_ZEDIPAR_FTPUSR_0], [MINP].[ZEDIPAR].[FTPPSW_0] AS [MINP_ZEDIPAR_FTPPSW_0], [MINP].[ZEDIPAR].[FTPMOD_0] AS [MINP_ZEDIPAR_FTPMOD_0], [MINP].[ZEDIPAR].[FTPINP_0] AS [MINP_ZEDIPAR_FTPINP_0], [MINP].[ZEDIPAR].[FTPOUT_0] AS [MINP_ZEDIPAR_FTPOUT_0], [MINP].[ZEDIPAR].[FTPFOR_0] AS [MINP_ZEDIPAR_FTPFOR_0], [MINP].[ZEDIPAR].[FTPTRT_0] AS [MINP_ZEDIPAR_FTPTRT_0], [MINP].[ZEDIPAR].[FTPFIC_0] AS [MINP_ZEDIPAR_FTPFIC_0], [MINP].[ZEDIPAR].[FTPEXP_0] AS [MINP_ZEDIPAR_FTPEXP_0], [MINP].[ZEDIPAR].[FTPUNI_0] AS [MINP_ZEDIPAR_FTPUNI_0], [MINP].[ZEDIPAR].[DRTINP_0] AS [MINP_ZEDIPAR_DRTINP_0], [MINP].[ZEDIPAR].[EXTINP_0] AS [MINP_ZEDIPAR_EXTINP_0], [MINP].[ZEDIPAR].[DRTOUT_0] AS [MINP_ZEDIPAR_DRTOUT_0], [MINP].[ZEDIPAR].[EXTOUT_0] AS [MINP_ZEDIPAR_EXTOUT_0], [MINP].[ZEDIPAR].[FICEXT_0] AS [MINP_ZEDIPAR_FICEXT_0], [MINP].[ZEDIPAR].[FICSEP_0] AS [MINP_ZEDIPAR_FICSEP_0], [MINP].[ZEDIPAR].[FICFLG_0] AS [MINP_ZEDIPAR_FICFLG_0], [MINP].[ZEDIPAR].[FICFLG_1] AS [MINP_ZEDIPAR_FICFLG_1], [MINP].[ZEDIPAR].[FICFLG_2] AS [MINP_ZEDIPAR_FICFLG_2], [MINP].[ZEDIPAR].[FICFLG_3] AS [MINP_ZEDIPAR_FICFLG_3], [MINP].[ZEDIPAR].[FICFLG_4] AS [MINP_ZEDIPAR_FICFLG_4], [MINP].[ZEDIPAR].[FICFLG_5] AS [MINP_ZEDIPAR_FICFLG_5], [MINP].[ZEDIPAR].[FICFLG_6] AS [MINP_ZEDIPAR_FICFLG_6], [MINP].[ZEDIPAR].[FICFLG_7] AS [MINP_ZEDIPAR_FICFLG_7], [MINP].[ZEDIPAR].[FICFLG_8] AS [MINP_ZEDIPAR_FICFLG_8], [MINP].[ZEDIPAR].[FICFLG_9] AS [MINP_ZEDIPAR_FICFLG_9], [MINP].[ZEDIPAR].[FICPRE_0] AS [MINP_ZEDIPAR_FICPRE_0], [MINP].[ZEDIPAR].[FICPRE_1] AS [MINP_ZEDIPAR_FICPRE_1], [MINP].[ZEDIPAR].[FICPRE_2] AS [MINP_ZEDIPAR_FICPRE_2], [MINP].[ZEDIPAR].[FICPRE_3] AS [MINP_ZEDIPAR_FICPRE_3], [MINP].[ZEDIPAR].[FICPRE_4] AS [MINP_ZEDIPAR_FICPRE_4], [MINP].[ZEDIPAR].[FICPRE_5] AS [MINP_ZEDIPAR_FICPRE_5], [MINP].[ZEDIPAR].[FICPRE_6] AS [MINP_ZEDIPAR_FICPRE_6], [MINP].[ZEDIPAR].[FICPRE_7] AS [MINP_ZEDIPAR_FICPRE_7], [MINP].[ZEDIPAR].[FICPRE_8] AS [MINP_ZEDIPAR_FICPRE_8], [MINP].[ZEDIPAR].[FICPRE_9] AS [MINP_ZEDIPAR_FICPRE_9], [MINP].[ZEDIPAR].[FICCOU_0] AS [MINP_ZEDIPAR_FICCOU_0], [MINP].[ZEDIPAR].[FICCOU_1] AS [MINP_ZEDIPAR_FICCOU_1], [MINP].[ZEDIPAR].[FICCOU_2] AS [MINP_ZEDIPAR_FICCOU_2], [MINP].[ZEDIPAR].[FICCOU_3] AS [MINP_ZEDIPAR_FICCOU_3], [MINP].[ZEDIPAR].[FICCOU_4] AS [MINP_ZEDIPAR_FICCOU_4], [MINP].[ZEDIPAR].[FICCOU_5] AS [MINP_ZEDIPAR_FICCOU_5], [MINP].[ZEDIPAR].[FICCOU_6] AS [MINP_ZEDIPAR_FICCOU_6], [MINP].[ZEDIPAR].[FICCOU_7] AS [MINP_ZEDIPAR_FICCOU_7], [MINP].[ZEDIPAR].[FICCOU_8] AS [MINP_ZEDIPAR_FICCOU_8], [MINP].[ZEDIPAR].[FICCOU_9] AS [MINP_ZEDIPAR_FICCOU_9], [MINP].[ZEDIPAR].[FICDES_0] AS [MINP_ZEDIPAR_FICDES_0], [MINP].[ZEDIPAR].[FICDES_1] AS [MINP_ZEDIPAR_FICDES_1], [MINP].[ZEDIPAR].[FICDES_2] AS [MINP_ZEDIPAR_FICDES_2], [MINP].[ZEDIPAR].[FICDES_3] AS [MINP_ZEDIPAR_FICDES_3], [MINP].[ZEDIPAR].[FICDES_4] AS [MINP_ZEDIPAR_FICDES_4], [MINP].[ZEDIPAR].[FICDES_5] AS [MINP_ZEDIPAR_FICDES_5], [MINP].[ZEDIPAR].[FICDES_6] AS [MINP_ZEDIPAR_FICDES_6], [MINP].[ZEDIPAR].[FICDES_7] AS [MINP_ZEDIPAR_FICDES_7], [MINP].[ZEDIPAR].[FICDES_8] AS [MINP_ZEDIPAR_FICDES_8], [MINP].[ZEDIPAR].[FICDES_9] AS [MINP_ZEDIPAR_FICDES_9], [MINP].[ZEDIPAR].[FICPRO_0] AS [MINP_ZEDIPAR_FICPRO_0], [MINP].[ZEDIPAR].[FICPRO_1] AS [MINP_ZEDIPAR_FICPRO_1], [MINP].[ZEDIPAR].[FICPRO_2] AS [MINP_ZEDIPAR_FICPRO_2], [MINP].[ZEDIPAR].[FICPRO_3] AS [MINP_ZEDIPAR_FICPRO_3], [MINP].[ZEDIPAR].[FICPRO_4] AS [MINP_ZEDIPAR_FICPRO_4], [MINP].[ZEDIPAR].[FICPRO_5] AS [MINP_ZEDIPAR_FICPRO_5], [MINP].[ZEDIPAR].[FICPRO_6] AS [MINP_ZEDIPAR_FICPRO_6], [MINP].[ZEDIPAR].[FICPRO_7] AS [MINP_ZEDIPAR_FICPRO_7], [MINP].[ZEDIPAR].[FICPRO_8] AS [MINP_ZEDIPAR_FICPRO_8], [MINP].[ZEDIPAR].[FICPRO_9] AS [MINP_ZEDIPAR_FICPRO_9], [MINP].[ZEDIPAR].[FICDIR_0] AS [MINP_ZEDIPAR_FICDIR_0], [MINP].[ZEDIPAR].[FICDIR_1] AS [MINP_ZEDIPAR_FICDIR_1], [MINP].[ZEDIPAR].[FICDIR_2] AS [MINP_ZEDIPAR_FICDIR_2], [MINP].[ZEDIPAR].[FICDIR_3] AS [MINP_ZEDIPAR_FICDIR_3], [MINP].[ZEDIPAR].[FICDIR_4] AS [MINP_ZEDIPAR_FICDIR_4], [MINP].[ZEDIPAR].[FICDIR_5] AS [MINP_ZEDIPAR_FICDIR_5], [MINP].[ZEDIPAR].[FICDIR_6] AS [MINP_ZEDIPAR_FICDIR_6], [MINP].[ZEDIPAR].[FICDIR_7] AS [MINP_ZEDIPAR_FICDIR_7], [MINP].[ZEDIPAR].[FICDIR_8] AS [MINP_ZEDIPAR_FICDIR_8], [MINP].[ZEDIPAR].[FICDIR_9] AS [MINP_ZEDIPAR_FICDIR_9], [MINP].[ZEDIPAR].[FICDAT_0] AS [MINP_ZEDIPAR_FICDAT_0], [MINP].[ZEDIPAR].[FICDAT_1] AS [MINP_ZEDIPAR_FICDAT_1], [MINP].[ZEDIPAR].[FICDAT_2] AS [MINP_ZEDIPAR_FICDAT_2], [MINP].[ZEDIPAR].[FICDAT_3] AS [MINP_ZEDIPAR_FICDAT_3], [MINP].[ZEDIPAR].[FICDAT_4] AS [MINP_ZEDIPAR_FICDAT_4], [MINP].[ZEDIPAR].[FICDAT_5] AS [MINP_ZEDIPAR_FICDAT_5], [MINP].[ZEDIPAR].[FICDAT_6] AS [MINP_ZEDIPAR_FICDAT_6], [MINP].[ZEDIPAR].[FICDAT_7] AS [MINP_ZEDIPAR_FICDAT_7], [MINP].[ZEDIPAR].[FICDAT_8] AS [MINP_ZEDIPAR_FICDAT_8], [MINP].[ZEDIPAR].[FICDAT_9] AS [MINP_ZEDIPAR_FICDAT_9], [MINP].[ZEDIPAR].[FICDEL_0] AS [MINP_ZEDIPAR_FICDEL_0], [MINP].[ZEDIPAR].[FICDEL_1] AS [MINP_ZEDIPAR_FICDEL_1], [MINP].[ZEDIPAR].[FICDEL_2] AS [MINP_ZEDIPAR_FICDEL_2], [MINP].[ZEDIPAR].[FICDEL_3] AS [MINP_ZEDIPAR_FICDEL_3], [MINP].[ZEDIPAR].[FICDEL_4] AS [MINP_ZEDIPAR_FICDEL_4], [MINP].[ZEDIPAR].[FICDEL_5] AS [MINP_ZEDIPAR_FICDEL_5], [MINP].[ZEDIPAR].[FICDEL_6] AS [MINP_ZEDIPAR_FICDEL_6], [MINP].[ZEDIPAR].[FICDEL_7] AS [MINP_ZEDIPAR_FICDEL_7], [MINP].[ZEDIPAR].[FICDEL_8] AS [MINP_ZEDIPAR_FICDEL_8], [MINP].[ZEDIPAR].[FICDEL_9] AS [MINP_ZEDIPAR_FICDEL_9], [MINP].[ZEDIPAR].[FICFOR_0] AS [MINP_ZEDIPAR_FICFOR_0], [MINP].[ZEDIPAR].[FICFOR_1] AS [MINP_ZEDIPAR_FICFOR_1], [MINP].[ZEDIPAR].[FICFOR_2] AS [MINP_ZEDIPAR_FICFOR_2], [MINP].[ZEDIPAR].[FICFOR_3] AS [MINP_ZEDIPAR_FICFOR_3], [MINP].[ZEDIPAR].[FICFOR_4] AS [MINP_ZEDIPAR_FICFOR_4], [MINP].[ZEDIPAR].[FICFOR_5] AS [MINP_ZEDIPAR_FICFOR_5], [MINP].[ZEDIPAR].[FICFOR_6] AS [MINP_ZEDIPAR_FICFOR_6], [MINP].[ZEDIPAR].[FICFOR_7] AS [MINP_ZEDIPAR_FICFOR_7], [MINP].[ZEDIPAR].[FICFOR_8] AS [MINP_ZEDIPAR_FICFOR_8], [MINP].[ZEDIPAR].[FICFOR_9] AS [MINP_ZEDIPAR_FICFOR_9], [MINP].[ZEDIPAR].[FICNUM_0] AS [MINP_ZEDIPAR_FICNUM_0], [MINP].[ZEDIPAR].[FICNUM_1] AS [MINP_ZEDIPAR_FICNUM_1], [MINP].[ZEDIPAR].[FICNUM_2] AS [MINP_ZEDIPAR_FICNUM_2], [MINP].[ZEDIPAR].[FICNUM_3] AS [MINP_ZEDIPAR_FICNUM_3], [MINP].[ZEDIPAR].[FICNUM_4] AS [MINP_ZEDIPAR_FICNUM_4], [MINP].[ZEDIPAR].[FICNUM_5] AS [MINP_ZEDIPAR_FICNUM_5], [MINP].[ZEDIPAR].[FICNUM_6] AS [MINP_ZEDIPAR_FICNUM_6], [MINP].[ZEDIPAR].[FICNUM_7] AS [MINP_ZEDIPAR_FICNUM_7], [MINP].[ZEDIPAR].[FICNUM_8] AS [MINP_ZEDIPAR_FICNUM_8], [MINP].[ZEDIPAR].[FICNUM_9] AS [MINP_ZEDIPAR_FICNUM_9], [MINP].[ZEDIPAR].[PEREDI_0] AS [MINP_ZEDIPAR_PEREDI_0], [MINP].[ZEDIPAR].[PEREDI_1] AS [MINP_ZEDIPAR_PEREDI_1], [MINP].[ZEDIPAR].[PEREDI_2] AS [MINP_ZEDIPAR_PEREDI_2], [MINP].[ZEDIPAR].[PEREDI_3] AS [MINP_ZEDIPAR_PEREDI_3], [MINP].[ZEDIPAR].[PEREDI_4] AS [MINP_ZEDIPAR_PEREDI_4], [MINP].[ZEDIPAR].[PEREDI_5] AS [MINP_ZEDIPAR_PEREDI_5], [MINP].[ZEDIPAR].[PEREDI_6] AS [MINP_ZEDIPAR_PEREDI_6], [MINP].[ZEDIPAR].[PEREDI_7] AS [MINP_ZEDIPAR_PEREDI_7], [MINP].[ZEDIPAR].[PEREDI_8] AS [MINP_ZEDIPAR_PEREDI_8], [MINP].[ZEDIPAR].[PEREDI_9] AS [MINP_ZEDIPAR_PEREDI_9], [MINP].[ZEDIPAR].[PERIODI_0] AS [MINP_ZEDIPAR_PERIODI_0], [MINP].[ZEDIPAR].[PERIODI_1] AS [MINP_ZEDIPAR_PERIODI_1], [MINP].[ZEDIPAR].[PERIODI_2] AS [MINP_ZEDIPAR_PERIODI_2], [MINP].[ZEDIPAR].[PERIODI_3] AS [MINP_ZEDIPAR_PERIODI_3], [MINP].[ZEDIPAR].[PERIODI_4] AS [MINP_ZEDIPAR_PERIODI_4], [MINP].[ZEDIPAR].[PERIODI_5] AS [MINP_ZEDIPAR_PERIODI_5], [MINP].[ZEDIPAR].[PERIODI_6] AS [MINP_ZEDIPAR_PERIODI_6], [MINP].[ZEDIPAR].[PERIODI_7] AS [MINP_ZEDIPAR_PERIODI_7], [MINP].[ZEDIPAR].[PERIODI_8] AS [MINP_ZEDIPAR_PERIODI_8], [MINP].[ZEDIPAR].[PERIODI_9] AS [MINP_ZEDIPAR_PERIODI_9], [MINP].[ZEDIPAR].[MDL_0] AS [MINP_ZEDIPAR_MDL_0], [MINP].[ZEDIPAR].[MDL_1] AS [MINP_ZEDIPAR_MDL_1], [MINP].[ZEDIPAR].[MDL_2] AS [MINP_ZEDIPAR_MDL_2], [MINP].[ZEDIPAR].[MDL_3] AS [MINP_ZEDIPAR_MDL_3], [MINP].[ZEDIPAR].[MDL_4] AS [MINP_ZEDIPAR_MDL_4], [MINP].[ZEDIPAR].[MDLTIM_0] AS [MINP_ZEDIPAR_MDLTIM_0], [MINP].[ZEDIPAR].[MDLTIM_1] AS [MINP_ZEDIPAR_MDLTIM_1], [MINP].[ZEDIPAR].[MDLTIM_2] AS [MINP_ZEDIPAR_MDLTIM_2], [MINP].[ZEDIPAR].[MDLTIM_3] AS [MINP_ZEDIPAR_MDLTIM_3], [MINP].[ZEDIPAR].[MDLTIM_4] AS [MINP_ZEDIPAR_MDLTIM_4], [MINP].[ZEDIPAR].[PUBGES_0] AS [MINP_ZEDIPAR_PUBGES_0], [MINP].[ZEDIPAR].[PUBANA_0] AS [MINP_ZEDIPAR_PUBANA_0], [MINP].[ZEDIPAR].[FLGBAS_0] AS [MINP_ZEDIPAR_FLGBAS_0], [MINP].[ZEDIPAR].[FLGQTY_0] AS [MINP_ZEDIPAR_FLGQTY_0], [MINP].[ZEDIPAR].[FLGNUM_0] AS [MINP_ZEDIPAR_FLGNUM_0], [MINP].[ZEDIPAR].[FLGXLS_0] AS [MINP_ZEDIPAR_FLGXLS_0], [MINP].[ZEDIPAR].[FLGPAC_0] AS [MINP_ZEDIPAR_FLGPAC_0], [MINP].[ZEDIPAR].[COLOR_0] AS [MINP_ZEDIPAR_COLOR_0], [MINP].[ZEDIPAR].[DSCBPS_0] AS [MINP_ZEDIPAR_DSCBPS_0], [MINP].[ZEDIPAR].[ROWID] AS [MINP_ZEDIPAR_ROWID], [MINP].[ZEDIPAR].[CREUSR_0] AS [MINP_ZEDIPAR_CREUSR_0], [MINP].[ZEDIPAR].[UPDUSR_0] AS [MINP_ZEDIPAR_UPDUSR_0], [MINP].[ZEDIPAR].[CREDATTIM_0] AS [MINP_ZEDIPAR_CREDATTIM_0], [MINP].[ZEDIPAR].[UPDDATTIM_0] AS [MINP_ZEDIPAR_UPDDATTIM_0], [MINP].[ZEDIPAR].[AUUID_0] AS [MINP_ZEDIPAR_AUUID_0], [MINP].[ZEDIPAR].[UPDTICK_0] AS [MINP_ZEDIPAR_UPDTICK_0] 
FROM [MINP].[ZEDIPAR] 
WHERE [MINP].[ZEDIPAR].[ENAFLG_0] = %(ENAFLG_0_1)s AND [MINP].[ZEDIPAR].[FTPFLG_0] = %(FTPFLG_0_1)s
2025-08-18 17:15:56,554 - INFO - sqlalchemy.engine.Engine - [generated in 0.00172s] {'ENAFLG_0_1': <YesNo.YES: 2>, 'FTPFLG_0_1': <YesNo.YES: 2>}
2025-08-18 17:15:56,587 - INFO - src.services.provider_service - Encontrados 1 fornecedores ativos.
2025-08-18 17:15:56,587 - INFO - sqlalchemy.engine.Engine - ROLLBACK
2025-08-18 17:15:56,633 - INFO - __main__ - Fornecedores carregados com sucesso:
2025-08-18 17:15:56,633 - INFO - src.services.transfer_service - A iniciar processamento para o fornecedor: 1510 com protocolo: 'FTP'
2025-08-18 17:16:31,387 - INFO - src.services.strategies - Fornecedor '1510' usará a classe de estratégia: MlpStrategy
2025-08-18 17:16:47,192 - INFO - src.transfer.ftp_manager - A conectar ao servidor FTP em export.mlp.fr:21...
2025-08-18 17:16:47,387 - INFO - src.transfer.ftp_manager - Conexão FTP com 'export.mlp.fr' estabelecida com sucesso.
2025-08-18 17:16:49,675 - INFO - src.services.strategies - [1510] Valor inválido na configuração da Tarefa 5: 0 is not a valid ImportExport. Ignorar tarefa.
2025-08-18 17:16:49,675 - INFO - src.services.strategies - [1510] Valor inválido na configuração da Tarefa 6: 0 is not a valid ImportExport. Ignorar tarefa.
2025-08-18 17:16:49,675 - INFO - src.services.strategies - [1510] Valor inválido na configuração da Tarefa 7: 0 is not a valid ImportExport. Ignorar tarefa.
2025-08-18 17:16:49,675 - INFO - src.services.strategies - [1510] Valor inválido na configuração da Tarefa 8: 0 is not a valid ImportExport. Ignorar tarefa.
2025-08-18 17:16:49,675 - INFO - src.services.strategies - [1510] Valor inválido na configuração da Tarefa 9: 0 is not a valid ImportExport. Ignorar tarefa.
2025-08-18 17:16:49,675 - INFO - src.services.strategies - [1510] Foram selecionadas 5 tarefas para execução.
2025-08-18 17:16:54,511 - INFO - src.services.strategies - [1510] A executar a estratégia: MlpStrategy
2025-08-18 17:16:57,671 - INFO - src.services.strategies - [1510][MLP] Processar ficheiros para a 20250814 com o prefixo "R".
2025-08-18 17:17:12,484 - INFO - src.services.strategies - [1510] A processar Tarefa 0: Direção=IMPORT/DOWNLOAD, Prefixo="R"
2025-08-18 17:17:22,488 - INFO - src.transfer.ftp_manager - Listar ficheiros em '/Output'...
2025-08-18 17:17:49,370 - INFO - src.services.strategies - [1510] Tarefa 0: Encontrados 1 ficheiros para download.
2025-08-18 17:17:59,664 - INFO - src.services.strategies - [1510] A receber: /Output/R2025081401.TXT -> logs\ftp\IMPORT\1510\R2025081401.TXT
2025-08-18 17:18:03,712 - INFO - src.transfer.ftp_manager - Iniciar download de '/Output/R2025081401.TXT' para 'logs\ftp\IMPORT\1510\R2025081401.TXT'...
2025-08-18 17:18:03,932 - ERROR - src.transfer.ftp_manager - Falha no download do ficheiro: 'utf-8' codec can't decode byte 0xe9 in position 489: invalid continuation byte
Traceback (most recent call last):
  File "d:\Python\Sage\INP\transfer-files\src\transfer\ftp_manager.py", line 122, in download_file
    self.ftp.retrlines(f'RETR {remote_path}', f.write)
  File "C:\Users\joser\.pyenv\pyenv-win\versions\3.12.7\Lib\ftplib.py", line 462, in retrlines
    line = fp.readline(self.maxline + 1)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\joser\.pyenv\pyenv-win\versions\3.12.7\Lib\codecs.py", line 322, in decode
    (result, consumed) = self._buffer_decode(data, self.errors, final)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe9 in position 489: invalid continuation byte
2025-08-18 17:18:26,225 - ERROR - src.services.strategies - [1510] Falha no download de R2025081401.TXT.
2025-08-18 17:43:12,264 - INFO - src.config.logging - Logging configurado. Root level: DEBUG. Handlers: console, info_file, error_file
2025-08-18 17:43:12,264 - INFO - __main__ - Iniciando o backend de transferência de ficheiros...
2025-08-18 17:43:12,264 - INFO - src.services.provider_service - A buscar configurações de fornecedores ativos via ORM...
2025-08-18 17:43:12,469 - INFO - sqlalchemy.engine.Engine - select @@version
2025-08-18 17:43:12,469 - INFO - sqlalchemy.engine.Engine - [raw sql] {}
2025-08-18 17:43:12,485 - INFO - sqlalchemy.engine.Engine - SELECT schema_name()
2025-08-18 17:43:12,485 - INFO - sqlalchemy.engine.Engine - [generated in 0.00060s] {}
2025-08-18 17:43:12,560 - INFO - sqlalchemy.engine.Engine - SELECT CAST('test max support' AS NVARCHAR(max))
2025-08-18 17:43:12,561 - INFO - sqlalchemy.engine.Engine - [generated in 0.00043s] {}
2025-08-18 17:43:12,584 - INFO - sqlalchemy.engine.Engine - SELECT 1 FROM fn_listextendedproperty(default, default, default, default, default, default, default)
2025-08-18 17:43:12,584 - INFO - sqlalchemy.engine.Engine - [generated in 0.00039s] {}
2025-08-18 17:43:12,640 - INFO - sqlalchemy.engine.Engine - BEGIN (implicit)
2025-08-18 17:43:12,646 - INFO - sqlalchemy.engine.Engine - SELECT [MINP].[ZEDIPAR].[BPRNUM_0] AS [MINP_ZEDIPAR_BPRNUM_0], [MINP].[ZEDIPAR].[BPRNAM_0] AS [MINP_ZEDIPAR_BPRNAM_0], [MINP].[ZEDIPAR].[ENAFLG_0] AS [MINP_ZEDIPAR_ENAFLG_0], [MINP].[ZEDIPAR].[BPRID_0] AS [MINP_ZEDIPAR_BPRID_0], [MINP].[ZEDIPAR].[FTPFLG_0] AS [MINP_ZEDIPAR_FTPFLG_0], [MINP].[ZEDIPAR].[FTPTYP_0] AS [MINP_ZEDIPAR_FTPTYP_0], [MINP].[ZEDIPAR].[FTPURL_0] AS [MINP_ZEDIPAR_FTPURL_0], [MINP].[ZEDIPAR].[FTPUSR_0] AS [MINP_ZEDIPAR_FTPUSR_0], [MINP].[ZEDIPAR].[FTPPSW_0] AS [MINP_ZEDIPAR_FTPPSW_0], [MINP].[ZEDIPAR].[FTPMOD_0] AS [MINP_ZEDIPAR_FTPMOD_0], [MINP].[ZEDIPAR].[FTPINP_0] AS [MINP_ZEDIPAR_FTPINP_0], [MINP].[ZEDIPAR].[FTPOUT_0] AS [MINP_ZEDIPAR_FTPOUT_0], [MINP].[ZEDIPAR].[FTPFOR_0] AS [MINP_ZEDIPAR_FTPFOR_0], [MINP].[ZEDIPAR].[FTPTRT_0] AS [MINP_ZEDIPAR_FTPTRT_0], [MINP].[ZEDIPAR].[FTPFIC_0] AS [MINP_ZEDIPAR_FTPFIC_0], [MINP].[ZEDIPAR].[FTPEXP_0] AS [MINP_ZEDIPAR_FTPEXP_0], [MINP].[ZEDIPAR].[FTPUNI_0] AS [MINP_ZEDIPAR_FTPUNI_0], [MINP].[ZEDIPAR].[DRTINP_0] AS [MINP_ZEDIPAR_DRTINP_0], [MINP].[ZEDIPAR].[EXTINP_0] AS [MINP_ZEDIPAR_EXTINP_0], [MINP].[ZEDIPAR].[DRTOUT_0] AS [MINP_ZEDIPAR_DRTOUT_0], [MINP].[ZEDIPAR].[EXTOUT_0] AS [MINP_ZEDIPAR_EXTOUT_0], [MINP].[ZEDIPAR].[FICEXT_0] AS [MINP_ZEDIPAR_FICEXT_0], [MINP].[ZEDIPAR].[FICSEP_0] AS [MINP_ZEDIPAR_FICSEP_0], [MINP].[ZEDIPAR].[FICFLG_0] AS [MINP_ZEDIPAR_FICFLG_0], [MINP].[ZEDIPAR].[FICFLG_1] AS [MINP_ZEDIPAR_FICFLG_1], [MINP].[ZEDIPAR].[FICFLG_2] AS [MINP_ZEDIPAR_FICFLG_2], [MINP].[ZEDIPAR].[FICFLG_3] AS [MINP_ZEDIPAR_FICFLG_3], [MINP].[ZEDIPAR].[FICFLG_4] AS [MINP_ZEDIPAR_FICFLG_4], [MINP].[ZEDIPAR].[FICFLG_5] AS [MINP_ZEDIPAR_FICFLG_5], [MINP].[ZEDIPAR].[FICFLG_6] AS [MINP_ZEDIPAR_FICFLG_6], [MINP].[ZEDIPAR].[FICFLG_7] AS [MINP_ZEDIPAR_FICFLG_7], [MINP].[ZEDIPAR].[FICFLG_8] AS [MINP_ZEDIPAR_FICFLG_8], [MINP].[ZEDIPAR].[FICFLG_9] AS [MINP_ZEDIPAR_FICFLG_9], [MINP].[ZEDIPAR].[FICPRE_0] AS [MINP_ZEDIPAR_FICPRE_0], [MINP].[ZEDIPAR].[FICPRE_1] AS [MINP_ZEDIPAR_FICPRE_1], [MINP].[ZEDIPAR].[FICPRE_2] AS [MINP_ZEDIPAR_FICPRE_2], [MINP].[ZEDIPAR].[FICPRE_3] AS [MINP_ZEDIPAR_FICPRE_3], [MINP].[ZEDIPAR].[FICPRE_4] AS [MINP_ZEDIPAR_FICPRE_4], [MINP].[ZEDIPAR].[FICPRE_5] AS [MINP_ZEDIPAR_FICPRE_5], [MINP].[ZEDIPAR].[FICPRE_6] AS [MINP_ZEDIPAR_FICPRE_6], [MINP].[ZEDIPAR].[FICPRE_7] AS [MINP_ZEDIPAR_FICPRE_7], [MINP].[ZEDIPAR].[FICPRE_8] AS [MINP_ZEDIPAR_FICPRE_8], [MINP].[ZEDIPAR].[FICPRE_9] AS [MINP_ZEDIPAR_FICPRE_9], [MINP].[ZEDIPAR].[FICCOU_0] AS [MINP_ZEDIPAR_FICCOU_0], [MINP].[ZEDIPAR].[FICCOU_1] AS [MINP_ZEDIPAR_FICCOU_1], [MINP].[ZEDIPAR].[FICCOU_2] AS [MINP_ZEDIPAR_FICCOU_2], [MINP].[ZEDIPAR].[FICCOU_3] AS [MINP_ZEDIPAR_FICCOU_3], [MINP].[ZEDIPAR].[FICCOU_4] AS [MINP_ZEDIPAR_FICCOU_4], [MINP].[ZEDIPAR].[FICCOU_5] AS [MINP_ZEDIPAR_FICCOU_5], [MINP].[ZEDIPAR].[FICCOU_6] AS [MINP_ZEDIPAR_FICCOU_6], [MINP].[ZEDIPAR].[FICCOU_7] AS [MINP_ZEDIPAR_FICCOU_7], [MINP].[ZEDIPAR].[FICCOU_8] AS [MINP_ZEDIPAR_FICCOU_8], [MINP].[ZEDIPAR].[FICCOU_9] AS [MINP_ZEDIPAR_FICCOU_9], [MINP].[ZEDIPAR].[FICDES_0] AS [MINP_ZEDIPAR_FICDES_0], [MINP].[ZEDIPAR].[FICDES_1] AS [MINP_ZEDIPAR_FICDES_1], [MINP].[ZEDIPAR].[FICDES_2] AS [MINP_ZEDIPAR_FICDES_2], [MINP].[ZEDIPAR].[FICDES_3] AS [MINP_ZEDIPAR_FICDES_3], [MINP].[ZEDIPAR].[FICDES_4] AS [MINP_ZEDIPAR_FICDES_4], [MINP].[ZEDIPAR].[FICDES_5] AS [MINP_ZEDIPAR_FICDES_5], [MINP].[ZEDIPAR].[FICDES_6] AS [MINP_ZEDIPAR_FICDES_6], [MINP].[ZEDIPAR].[FICDES_7] AS [MINP_ZEDIPAR_FICDES_7], [MINP].[ZEDIPAR].[FICDES_8] AS [MINP_ZEDIPAR_FICDES_8], [MINP].[ZEDIPAR].[FICDES_9] AS [MINP_ZEDIPAR_FICDES_9], [MINP].[ZEDIPAR].[FICPRO_0] AS [MINP_ZEDIPAR_FICPRO_0], [MINP].[ZEDIPAR].[FICPRO_1] AS [MINP_ZEDIPAR_FICPRO_1], [MINP].[ZEDIPAR].[FICPRO_2] AS [MINP_ZEDIPAR_FICPRO_2], [MINP].[ZEDIPAR].[FICPRO_3] AS [MINP_ZEDIPAR_FICPRO_3], [MINP].[ZEDIPAR].[FICPRO_4] AS [MINP_ZEDIPAR_FICPRO_4], [MINP].[ZEDIPAR].[FICPRO_5] AS [MINP_ZEDIPAR_FICPRO_5], [MINP].[ZEDIPAR].[FICPRO_6] AS [MINP_ZEDIPAR_FICPRO_6], [MINP].[ZEDIPAR].[FICPRO_7] AS [MINP_ZEDIPAR_FICPRO_7], [MINP].[ZEDIPAR].[FICPRO_8] AS [MINP_ZEDIPAR_FICPRO_8], [MINP].[ZEDIPAR].[FICPRO_9] AS [MINP_ZEDIPAR_FICPRO_9], [MINP].[ZEDIPAR].[FICDIR_0] AS [MINP_ZEDIPAR_FICDIR_0], [MINP].[ZEDIPAR].[FICDIR_1] AS [MINP_ZEDIPAR_FICDIR_1], [MINP].[ZEDIPAR].[FICDIR_2] AS [MINP_ZEDIPAR_FICDIR_2], [MINP].[ZEDIPAR].[FICDIR_3] AS [MINP_ZEDIPAR_FICDIR_3], [MINP].[ZEDIPAR].[FICDIR_4] AS [MINP_ZEDIPAR_FICDIR_4], [MINP].[ZEDIPAR].[FICDIR_5] AS [MINP_ZEDIPAR_FICDIR_5], [MINP].[ZEDIPAR].[FICDIR_6] AS [MINP_ZEDIPAR_FICDIR_6], [MINP].[ZEDIPAR].[FICDIR_7] AS [MINP_ZEDIPAR_FICDIR_7], [MINP].[ZEDIPAR].[FICDIR_8] AS [MINP_ZEDIPAR_FICDIR_8], [MINP].[ZEDIPAR].[FICDIR_9] AS [MINP_ZEDIPAR_FICDIR_9], [MINP].[ZEDIPAR].[FICDAT_0] AS [MINP_ZEDIPAR_FICDAT_0], [MINP].[ZEDIPAR].[FICDAT_1] AS [MINP_ZEDIPAR_FICDAT_1], [MINP].[ZEDIPAR].[FICDAT_2] AS [MINP_ZEDIPAR_FICDAT_2], [MINP].[ZEDIPAR].[FICDAT_3] AS [MINP_ZEDIPAR_FICDAT_3], [MINP].[ZEDIPAR].[FICDAT_4] AS [MINP_ZEDIPAR_FICDAT_4], [MINP].[ZEDIPAR].[FICDAT_5] AS [MINP_ZEDIPAR_FICDAT_5], [MINP].[ZEDIPAR].[FICDAT_6] AS [MINP_ZEDIPAR_FICDAT_6], [MINP].[ZEDIPAR].[FICDAT_7] AS [MINP_ZEDIPAR_FICDAT_7], [MINP].[ZEDIPAR].[FICDAT_8] AS [MINP_ZEDIPAR_FICDAT_8], [MINP].[ZEDIPAR].[FICDAT_9] AS [MINP_ZEDIPAR_FICDAT_9], [MINP].[ZEDIPAR].[FICDEL_0] AS [MINP_ZEDIPAR_FICDEL_0], [MINP].[ZEDIPAR].[FICDEL_1] AS [MINP_ZEDIPAR_FICDEL_1], [MINP].[ZEDIPAR].[FICDEL_2] AS [MINP_ZEDIPAR_FICDEL_2], [MINP].[ZEDIPAR].[FICDEL_3] AS [MINP_ZEDIPAR_FICDEL_3], [MINP].[ZEDIPAR].[FICDEL_4] AS [MINP_ZEDIPAR_FICDEL_4], [MINP].[ZEDIPAR].[FICDEL_5] AS [MINP_ZEDIPAR_FICDEL_5], [MINP].[ZEDIPAR].[FICDEL_6] AS [MINP_ZEDIPAR_FICDEL_6], [MINP].[ZEDIPAR].[FICDEL_7] AS [MINP_ZEDIPAR_FICDEL_7], [MINP].[ZEDIPAR].[FICDEL_8] AS [MINP_ZEDIPAR_FICDEL_8], [MINP].[ZEDIPAR].[FICDEL_9] AS [MINP_ZEDIPAR_FICDEL_9], [MINP].[ZEDIPAR].[FICFOR_0] AS [MINP_ZEDIPAR_FICFOR_0], [MINP].[ZEDIPAR].[FICFOR_1] AS [MINP_ZEDIPAR_FICFOR_1], [MINP].[ZEDIPAR].[FICFOR_2] AS [MINP_ZEDIPAR_FICFOR_2], [MINP].[ZEDIPAR].[FICFOR_3] AS [MINP_ZEDIPAR_FICFOR_3], [MINP].[ZEDIPAR].[FICFOR_4] AS [MINP_ZEDIPAR_FICFOR_4], [MINP].[ZEDIPAR].[FICFOR_5] AS [MINP_ZEDIPAR_FICFOR_5], [MINP].[ZEDIPAR].[FICFOR_6] AS [MINP_ZEDIPAR_FICFOR_6], [MINP].[ZEDIPAR].[FICFOR_7] AS [MINP_ZEDIPAR_FICFOR_7], [MINP].[ZEDIPAR].[FICFOR_8] AS [MINP_ZEDIPAR_FICFOR_8], [MINP].[ZEDIPAR].[FICFOR_9] AS [MINP_ZEDIPAR_FICFOR_9], [MINP].[ZEDIPAR].[FICNUM_0] AS [MINP_ZEDIPAR_FICNUM_0], [MINP].[ZEDIPAR].[FICNUM_1] AS [MINP_ZEDIPAR_FICNUM_1], [MINP].[ZEDIPAR].[FICNUM_2] AS [MINP_ZEDIPAR_FICNUM_2], [MINP].[ZEDIPAR].[FICNUM_3] AS [MINP_ZEDIPAR_FICNUM_3], [MINP].[ZEDIPAR].[FICNUM_4] AS [MINP_ZEDIPAR_FICNUM_4], [MINP].[ZEDIPAR].[FICNUM_5] AS [MINP_ZEDIPAR_FICNUM_5], [MINP].[ZEDIPAR].[FICNUM_6] AS [MINP_ZEDIPAR_FICNUM_6], [MINP].[ZEDIPAR].[FICNUM_7] AS [MINP_ZEDIPAR_FICNUM_7], [MINP].[ZEDIPAR].[FICNUM_8] AS [MINP_ZEDIPAR_FICNUM_8], [MINP].[ZEDIPAR].[FICNUM_9] AS [MINP_ZEDIPAR_FICNUM_9], [MINP].[ZEDIPAR].[PEREDI_0] AS [MINP_ZEDIPAR_PEREDI_0], [MINP].[ZEDIPAR].[PEREDI_1] AS [MINP_ZEDIPAR_PEREDI_1], [MINP].[ZEDIPAR].[PEREDI_2] AS [MINP_ZEDIPAR_PEREDI_2], [MINP].[ZEDIPAR].[PEREDI_3] AS [MINP_ZEDIPAR_PEREDI_3], [MINP].[ZEDIPAR].[PEREDI_4] AS [MINP_ZEDIPAR_PEREDI_4], [MINP].[ZEDIPAR].[PEREDI_5] AS [MINP_ZEDIPAR_PEREDI_5], [MINP].[ZEDIPAR].[PEREDI_6] AS [MINP_ZEDIPAR_PEREDI_6], [MINP].[ZEDIPAR].[PEREDI_7] AS [MINP_ZEDIPAR_PEREDI_7], [MINP].[ZEDIPAR].[PEREDI_8] AS [MINP_ZEDIPAR_PEREDI_8], [MINP].[ZEDIPAR].[PEREDI_9] AS [MINP_ZEDIPAR_PEREDI_9], [MINP].[ZEDIPAR].[PERIODI_0] AS [MINP_ZEDIPAR_PERIODI_0], [MINP].[ZEDIPAR].[PERIODI_1] AS [MINP_ZEDIPAR_PERIODI_1], [MINP].[ZEDIPAR].[PERIODI_2] AS [MINP_ZEDIPAR_PERIODI_2], [MINP].[ZEDIPAR].[PERIODI_3] AS [MINP_ZEDIPAR_PERIODI_3], [MINP].[ZEDIPAR].[PERIODI_4] AS [MINP_ZEDIPAR_PERIODI_4], [MINP].[ZEDIPAR].[PERIODI_5] AS [MINP_ZEDIPAR_PERIODI_5], [MINP].[ZEDIPAR].[PERIODI_6] AS [MINP_ZEDIPAR_PERIODI_6], [MINP].[ZEDIPAR].[PERIODI_7] AS [MINP_ZEDIPAR_PERIODI_7], [MINP].[ZEDIPAR].[PERIODI_8] AS [MINP_ZEDIPAR_PERIODI_8], [MINP].[ZEDIPAR].[PERIODI_9] AS [MINP_ZEDIPAR_PERIODI_9], [MINP].[ZEDIPAR].[MDL_0] AS [MINP_ZEDIPAR_MDL_0], [MINP].[ZEDIPAR].[MDL_1] AS [MINP_ZEDIPAR_MDL_1], [MINP].[ZEDIPAR].[MDL_2] AS [MINP_ZEDIPAR_MDL_2], [MINP].[ZEDIPAR].[MDL_3] AS [MINP_ZEDIPAR_MDL_3], [MINP].[ZEDIPAR].[MDL_4] AS [MINP_ZEDIPAR_MDL_4], [MINP].[ZEDIPAR].[MDLTIM_0] AS [MINP_ZEDIPAR_MDLTIM_0], [MINP].[ZEDIPAR].[MDLTIM_1] AS [MINP_ZEDIPAR_MDLTIM_1], [MINP].[ZEDIPAR].[MDLTIM_2] AS [MINP_ZEDIPAR_MDLTIM_2], [MINP].[ZEDIPAR].[MDLTIM_3] AS [MINP_ZEDIPAR_MDLTIM_3], [MINP].[ZEDIPAR].[MDLTIM_4] AS [MINP_ZEDIPAR_MDLTIM_4], [MINP].[ZEDIPAR].[PUBGES_0] AS [MINP_ZEDIPAR_PUBGES_0], [MINP].[ZEDIPAR].[PUBANA_0] AS [MINP_ZEDIPAR_PUBANA_0], [MINP].[ZEDIPAR].[FLGBAS_0] AS [MINP_ZEDIPAR_FLGBAS_0], [MINP].[ZEDIPAR].[FLGQTY_0] AS [MINP_ZEDIPAR_FLGQTY_0], [MINP].[ZEDIPAR].[FLGNUM_0] AS [MINP_ZEDIPAR_FLGNUM_0], [MINP].[ZEDIPAR].[FLGXLS_0] AS [MINP_ZEDIPAR_FLGXLS_0], [MINP].[ZEDIPAR].[FLGPAC_0] AS [MINP_ZEDIPAR_FLGPAC_0], [MINP].[ZEDIPAR].[COLOR_0] AS [MINP_ZEDIPAR_COLOR_0], [MINP].[ZEDIPAR].[DSCBPS_0] AS [MINP_ZEDIPAR_DSCBPS_0], [MINP].[ZEDIPAR].[ROWID] AS [MINP_ZEDIPAR_ROWID], [MINP].[ZEDIPAR].[CREUSR_0] AS [MINP_ZEDIPAR_CREUSR_0], [MINP].[ZEDIPAR].[UPDUSR_0] AS [MINP_ZEDIPAR_UPDUSR_0], [MINP].[ZEDIPAR].[CREDATTIM_0] AS [MINP_ZEDIPAR_CREDATTIM_0], [MINP].[ZEDIPAR].[UPDDATTIM_0] AS [MINP_ZEDIPAR_UPDDATTIM_0], [MINP].[ZEDIPAR].[AUUID_0] AS [MINP_ZEDIPAR_AUUID_0], [MINP].[ZEDIPAR].[UPDTICK_0] AS [MINP_ZEDIPAR_UPDTICK_0] 
FROM [MINP].[ZEDIPAR] 
WHERE [MINP].[ZEDIPAR].[ENAFLG_0] = %(ENAFLG_0_1)s AND [MINP].[ZEDIPAR].[FTPFLG_0] = %(FTPFLG_0_1)s
2025-08-18 17:43:12,654 - INFO - sqlalchemy.engine.Engine - [generated in 0.00181s] {'ENAFLG_0_1': <YesNo.YES: 2>, 'FTPFLG_0_1': <YesNo.YES: 2>}
2025-08-18 17:43:12,680 - INFO - src.services.provider_service - Encontrados 1 fornecedores ativos.
2025-08-18 17:43:12,680 - INFO - sqlalchemy.engine.Engine - ROLLBACK
2025-08-18 17:43:12,725 - INFO - __main__ - Fornecedores carregados com sucesso:
2025-08-18 17:43:12,725 - INFO - src.services.transfer_service - A iniciar processamento para o fornecedor: 1510 com protocolo: 'FTP'
2025-08-18 17:43:22,274 - INFO - src.services.transfer_service - [0] Valor 'binary_mode' do DB: 1. Convertido para: False.
2025-08-18 17:43:35,018 - INFO - src.services.strategies - Fornecedor '1510' usará a classe de estratégia: MlpStrategy
2025-08-18 17:43:37,203 - INFO - src.transfer.ftp_manager - A conectar ao servidor FTP em export.mlp.fr:21...
2025-08-18 17:43:37,424 - INFO - src.transfer.ftp_manager - Conexão FTP com 'export.mlp.fr' estabelecida com sucesso.
2025-08-18 17:43:38,516 - INFO - src.services.strategies - [1510] Valor inválido na configuração da Tarefa 5: 0 is not a valid ImportExport. Ignorar tarefa.
2025-08-18 17:43:38,516 - INFO - src.services.strategies - [1510] Valor inválido na configuração da Tarefa 6: 0 is not a valid ImportExport. Ignorar tarefa.
2025-08-18 17:43:38,516 - INFO - src.services.strategies - [1510] Valor inválido na configuração da Tarefa 7: 0 is not a valid ImportExport. Ignorar tarefa.
2025-08-18 17:43:38,516 - INFO - src.services.strategies - [1510] Valor inválido na configuração da Tarefa 8: 0 is not a valid ImportExport. Ignorar tarefa.
2025-08-18 17:43:38,516 - INFO - src.services.strategies - [1510] Valor inválido na configuração da Tarefa 9: 0 is not a valid ImportExport. Ignorar tarefa.
2025-08-18 17:43:38,516 - INFO - src.services.strategies - [1510] Foram selecionadas 5 tarefas para execução.
2025-08-18 17:43:42,436 - INFO - src.services.strategies - [1510] A executar a estratégia: MlpStrategy
2025-08-18 17:43:45,185 - INFO - src.services.strategies - [1510][MLP] Processar ficheiros para a 20250814 com o prefixo "R".
2025-08-18 17:43:49,697 - INFO - src.services.strategies - [1510] A processar Tarefa 0: Direção=IMPORT/DOWNLOAD, Prefixo="R"
2025-08-18 17:43:56,165 - INFO - src.transfer.ftp_manager - Listar ficheiros em '/Output'...
2025-08-18 17:44:16,876 - INFO - src.services.strategies - [1510] Tarefa 0: Encontrados 1 ficheiros para download.
2025-08-18 17:44:20,656 - INFO - src.services.strategies - [1510] A receber: /Output/R2025081401.TXT -> logs\ftp\IMPORT\1510\R2025081401.TXT
2025-08-18 17:44:26,887 - INFO - src.transfer.ftp_manager - Iniciar download de '/Output/R2025081401.TXT' para 'logs\ftp\IMPORT\1510\R2025081401.TXT'...
2025-08-18 17:44:45,630 - ERROR - src.transfer.ftp_manager - Falha no download do ficheiro: 'utf-8' codec can't decode byte 0xe9 in position 489: invalid continuation byte
Traceback (most recent call last):
  File "d:\Python\Sage\INP\transfer-files\src\transfer\ftp_manager.py", line 121, in download_file
    self.ftp.retrlines(f'RETR {remote_path}', f.write)
  File "C:\Users\joser\.pyenv\pyenv-win\versions\3.12.7\Lib\ftplib.py", line 462, in retrlines
    line = fp.readline(self.maxline + 1)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\joser\.pyenv\pyenv-win\versions\3.12.7\Lib\codecs.py", line 322, in decode
    (result, consumed) = self._buffer_decode(data, self.errors, final)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe9 in position 489: invalid continuation byte
2025-08-18 17:52:34,865 - INFO - src.config.logging - Logging configurado. Root level: DEBUG. Handlers: console, info_file, error_file
2025-08-18 17:52:34,866 - INFO - __main__ - Iniciando o backend de transferência de ficheiros...
2025-08-18 17:52:34,867 - INFO - src.services.provider_service - A buscar configurações de fornecedores ativos via ORM...
2025-08-18 17:52:35,088 - INFO - sqlalchemy.engine.Engine - select @@version
2025-08-18 17:52:35,088 - INFO - sqlalchemy.engine.Engine - [raw sql] {}
2025-08-18 17:52:35,104 - INFO - sqlalchemy.engine.Engine - SELECT schema_name()
2025-08-18 17:52:35,104 - INFO - sqlalchemy.engine.Engine - [generated in 0.00057s] {}
2025-08-18 17:52:35,190 - INFO - sqlalchemy.engine.Engine - SELECT CAST('test max support' AS NVARCHAR(max))
2025-08-18 17:52:35,190 - INFO - sqlalchemy.engine.Engine - [generated in 0.00039s] {}
2025-08-18 17:52:35,218 - INFO - sqlalchemy.engine.Engine - SELECT 1 FROM fn_listextendedproperty(default, default, default, default, default, default, default)
2025-08-18 17:52:35,218 - INFO - sqlalchemy.engine.Engine - [generated in 0.00047s] {}
2025-08-18 17:52:35,271 - INFO - sqlalchemy.engine.Engine - BEGIN (implicit)
2025-08-18 17:52:35,283 - INFO - sqlalchemy.engine.Engine - SELECT [MINP].[ZEDIPAR].[BPRNUM_0] AS [MINP_ZEDIPAR_BPRNUM_0], [MINP].[ZEDIPAR].[BPRNAM_0] AS [MINP_ZEDIPAR_BPRNAM_0], [MINP].[ZEDIPAR].[ENAFLG_0] AS [MINP_ZEDIPAR_ENAFLG_0], [MINP].[ZEDIPAR].[BPRID_0] AS [MINP_ZEDIPAR_BPRID_0], [MINP].[ZEDIPAR].[FTPFLG_0] AS [MINP_ZEDIPAR_FTPFLG_0], [MINP].[ZEDIPAR].[FTPTYP_0] AS [MINP_ZEDIPAR_FTPTYP_0], [MINP].[ZEDIPAR].[FTPURL_0] AS [MINP_ZEDIPAR_FTPURL_0], [MINP].[ZEDIPAR].[FTPUSR_0] AS [MINP_ZEDIPAR_FTPUSR_0], [MINP].[ZEDIPAR].[FTPPSW_0] AS [MINP_ZEDIPAR_FTPPSW_0], [MINP].[ZEDIPAR].[FTPMOD_0] AS [MINP_ZEDIPAR_FTPMOD_0], [MINP].[ZEDIPAR].[FTPINP_0] AS [MINP_ZEDIPAR_FTPINP_0], [MINP].[ZEDIPAR].[FTPOUT_0] AS [MINP_ZEDIPAR_FTPOUT_0], [MINP].[ZEDIPAR].[FTPFOR_0] AS [MINP_ZEDIPAR_FTPFOR_0], [MINP].[ZEDIPAR].[FTPTRT_0] AS [MINP_ZEDIPAR_FTPTRT_0], [MINP].[ZEDIPAR].[FTPFIC_0] AS [MINP_ZEDIPAR_FTPFIC_0], [MINP].[ZEDIPAR].[FTPEXP_0] AS [MINP_ZEDIPAR_FTPEXP_0], [MINP].[ZEDIPAR].[FTPUNI_0] AS [MINP_ZEDIPAR_FTPUNI_0], [MINP].[ZEDIPAR].[DRTINP_0] AS [MINP_ZEDIPAR_DRTINP_0], [MINP].[ZEDIPAR].[EXTINP_0] AS [MINP_ZEDIPAR_EXTINP_0], [MINP].[ZEDIPAR].[DRTOUT_0] AS [MINP_ZEDIPAR_DRTOUT_0], [MINP].[ZEDIPAR].[EXTOUT_0] AS [MINP_ZEDIPAR_EXTOUT_0], [MINP].[ZEDIPAR].[FICEXT_0] AS [MINP_ZEDIPAR_FICEXT_0], [MINP].[ZEDIPAR].[FICSEP_0] AS [MINP_ZEDIPAR_FICSEP_0], [MINP].[ZEDIPAR].[FICFLG_0] AS [MINP_ZEDIPAR_FICFLG_0], [MINP].[ZEDIPAR].[FICFLG_1] AS [MINP_ZEDIPAR_FICFLG_1], [MINP].[ZEDIPAR].[FICFLG_2] AS [MINP_ZEDIPAR_FICFLG_2], [MINP].[ZEDIPAR].[FICFLG_3] AS [MINP_ZEDIPAR_FICFLG_3], [MINP].[ZEDIPAR].[FICFLG_4] AS [MINP_ZEDIPAR_FICFLG_4], [MINP].[ZEDIPAR].[FICFLG_5] AS [MINP_ZEDIPAR_FICFLG_5], [MINP].[ZEDIPAR].[FICFLG_6] AS [MINP_ZEDIPAR_FICFLG_6], [MINP].[ZEDIPAR].[FICFLG_7] AS [MINP_ZEDIPAR_FICFLG_7], [MINP].[ZEDIPAR].[FICFLG_8] AS [MINP_ZEDIPAR_FICFLG_8], [MINP].[ZEDIPAR].[FICFLG_9] AS [MINP_ZEDIPAR_FICFLG_9], [MINP].[ZEDIPAR].[FICPRE_0] AS [MINP_ZEDIPAR_FICPRE_0], [MINP].[ZEDIPAR].[FICPRE_1] AS [MINP_ZEDIPAR_FICPRE_1], [MINP].[ZEDIPAR].[FICPRE_2] AS [MINP_ZEDIPAR_FICPRE_2], [MINP].[ZEDIPAR].[FICPRE_3] AS [MINP_ZEDIPAR_FICPRE_3], [MINP].[ZEDIPAR].[FICPRE_4] AS [MINP_ZEDIPAR_FICPRE_4], [MINP].[ZEDIPAR].[FICPRE_5] AS [MINP_ZEDIPAR_FICPRE_5], [MINP].[ZEDIPAR].[FICPRE_6] AS [MINP_ZEDIPAR_FICPRE_6], [MINP].[ZEDIPAR].[FICPRE_7] AS [MINP_ZEDIPAR_FICPRE_7], [MINP].[ZEDIPAR].[FICPRE_8] AS [MINP_ZEDIPAR_FICPRE_8], [MINP].[ZEDIPAR].[FICPRE_9] AS [MINP_ZEDIPAR_FICPRE_9], [MINP].[ZEDIPAR].[FICCOU_0] AS [MINP_ZEDIPAR_FICCOU_0], [MINP].[ZEDIPAR].[FICCOU_1] AS [MINP_ZEDIPAR_FICCOU_1], [MINP].[ZEDIPAR].[FICCOU_2] AS [MINP_ZEDIPAR_FICCOU_2], [MINP].[ZEDIPAR].[FICCOU_3] AS [MINP_ZEDIPAR_FICCOU_3], [MINP].[ZEDIPAR].[FICCOU_4] AS [MINP_ZEDIPAR_FICCOU_4], [MINP].[ZEDIPAR].[FICCOU_5] AS [MINP_ZEDIPAR_FICCOU_5], [MINP].[ZEDIPAR].[FICCOU_6] AS [MINP_ZEDIPAR_FICCOU_6], [MINP].[ZEDIPAR].[FICCOU_7] AS [MINP_ZEDIPAR_FICCOU_7], [MINP].[ZEDIPAR].[FICCOU_8] AS [MINP_ZEDIPAR_FICCOU_8], [MINP].[ZEDIPAR].[FICCOU_9] AS [MINP_ZEDIPAR_FICCOU_9], [MINP].[ZEDIPAR].[FICDES_0] AS [MINP_ZEDIPAR_FICDES_0], [MINP].[ZEDIPAR].[FICDES_1] AS [MINP_ZEDIPAR_FICDES_1], [MINP].[ZEDIPAR].[FICDES_2] AS [MINP_ZEDIPAR_FICDES_2], [MINP].[ZEDIPAR].[FICDES_3] AS [MINP_ZEDIPAR_FICDES_3], [MINP].[ZEDIPAR].[FICDES_4] AS [MINP_ZEDIPAR_FICDES_4], [MINP].[ZEDIPAR].[FICDES_5] AS [MINP_ZEDIPAR_FICDES_5], [MINP].[ZEDIPAR].[FICDES_6] AS [MINP_ZEDIPAR_FICDES_6], [MINP].[ZEDIPAR].[FICDES_7] AS [MINP_ZEDIPAR_FICDES_7], [MINP].[ZEDIPAR].[FICDES_8] AS [MINP_ZEDIPAR_FICDES_8], [MINP].[ZEDIPAR].[FICDES_9] AS [MINP_ZEDIPAR_FICDES_9], [MINP].[ZEDIPAR].[FICPRO_0] AS [MINP_ZEDIPAR_FICPRO_0], [MINP].[ZEDIPAR].[FICPRO_1] AS [MINP_ZEDIPAR_FICPRO_1], [MINP].[ZEDIPAR].[FICPRO_2] AS [MINP_ZEDIPAR_FICPRO_2], [MINP].[ZEDIPAR].[FICPRO_3] AS [MINP_ZEDIPAR_FICPRO_3], [MINP].[ZEDIPAR].[FICPRO_4] AS [MINP_ZEDIPAR_FICPRO_4], [MINP].[ZEDIPAR].[FICPRO_5] AS [MINP_ZEDIPAR_FICPRO_5], [MINP].[ZEDIPAR].[FICPRO_6] AS [MINP_ZEDIPAR_FICPRO_6], [MINP].[ZEDIPAR].[FICPRO_7] AS [MINP_ZEDIPAR_FICPRO_7], [MINP].[ZEDIPAR].[FICPRO_8] AS [MINP_ZEDIPAR_FICPRO_8], [MINP].[ZEDIPAR].[FICPRO_9] AS [MINP_ZEDIPAR_FICPRO_9], [MINP].[ZEDIPAR].[FICDIR_0] AS [MINP_ZEDIPAR_FICDIR_0], [MINP].[ZEDIPAR].[FICDIR_1] AS [MINP_ZEDIPAR_FICDIR_1], [MINP].[ZEDIPAR].[FICDIR_2] AS [MINP_ZEDIPAR_FICDIR_2], [MINP].[ZEDIPAR].[FICDIR_3] AS [MINP_ZEDIPAR_FICDIR_3], [MINP].[ZEDIPAR].[FICDIR_4] AS [MINP_ZEDIPAR_FICDIR_4], [MINP].[ZEDIPAR].[FICDIR_5] AS [MINP_ZEDIPAR_FICDIR_5], [MINP].[ZEDIPAR].[FICDIR_6] AS [MINP_ZEDIPAR_FICDIR_6], [MINP].[ZEDIPAR].[FICDIR_7] AS [MINP_ZEDIPAR_FICDIR_7], [MINP].[ZEDIPAR].[FICDIR_8] AS [MINP_ZEDIPAR_FICDIR_8], [MINP].[ZEDIPAR].[FICDIR_9] AS [MINP_ZEDIPAR_FICDIR_9], [MINP].[ZEDIPAR].[FICDAT_0] AS [MINP_ZEDIPAR_FICDAT_0], [MINP].[ZEDIPAR].[FICDAT_1] AS [MINP_ZEDIPAR_FICDAT_1], [MINP].[ZEDIPAR].[FICDAT_2] AS [MINP_ZEDIPAR_FICDAT_2], [MINP].[ZEDIPAR].[FICDAT_3] AS [MINP_ZEDIPAR_FICDAT_3], [MINP].[ZEDIPAR].[FICDAT_4] AS [MINP_ZEDIPAR_FICDAT_4], [MINP].[ZEDIPAR].[FICDAT_5] AS [MINP_ZEDIPAR_FICDAT_5], [MINP].[ZEDIPAR].[FICDAT_6] AS [MINP_ZEDIPAR_FICDAT_6], [MINP].[ZEDIPAR].[FICDAT_7] AS [MINP_ZEDIPAR_FICDAT_7], [MINP].[ZEDIPAR].[FICDAT_8] AS [MINP_ZEDIPAR_FICDAT_8], [MINP].[ZEDIPAR].[FICDAT_9] AS [MINP_ZEDIPAR_FICDAT_9], [MINP].[ZEDIPAR].[FICDEL_0] AS [MINP_ZEDIPAR_FICDEL_0], [MINP].[ZEDIPAR].[FICDEL_1] AS [MINP_ZEDIPAR_FICDEL_1], [MINP].[ZEDIPAR].[FICDEL_2] AS [MINP_ZEDIPAR_FICDEL_2], [MINP].[ZEDIPAR].[FICDEL_3] AS [MINP_ZEDIPAR_FICDEL_3], [MINP].[ZEDIPAR].[FICDEL_4] AS [MINP_ZEDIPAR_FICDEL_4], [MINP].[ZEDIPAR].[FICDEL_5] AS [MINP_ZEDIPAR_FICDEL_5], [MINP].[ZEDIPAR].[FICDEL_6] AS [MINP_ZEDIPAR_FICDEL_6], [MINP].[ZEDIPAR].[FICDEL_7] AS [MINP_ZEDIPAR_FICDEL_7], [MINP].[ZEDIPAR].[FICDEL_8] AS [MINP_ZEDIPAR_FICDEL_8], [MINP].[ZEDIPAR].[FICDEL_9] AS [MINP_ZEDIPAR_FICDEL_9], [MINP].[ZEDIPAR].[FICFOR_0] AS [MINP_ZEDIPAR_FICFOR_0], [MINP].[ZEDIPAR].[FICFOR_1] AS [MINP_ZEDIPAR_FICFOR_1], [MINP].[ZEDIPAR].[FICFOR_2] AS [MINP_ZEDIPAR_FICFOR_2], [MINP].[ZEDIPAR].[FICFOR_3] AS [MINP_ZEDIPAR_FICFOR_3], [MINP].[ZEDIPAR].[FICFOR_4] AS [MINP_ZEDIPAR_FICFOR_4], [MINP].[ZEDIPAR].[FICFOR_5] AS [MINP_ZEDIPAR_FICFOR_5], [MINP].[ZEDIPAR].[FICFOR_6] AS [MINP_ZEDIPAR_FICFOR_6], [MINP].[ZEDIPAR].[FICFOR_7] AS [MINP_ZEDIPAR_FICFOR_7], [MINP].[ZEDIPAR].[FICFOR_8] AS [MINP_ZEDIPAR_FICFOR_8], [MINP].[ZEDIPAR].[FICFOR_9] AS [MINP_ZEDIPAR_FICFOR_9], [MINP].[ZEDIPAR].[FICNUM_0] AS [MINP_ZEDIPAR_FICNUM_0], [MINP].[ZEDIPAR].[FICNUM_1] AS [MINP_ZEDIPAR_FICNUM_1], [MINP].[ZEDIPAR].[FICNUM_2] AS [MINP_ZEDIPAR_FICNUM_2], [MINP].[ZEDIPAR].[FICNUM_3] AS [MINP_ZEDIPAR_FICNUM_3], [MINP].[ZEDIPAR].[FICNUM_4] AS [MINP_ZEDIPAR_FICNUM_4], [MINP].[ZEDIPAR].[FICNUM_5] AS [MINP_ZEDIPAR_FICNUM_5], [MINP].[ZEDIPAR].[FICNUM_6] AS [MINP_ZEDIPAR_FICNUM_6], [MINP].[ZEDIPAR].[FICNUM_7] AS [MINP_ZEDIPAR_FICNUM_7], [MINP].[ZEDIPAR].[FICNUM_8] AS [MINP_ZEDIPAR_FICNUM_8], [MINP].[ZEDIPAR].[FICNUM_9] AS [MINP_ZEDIPAR_FICNUM_9], [MINP].[ZEDIPAR].[PEREDI_0] AS [MINP_ZEDIPAR_PEREDI_0], [MINP].[ZEDIPAR].[PEREDI_1] AS [MINP_ZEDIPAR_PEREDI_1], [MINP].[ZEDIPAR].[PEREDI_2] AS [MINP_ZEDIPAR_PEREDI_2], [MINP].[ZEDIPAR].[PEREDI_3] AS [MINP_ZEDIPAR_PEREDI_3], [MINP].[ZEDIPAR].[PEREDI_4] AS [MINP_ZEDIPAR_PEREDI_4], [MINP].[ZEDIPAR].[PEREDI_5] AS [MINP_ZEDIPAR_PEREDI_5], [MINP].[ZEDIPAR].[PEREDI_6] AS [MINP_ZEDIPAR_PEREDI_6], [MINP].[ZEDIPAR].[PEREDI_7] AS [MINP_ZEDIPAR_PEREDI_7], [MINP].[ZEDIPAR].[PEREDI_8] AS [MINP_ZEDIPAR_PEREDI_8], [MINP].[ZEDIPAR].[PEREDI_9] AS [MINP_ZEDIPAR_PEREDI_9], [MINP].[ZEDIPAR].[PERIODI_0] AS [MINP_ZEDIPAR_PERIODI_0], [MINP].[ZEDIPAR].[PERIODI_1] AS [MINP_ZEDIPAR_PERIODI_1], [MINP].[ZEDIPAR].[PERIODI_2] AS [MINP_ZEDIPAR_PERIODI_2], [MINP].[ZEDIPAR].[PERIODI_3] AS [MINP_ZEDIPAR_PERIODI_3], [MINP].[ZEDIPAR].[PERIODI_4] AS [MINP_ZEDIPAR_PERIODI_4], [MINP].[ZEDIPAR].[PERIODI_5] AS [MINP_ZEDIPAR_PERIODI_5], [MINP].[ZEDIPAR].[PERIODI_6] AS [MINP_ZEDIPAR_PERIODI_6], [MINP].[ZEDIPAR].[PERIODI_7] AS [MINP_ZEDIPAR_PERIODI_7], [MINP].[ZEDIPAR].[PERIODI_8] AS [MINP_ZEDIPAR_PERIODI_8], [MINP].[ZEDIPAR].[PERIODI_9] AS [MINP_ZEDIPAR_PERIODI_9], [MINP].[ZEDIPAR].[MDL_0] AS [MINP_ZEDIPAR_MDL_0], [MINP].[ZEDIPAR].[MDL_1] AS [MINP_ZEDIPAR_MDL_1], [MINP].[ZEDIPAR].[MDL_2] AS [MINP_ZEDIPAR_MDL_2], [MINP].[ZEDIPAR].[MDL_3] AS [MINP_ZEDIPAR_MDL_3], [MINP].[ZEDIPAR].[MDL_4] AS [MINP_ZEDIPAR_MDL_4], [MINP].[ZEDIPAR].[MDLTIM_0] AS [MINP_ZEDIPAR_MDLTIM_0], [MINP].[ZEDIPAR].[MDLTIM_1] AS [MINP_ZEDIPAR_MDLTIM_1], [MINP].[ZEDIPAR].[MDLTIM_2] AS [MINP_ZEDIPAR_MDLTIM_2], [MINP].[ZEDIPAR].[MDLTIM_3] AS [MINP_ZEDIPAR_MDLTIM_3], [MINP].[ZEDIPAR].[MDLTIM_4] AS [MINP_ZEDIPAR_MDLTIM_4], [MINP].[ZEDIPAR].[PUBGES_0] AS [MINP_ZEDIPAR_PUBGES_0], [MINP].[ZEDIPAR].[PUBANA_0] AS [MINP_ZEDIPAR_PUBANA_0], [MINP].[ZEDIPAR].[FLGBAS_0] AS [MINP_ZEDIPAR_FLGBAS_0], [MINP].[ZEDIPAR].[FLGQTY_0] AS [MINP_ZEDIPAR_FLGQTY_0], [MINP].[ZEDIPAR].[FLGNUM_0] AS [MINP_ZEDIPAR_FLGNUM_0], [MINP].[ZEDIPAR].[FLGXLS_0] AS [MINP_ZEDIPAR_FLGXLS_0], [MINP].[ZEDIPAR].[FLGPAC_0] AS [MINP_ZEDIPAR_FLGPAC_0], [MINP].[ZEDIPAR].[COLOR_0] AS [MINP_ZEDIPAR_COLOR_0], [MINP].[ZEDIPAR].[DSCBPS_0] AS [MINP_ZEDIPAR_DSCBPS_0], [MINP].[ZEDIPAR].[ROWID] AS [MINP_ZEDIPAR_ROWID], [MINP].[ZEDIPAR].[CREUSR_0] AS [MINP_ZEDIPAR_CREUSR_0], [MINP].[ZEDIPAR].[UPDUSR_0] AS [MINP_ZEDIPAR_UPDUSR_0], [MINP].[ZEDIPAR].[CREDATTIM_0] AS [MINP_ZEDIPAR_CREDATTIM_0], [MINP].[ZEDIPAR].[UPDDATTIM_0] AS [MINP_ZEDIPAR_UPDDATTIM_0], [MINP].[ZEDIPAR].[AUUID_0] AS [MINP_ZEDIPAR_AUUID_0], [MINP].[ZEDIPAR].[UPDTICK_0] AS [MINP_ZEDIPAR_UPDTICK_0] 
FROM [MINP].[ZEDIPAR] 
WHERE [MINP].[ZEDIPAR].[ENAFLG_0] = %(ENAFLG_0_1)s AND [MINP].[ZEDIPAR].[FTPFLG_0] = %(FTPFLG_0_1)s
2025-08-18 17:52:35,284 - INFO - sqlalchemy.engine.Engine - [generated in 0.00164s] {'ENAFLG_0_1': <YesNo.YES: 2>, 'FTPFLG_0_1': <YesNo.YES: 2>}
2025-08-18 17:52:35,316 - INFO - src.services.provider_service - Encontrados 1 fornecedores ativos.
2025-08-18 17:52:35,317 - INFO - sqlalchemy.engine.Engine - ROLLBACK
2025-08-18 17:52:35,369 - INFO - __main__ - Fornecedores carregados com sucesso:
2025-08-18 17:52:35,369 - INFO - src.services.transfer_service - A iniciar processamento para o fornecedor: 1510 com protocolo: 'FTP'
2025-08-18 17:52:44,045 - INFO - src.services.strategies - Fornecedor '1510' usará a classe de estratégia: MlpStrategy
2025-08-18 17:52:44,046 - INFO - src.transfer.ftp_manager - A conectar ao servidor FTP em export.mlp.fr:21...
2025-08-18 17:52:44,250 - INFO - src.transfer.ftp_manager - Conexão FTP com 'export.mlp.fr' estabelecida com sucesso.
2025-08-18 17:52:44,250 - INFO - src.services.strategies - [1510] Valor inválido na configuração da Tarefa 5: 0 is not a valid ImportExport. Ignorar tarefa.
2025-08-18 17:52:44,250 - INFO - src.services.strategies - [1510] Valor inválido na configuração da Tarefa 6: 0 is not a valid ImportExport. Ignorar tarefa.
2025-08-18 17:52:44,250 - INFO - src.services.strategies - [1510] Valor inválido na configuração da Tarefa 7: 0 is not a valid ImportExport. Ignorar tarefa.
2025-08-18 17:52:44,250 - INFO - src.services.strategies - [1510] Valor inválido na configuração da Tarefa 8: 0 is not a valid ImportExport. Ignorar tarefa.
2025-08-18 17:52:44,250 - INFO - src.services.strategies - [1510] Valor inválido na configuração da Tarefa 9: 0 is not a valid ImportExport. Ignorar tarefa.
2025-08-18 17:52:44,250 - INFO - src.services.strategies - [1510] Foram selecionadas 5 tarefas para execução.
2025-08-18 17:52:44,250 - INFO - src.services.strategies - [1510] A executar a estratégia: MlpStrategy
2025-08-18 17:52:44,250 - INFO - src.services.strategies - [1510][MLP] Processar ficheiros para a 20250814 com o prefixo "R".
2025-08-18 17:52:44,250 - INFO - src.services.strategies - [1510] A processar Tarefa 0: Direção=IMPORT/DOWNLOAD, Prefixo="R"
2025-08-18 17:52:44,250 - INFO - src.transfer.ftp_manager - Listar ficheiros em '/Output'...
2025-08-18 17:53:01,437 - INFO - src.services.strategies - [1510] Tarefa 0: Encontrados 1 ficheiros para download.
2025-08-18 17:53:05,761 - INFO - src.services.strategies - [1510] A receber: /Output/R2025081401.TXT -> logs\ftp\IMPORT\1510\R2025081401.TXT
2025-08-18 17:53:12,698 - INFO - src.transfer.ftp_manager - Iniciar download de '/Output/R2025081401.TXT' para 'logs\ftp\IMPORT\1510\R2025081401.TXT'...
2025-08-18 17:53:25,476 - INFO - src.transfer.ftp_manager - Download concluído com sucesso.
2025-08-18 17:53:42,569 - INFO - src.services.strategies - [1510][MLP] Processar ficheiros para a 20250814 com o prefixo "E".
2025-08-18 17:53:48,365 - INFO - src.services.strategies - [1510] A processar Tarefa 1: Direção=IMPORT/DOWNLOAD, Prefixo="E"
2025-08-18 17:53:51,342 - INFO - src.transfer.ftp_manager - Listar ficheiros em '/Output'...
2025-08-18 17:53:59,927 - INFO - src.services.strategies - [1510] Tarefa 1: Encontrados 1 ficheiros para download.
2025-08-18 17:53:59,928 - INFO - src.services.strategies - [1510] A receber: /Output/E2025081401.TXT -> logs\ftp\IMPORT\1510\E2025081401.TXT
2025-08-18 17:53:59,928 - INFO - src.transfer.ftp_manager - Iniciar download de '/Output/E2025081401.TXT' para 'logs\ftp\IMPORT\1510\E2025081401.TXT'...
2025-08-18 17:54:00,212 - INFO - src.transfer.ftp_manager - Download concluído com sucesso.
2025-08-18 17:54:00,218 - INFO - src.services.strategies - [1510][MLP] Processar ficheiros para a 20250814 com o prefixo "M".
2025-08-18 17:54:00,218 - INFO - src.services.strategies - [1510] A processar Tarefa 2: Direção=EXPORT/UPLOAD, Prefixo="M"
2025-08-18 17:54:00,218 - INFO - src.services.strategies - [1510] Tarefa 2: Nenhum ficheiro encontrado em logs\ftp\EXPORT\1510 com o prefixo M.
2025-08-18 17:54:00,218 - INFO - src.services.strategies - [1510][MLP] Processar ficheiros para a 20250814 com o prefixo "F".
2025-08-18 17:54:00,218 - INFO - src.services.strategies - [1510] A processar Tarefa 3: Direção=IMPORT/DOWNLOAD, Prefixo="F"
2025-08-18 17:54:00,218 - INFO - src.transfer.ftp_manager - Listar ficheiros em '/Output'...
2025-08-18 17:54:00,428 - INFO - src.services.strategies - [1510] Tarefa 3: Nenhum ficheiro encontrado em /Output com o prefixo "F".
2025-08-18 17:54:00,428 - INFO - src.services.strategies - [1510][MLP] Processar ficheiros para a 20250814 com o prefixo "A".
2025-08-18 17:54:00,428 - INFO - src.services.strategies - [1510] A processar Tarefa 4: Direção=IMPORT/DOWNLOAD, Prefixo="A"
2025-08-18 17:54:00,429 - INFO - src.transfer.ftp_manager - Listar ficheiros em '/Output'...
2025-08-18 17:54:00,646 - INFO - src.services.strategies - [1510] Tarefa 4: Nenhum ficheiro encontrado em /Output com o prefixo "A".
2025-08-18 17:54:00,693 - INFO - src.transfer.ftp_manager - Conexão FTP com 'export.mlp.fr' fechada.
2025-08-18 17:54:00,693 - INFO - src.services.transfer_service - Processamento para o fornecedor 1510 concluído com sucesso.
2025-08-18 17:58:45,370 - INFO - src.config.logging - Logging configurado. Root level: DEBUG. Handlers: console, info_file, error_file
2025-08-18 17:58:45,380 - INFO - __main__ - Iniciando o backend de transferência de ficheiros...
2025-08-18 17:58:45,380 - INFO - src.services.provider_service - A buscar configurações de fornecedores ativos via ORM...
2025-08-18 17:58:45,560 - INFO - sqlalchemy.engine.Engine - select @@version
2025-08-18 17:58:45,560 - INFO - sqlalchemy.engine.Engine - [raw sql] {}
2025-08-18 17:58:45,580 - INFO - sqlalchemy.engine.Engine - SELECT schema_name()
2025-08-18 17:58:45,580 - INFO - sqlalchemy.engine.Engine - [generated in 0.00065s] {}
2025-08-18 17:58:45,653 - INFO - sqlalchemy.engine.Engine - SELECT CAST('test max support' AS NVARCHAR(max))
2025-08-18 17:58:45,653 - INFO - sqlalchemy.engine.Engine - [generated in 0.00041s] {}
2025-08-18 17:58:45,681 - INFO - sqlalchemy.engine.Engine - SELECT 1 FROM fn_listextendedproperty(default, default, default, default, default, default, default)
2025-08-18 17:58:45,681 - INFO - sqlalchemy.engine.Engine - [generated in 0.00044s] {}
2025-08-18 17:58:45,731 - INFO - sqlalchemy.engine.Engine - BEGIN (implicit)
2025-08-18 17:58:45,740 - INFO - sqlalchemy.engine.Engine - SELECT [MINP].[ZEDIPAR].[BPRNUM_0] AS [MINP_ZEDIPAR_BPRNUM_0], [MINP].[ZEDIPAR].[BPRNAM_0] AS [MINP_ZEDIPAR_BPRNAM_0], [MINP].[ZEDIPAR].[ENAFLG_0] AS [MINP_ZEDIPAR_ENAFLG_0], [MINP].[ZEDIPAR].[BPRID_0] AS [MINP_ZEDIPAR_BPRID_0], [MINP].[ZEDIPAR].[FTPFLG_0] AS [MINP_ZEDIPAR_FTPFLG_0], [MINP].[ZEDIPAR].[FTPTYP_0] AS [MINP_ZEDIPAR_FTPTYP_0], [MINP].[ZEDIPAR].[FTPURL_0] AS [MINP_ZEDIPAR_FTPURL_0], [MINP].[ZEDIPAR].[FTPUSR_0] AS [MINP_ZEDIPAR_FTPUSR_0], [MINP].[ZEDIPAR].[FTPPSW_0] AS [MINP_ZEDIPAR_FTPPSW_0], [MINP].[ZEDIPAR].[FTPMOD_0] AS [MINP_ZEDIPAR_FTPMOD_0], [MINP].[ZEDIPAR].[FTPINP_0] AS [MINP_ZEDIPAR_FTPINP_0], [MINP].[ZEDIPAR].[FTPOUT_0] AS [MINP_ZEDIPAR_FTPOUT_0], [MINP].[ZEDIPAR].[FTPFOR_0] AS [MINP_ZEDIPAR_FTPFOR_0], [MINP].[ZEDIPAR].[FTPTRT_0] AS [MINP_ZEDIPAR_FTPTRT_0], [MINP].[ZEDIPAR].[FTPFIC_0] AS [MINP_ZEDIPAR_FTPFIC_0], [MINP].[ZEDIPAR].[FTPEXP_0] AS [MINP_ZEDIPAR_FTPEXP_0], [MINP].[ZEDIPAR].[FTPUNI_0] AS [MINP_ZEDIPAR_FTPUNI_0], [MINP].[ZEDIPAR].[DRTINP_0] AS [MINP_ZEDIPAR_DRTINP_0], [MINP].[ZEDIPAR].[EXTINP_0] AS [MINP_ZEDIPAR_EXTINP_0], [MINP].[ZEDIPAR].[DRTOUT_0] AS [MINP_ZEDIPAR_DRTOUT_0], [MINP].[ZEDIPAR].[EXTOUT_0] AS [MINP_ZEDIPAR_EXTOUT_0], [MINP].[ZEDIPAR].[FICEXT_0] AS [MINP_ZEDIPAR_FICEXT_0], [MINP].[ZEDIPAR].[FICSEP_0] AS [MINP_ZEDIPAR_FICSEP_0], [MINP].[ZEDIPAR].[FICFLG_0] AS [MINP_ZEDIPAR_FICFLG_0], [MINP].[ZEDIPAR].[FICFLG_1] AS [MINP_ZEDIPAR_FICFLG_1], [MINP].[ZEDIPAR].[FICFLG_2] AS [MINP_ZEDIPAR_FICFLG_2], [MINP].[ZEDIPAR].[FICFLG_3] AS [MINP_ZEDIPAR_FICFLG_3], [MINP].[ZEDIPAR].[FICFLG_4] AS [MINP_ZEDIPAR_FICFLG_4], [MINP].[ZEDIPAR].[FICFLG_5] AS [MINP_ZEDIPAR_FICFLG_5], [MINP].[ZEDIPAR].[FICFLG_6] AS [MINP_ZEDIPAR_FICFLG_6], [MINP].[ZEDIPAR].[FICFLG_7] AS [MINP_ZEDIPAR_FICFLG_7], [MINP].[ZEDIPAR].[FICFLG_8] AS [MINP_ZEDIPAR_FICFLG_8], [MINP].[ZEDIPAR].[FICFLG_9] AS [MINP_ZEDIPAR_FICFLG_9], [MINP].[ZEDIPAR].[FICPRE_0] AS [MINP_ZEDIPAR_FICPRE_0], [MINP].[ZEDIPAR].[FICPRE_1] AS [MINP_ZEDIPAR_FICPRE_1], [MINP].[ZEDIPAR].[FICPRE_2] AS [MINP_ZEDIPAR_FICPRE_2], [MINP].[ZEDIPAR].[FICPRE_3] AS [MINP_ZEDIPAR_FICPRE_3], [MINP].[ZEDIPAR].[FICPRE_4] AS [MINP_ZEDIPAR_FICPRE_4], [MINP].[ZEDIPAR].[FICPRE_5] AS [MINP_ZEDIPAR_FICPRE_5], [MINP].[ZEDIPAR].[FICPRE_6] AS [MINP_ZEDIPAR_FICPRE_6], [MINP].[ZEDIPAR].[FICPRE_7] AS [MINP_ZEDIPAR_FICPRE_7], [MINP].[ZEDIPAR].[FICPRE_8] AS [MINP_ZEDIPAR_FICPRE_8], [MINP].[ZEDIPAR].[FICPRE_9] AS [MINP_ZEDIPAR_FICPRE_9], [MINP].[ZEDIPAR].[FICCOU_0] AS [MINP_ZEDIPAR_FICCOU_0], [MINP].[ZEDIPAR].[FICCOU_1] AS [MINP_ZEDIPAR_FICCOU_1], [MINP].[ZEDIPAR].[FICCOU_2] AS [MINP_ZEDIPAR_FICCOU_2], [MINP].[ZEDIPAR].[FICCOU_3] AS [MINP_ZEDIPAR_FICCOU_3], [MINP].[ZEDIPAR].[FICCOU_4] AS [MINP_ZEDIPAR_FICCOU_4], [MINP].[ZEDIPAR].[FICCOU_5] AS [MINP_ZEDIPAR_FICCOU_5], [MINP].[ZEDIPAR].[FICCOU_6] AS [MINP_ZEDIPAR_FICCOU_6], [MINP].[ZEDIPAR].[FICCOU_7] AS [MINP_ZEDIPAR_FICCOU_7], [MINP].[ZEDIPAR].[FICCOU_8] AS [MINP_ZEDIPAR_FICCOU_8], [MINP].[ZEDIPAR].[FICCOU_9] AS [MINP_ZEDIPAR_FICCOU_9], [MINP].[ZEDIPAR].[FICDES_0] AS [MINP_ZEDIPAR_FICDES_0], [MINP].[ZEDIPAR].[FICDES_1] AS [MINP_ZEDIPAR_FICDES_1], [MINP].[ZEDIPAR].[FICDES_2] AS [MINP_ZEDIPAR_FICDES_2], [MINP].[ZEDIPAR].[FICDES_3] AS [MINP_ZEDIPAR_FICDES_3], [MINP].[ZEDIPAR].[FICDES_4] AS [MINP_ZEDIPAR_FICDES_4], [MINP].[ZEDIPAR].[FICDES_5] AS [MINP_ZEDIPAR_FICDES_5], [MINP].[ZEDIPAR].[FICDES_6] AS [MINP_ZEDIPAR_FICDES_6], [MINP].[ZEDIPAR].[FICDES_7] AS [MINP_ZEDIPAR_FICDES_7], [MINP].[ZEDIPAR].[FICDES_8] AS [MINP_ZEDIPAR_FICDES_8], [MINP].[ZEDIPAR].[FICDES_9] AS [MINP_ZEDIPAR_FICDES_9], [MINP].[ZEDIPAR].[FICPRO_0] AS [MINP_ZEDIPAR_FICPRO_0], [MINP].[ZEDIPAR].[FICPRO_1] AS [MINP_ZEDIPAR_FICPRO_1], [MINP].[ZEDIPAR].[FICPRO_2] AS [MINP_ZEDIPAR_FICPRO_2], [MINP].[ZEDIPAR].[FICPRO_3] AS [MINP_ZEDIPAR_FICPRO_3], [MINP].[ZEDIPAR].[FICPRO_4] AS [MINP_ZEDIPAR_FICPRO_4], [MINP].[ZEDIPAR].[FICPRO_5] AS [MINP_ZEDIPAR_FICPRO_5], [MINP].[ZEDIPAR].[FICPRO_6] AS [MINP_ZEDIPAR_FICPRO_6], [MINP].[ZEDIPAR].[FICPRO_7] AS [MINP_ZEDIPAR_FICPRO_7], [MINP].[ZEDIPAR].[FICPRO_8] AS [MINP_ZEDIPAR_FICPRO_8], [MINP].[ZEDIPAR].[FICPRO_9] AS [MINP_ZEDIPAR_FICPRO_9], [MINP].[ZEDIPAR].[FICDIR_0] AS [MINP_ZEDIPAR_FICDIR_0], [MINP].[ZEDIPAR].[FICDIR_1] AS [MINP_ZEDIPAR_FICDIR_1], [MINP].[ZEDIPAR].[FICDIR_2] AS [MINP_ZEDIPAR_FICDIR_2], [MINP].[ZEDIPAR].[FICDIR_3] AS [MINP_ZEDIPAR_FICDIR_3], [MINP].[ZEDIPAR].[FICDIR_4] AS [MINP_ZEDIPAR_FICDIR_4], [MINP].[ZEDIPAR].[FICDIR_5] AS [MINP_ZEDIPAR_FICDIR_5], [MINP].[ZEDIPAR].[FICDIR_6] AS [MINP_ZEDIPAR_FICDIR_6], [MINP].[ZEDIPAR].[FICDIR_7] AS [MINP_ZEDIPAR_FICDIR_7], [MINP].[ZEDIPAR].[FICDIR_8] AS [MINP_ZEDIPAR_FICDIR_8], [MINP].[ZEDIPAR].[FICDIR_9] AS [MINP_ZEDIPAR_FICDIR_9], [MINP].[ZEDIPAR].[FICDAT_0] AS [MINP_ZEDIPAR_FICDAT_0], [MINP].[ZEDIPAR].[FICDAT_1] AS [MINP_ZEDIPAR_FICDAT_1], [MINP].[ZEDIPAR].[FICDAT_2] AS [MINP_ZEDIPAR_FICDAT_2], [MINP].[ZEDIPAR].[FICDAT_3] AS [MINP_ZEDIPAR_FICDAT_3], [MINP].[ZEDIPAR].[FICDAT_4] AS [MINP_ZEDIPAR_FICDAT_4], [MINP].[ZEDIPAR].[FICDAT_5] AS [MINP_ZEDIPAR_FICDAT_5], [MINP].[ZEDIPAR].[FICDAT_6] AS [MINP_ZEDIPAR_FICDAT_6], [MINP].[ZEDIPAR].[FICDAT_7] AS [MINP_ZEDIPAR_FICDAT_7], [MINP].[ZEDIPAR].[FICDAT_8] AS [MINP_ZEDIPAR_FICDAT_8], [MINP].[ZEDIPAR].[FICDAT_9] AS [MINP_ZEDIPAR_FICDAT_9], [MINP].[ZEDIPAR].[FICDEL_0] AS [MINP_ZEDIPAR_FICDEL_0], [MINP].[ZEDIPAR].[FICDEL_1] AS [MINP_ZEDIPAR_FICDEL_1], [MINP].[ZEDIPAR].[FICDEL_2] AS [MINP_ZEDIPAR_FICDEL_2], [MINP].[ZEDIPAR].[FICDEL_3] AS [MINP_ZEDIPAR_FICDEL_3], [MINP].[ZEDIPAR].[FICDEL_4] AS [MINP_ZEDIPAR_FICDEL_4], [MINP].[ZEDIPAR].[FICDEL_5] AS [MINP_ZEDIPAR_FICDEL_5], [MINP].[ZEDIPAR].[FICDEL_6] AS [MINP_ZEDIPAR_FICDEL_6], [MINP].[ZEDIPAR].[FICDEL_7] AS [MINP_ZEDIPAR_FICDEL_7], [MINP].[ZEDIPAR].[FICDEL_8] AS [MINP_ZEDIPAR_FICDEL_8], [MINP].[ZEDIPAR].[FICDEL_9] AS [MINP_ZEDIPAR_FICDEL_9], [MINP].[ZEDIPAR].[FICFOR_0] AS [MINP_ZEDIPAR_FICFOR_0], [MINP].[ZEDIPAR].[FICFOR_1] AS [MINP_ZEDIPAR_FICFOR_1], [MINP].[ZEDIPAR].[FICFOR_2] AS [MINP_ZEDIPAR_FICFOR_2], [MINP].[ZEDIPAR].[FICFOR_3] AS [MINP_ZEDIPAR_FICFOR_3], [MINP].[ZEDIPAR].[FICFOR_4] AS [MINP_ZEDIPAR_FICFOR_4], [MINP].[ZEDIPAR].[FICFOR_5] AS [MINP_ZEDIPAR_FICFOR_5], [MINP].[ZEDIPAR].[FICFOR_6] AS [MINP_ZEDIPAR_FICFOR_6], [MINP].[ZEDIPAR].[FICFOR_7] AS [MINP_ZEDIPAR_FICFOR_7], [MINP].[ZEDIPAR].[FICFOR_8] AS [MINP_ZEDIPAR_FICFOR_8], [MINP].[ZEDIPAR].[FICFOR_9] AS [MINP_ZEDIPAR_FICFOR_9], [MINP].[ZEDIPAR].[FICNUM_0] AS [MINP_ZEDIPAR_FICNUM_0], [MINP].[ZEDIPAR].[FICNUM_1] AS [MINP_ZEDIPAR_FICNUM_1], [MINP].[ZEDIPAR].[FICNUM_2] AS [MINP_ZEDIPAR_FICNUM_2], [MINP].[ZEDIPAR].[FICNUM_3] AS [MINP_ZEDIPAR_FICNUM_3], [MINP].[ZEDIPAR].[FICNUM_4] AS [MINP_ZEDIPAR_FICNUM_4], [MINP].[ZEDIPAR].[FICNUM_5] AS [MINP_ZEDIPAR_FICNUM_5], [MINP].[ZEDIPAR].[FICNUM_6] AS [MINP_ZEDIPAR_FICNUM_6], [MINP].[ZEDIPAR].[FICNUM_7] AS [MINP_ZEDIPAR_FICNUM_7], [MINP].[ZEDIPAR].[FICNUM_8] AS [MINP_ZEDIPAR_FICNUM_8], [MINP].[ZEDIPAR].[FICNUM_9] AS [MINP_ZEDIPAR_FICNUM_9], [MINP].[ZEDIPAR].[PEREDI_0] AS [MINP_ZEDIPAR_PEREDI_0], [MINP].[ZEDIPAR].[PEREDI_1] AS [MINP_ZEDIPAR_PEREDI_1], [MINP].[ZEDIPAR].[PEREDI_2] AS [MINP_ZEDIPAR_PEREDI_2], [MINP].[ZEDIPAR].[PEREDI_3] AS [MINP_ZEDIPAR_PEREDI_3], [MINP].[ZEDIPAR].[PEREDI_4] AS [MINP_ZEDIPAR_PEREDI_4], [MINP].[ZEDIPAR].[PEREDI_5] AS [MINP_ZEDIPAR_PEREDI_5], [MINP].[ZEDIPAR].[PEREDI_6] AS [MINP_ZEDIPAR_PEREDI_6], [MINP].[ZEDIPAR].[PEREDI_7] AS [MINP_ZEDIPAR_PEREDI_7], [MINP].[ZEDIPAR].[PEREDI_8] AS [MINP_ZEDIPAR_PEREDI_8], [MINP].[ZEDIPAR].[PEREDI_9] AS [MINP_ZEDIPAR_PEREDI_9], [MINP].[ZEDIPAR].[PERIODI_0] AS [MINP_ZEDIPAR_PERIODI_0], [MINP].[ZEDIPAR].[PERIODI_1] AS [MINP_ZEDIPAR_PERIODI_1], [MINP].[ZEDIPAR].[PERIODI_2] AS [MINP_ZEDIPAR_PERIODI_2], [MINP].[ZEDIPAR].[PERIODI_3] AS [MINP_ZEDIPAR_PERIODI_3], [MINP].[ZEDIPAR].[PERIODI_4] AS [MINP_ZEDIPAR_PERIODI_4], [MINP].[ZEDIPAR].[PERIODI_5] AS [MINP_ZEDIPAR_PERIODI_5], [MINP].[ZEDIPAR].[PERIODI_6] AS [MINP_ZEDIPAR_PERIODI_6], [MINP].[ZEDIPAR].[PERIODI_7] AS [MINP_ZEDIPAR_PERIODI_7], [MINP].[ZEDIPAR].[PERIODI_8] AS [MINP_ZEDIPAR_PERIODI_8], [MINP].[ZEDIPAR].[PERIODI_9] AS [MINP_ZEDIPAR_PERIODI_9], [MINP].[ZEDIPAR].[MDL_0] AS [MINP_ZEDIPAR_MDL_0], [MINP].[ZEDIPAR].[MDL_1] AS [MINP_ZEDIPAR_MDL_1], [MINP].[ZEDIPAR].[MDL_2] AS [MINP_ZEDIPAR_MDL_2], [MINP].[ZEDIPAR].[MDL_3] AS [MINP_ZEDIPAR_MDL_3], [MINP].[ZEDIPAR].[MDL_4] AS [MINP_ZEDIPAR_MDL_4], [MINP].[ZEDIPAR].[MDLTIM_0] AS [MINP_ZEDIPAR_MDLTIM_0], [MINP].[ZEDIPAR].[MDLTIM_1] AS [MINP_ZEDIPAR_MDLTIM_1], [MINP].[ZEDIPAR].[MDLTIM_2] AS [MINP_ZEDIPAR_MDLTIM_2], [MINP].[ZEDIPAR].[MDLTIM_3] AS [MINP_ZEDIPAR_MDLTIM_3], [MINP].[ZEDIPAR].[MDLTIM_4] AS [MINP_ZEDIPAR_MDLTIM_4], [MINP].[ZEDIPAR].[PUBGES_0] AS [MINP_ZEDIPAR_PUBGES_0], [MINP].[ZEDIPAR].[PUBANA_0] AS [MINP_ZEDIPAR_PUBANA_0], [MINP].[ZEDIPAR].[FLGBAS_0] AS [MINP_ZEDIPAR_FLGBAS_0], [MINP].[ZEDIPAR].[FLGQTY_0] AS [MINP_ZEDIPAR_FLGQTY_0], [MINP].[ZEDIPAR].[FLGNUM_0] AS [MINP_ZEDIPAR_FLGNUM_0], [MINP].[ZEDIPAR].[FLGXLS_0] AS [MINP_ZEDIPAR_FLGXLS_0], [MINP].[ZEDIPAR].[FLGPAC_0] AS [MINP_ZEDIPAR_FLGPAC_0], [MINP].[ZEDIPAR].[COLOR_0] AS [MINP_ZEDIPAR_COLOR_0], [MINP].[ZEDIPAR].[DSCBPS_0] AS [MINP_ZEDIPAR_DSCBPS_0], [MINP].[ZEDIPAR].[ROWID] AS [MINP_ZEDIPAR_ROWID], [MINP].[ZEDIPAR].[CREUSR_0] AS [MINP_ZEDIPAR_CREUSR_0], [MINP].[ZEDIPAR].[UPDUSR_0] AS [MINP_ZEDIPAR_UPDUSR_0], [MINP].[ZEDIPAR].[CREDATTIM_0] AS [MINP_ZEDIPAR_CREDATTIM_0], [MINP].[ZEDIPAR].[UPDDATTIM_0] AS [MINP_ZEDIPAR_UPDDATTIM_0], [MINP].[ZEDIPAR].[AUUID_0] AS [MINP_ZEDIPAR_AUUID_0], [MINP].[ZEDIPAR].[UPDTICK_0] AS [MINP_ZEDIPAR_UPDTICK_0] 
FROM [MINP].[ZEDIPAR] 
WHERE [MINP].[ZEDIPAR].[ENAFLG_0] = %(ENAFLG_0_1)s AND [MINP].[ZEDIPAR].[FTPFLG_0] = %(FTPFLG_0_1)s
2025-08-18 17:58:45,740 - INFO - sqlalchemy.engine.Engine - [generated in 0.00141s] {'ENAFLG_0_1': <YesNo.YES: 2>, 'FTPFLG_0_1': <YesNo.YES: 2>}
2025-08-18 17:58:45,772 - INFO - src.services.provider_service - Encontrados 1 fornecedores ativos.
2025-08-18 17:58:45,772 - INFO - sqlalchemy.engine.Engine - ROLLBACK
2025-08-18 17:58:45,822 - INFO - __main__ - Fornecedores carregados com sucesso:
2025-08-18 17:58:45,822 - INFO - src.services.transfer_service - A iniciar processamento para o fornecedor: 1510 com protocolo: 'FTP'
2025-08-18 17:58:58,855 - INFO - src.services.strategies - Fornecedor '1510' usará a classe de estratégia: MlpStrategy
2025-08-18 17:58:58,855 - INFO - src.transfer.ftp_manager - A conectar ao servidor FTP em export.mlp.fr:21...
2025-08-18 17:58:59,050 - INFO - src.transfer.ftp_manager - Conexão FTP com 'export.mlp.fr' estabelecida com sucesso.
2025-08-18 17:58:59,050 - INFO - src.services.strategies - [1510] Valor inválido na configuração da Tarefa 5: 0 is not a valid ImportExport. Ignorar tarefa.
2025-08-18 17:58:59,050 - INFO - src.services.strategies - [1510] Valor inválido na configuração da Tarefa 6: 0 is not a valid ImportExport. Ignorar tarefa.
2025-08-18 17:58:59,056 - INFO - src.services.strategies - [1510] Valor inválido na configuração da Tarefa 7: 0 is not a valid ImportExport. Ignorar tarefa.
2025-08-18 17:58:59,056 - INFO - src.services.strategies - [1510] Valor inválido na configuração da Tarefa 8: 0 is not a valid ImportExport. Ignorar tarefa.
2025-08-18 17:58:59,056 - INFO - src.services.strategies - [1510] Valor inválido na configuração da Tarefa 9: 0 is not a valid ImportExport. Ignorar tarefa.
2025-08-18 17:58:59,056 - INFO - src.services.strategies - [1510] Foram selecionadas 5 tarefas para execução.
2025-08-18 17:58:59,056 - INFO - src.services.strategies - [1510] A executar a estratégia: MlpStrategy
2025-08-18 17:58:59,057 - INFO - src.services.strategies - [1510][MLP] Processar ficheiros para a 20250814 com o prefixo "R".
2025-08-18 17:58:59,057 - INFO - src.services.strategies - [1510] A processar Tarefa 0: Direção=IMPORT/DOWNLOAD, Prefixo="R"
2025-08-18 17:58:59,057 - INFO - src.transfer.ftp_manager - Listar ficheiros em '/Output'...
2025-08-18 17:58:59,261 - INFO - src.services.strategies - [1510] Tarefa 0: Encontrados 1 ficheiros para download.
2025-08-18 17:59:10,547 - INFO - src.services.strategies - [1510] A receber: /Output/R2025081401.TXT -> logs\ftp\IMPORT\1510\R2025081401.TXT
2025-08-18 17:59:20,083 - INFO - src.transfer.ftp_manager - Iniciar download de '/Output/R2025081401.TXT' para 'logs\ftp\IMPORT\1510\R2025081401.TXT'...
2025-08-18 17:59:20,344 - INFO - src.transfer.ftp_manager - Download concluído com sucesso.
