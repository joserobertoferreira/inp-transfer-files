2025-08-17 09:52:25,607 - INFO - src.config.logging - Logging configurado. Root level: DEBUG. Handlers: console, info_file, error_file
2025-08-17 09:52:25,607 - INFO - __main__ - Iniciando o backend de transferência de ficheiros...
2025-08-17 09:52:35,816 - INFO - src.services.provider_service - A buscar configurações de fornecedores ativos na base de dados...
2025-08-17 09:52:38,533 - INFO - root - Criar engine e abrir conexão...
2025-08-17 09:52:38,952 - INFO - root - Conexão com o banco de dados estabelecida.
2025-08-17 09:52:41,337 - INFO - root - Executando query: 
        SELECT
            a.BPRNUM_0 as provider_id,
            a.BPRNAM_0 as provider_name,
            ISNULL(b.LANMES_0,'ftp') as protocol,
            a.FTPURL_0 as host,
            a.FTPMOD_0 as mode,
            a.FTPUSR_0 as username,
            a.FTPPSW_0 as password,
            a.FTPOUT_0 as remote_path_out,
            a.FTPINP_0 as remote_path_in,
            a.DRTOUT_0 as local_path_out,
            a.DRTINP_0 as local_path_in
        FROM INP.ZEDIPAR a
        LEFT JOIN INP.APLSTD b ON b.LAN_0='POR' AND b.LANCHP_0=6241 AND b.LANNUM_0=a.FTPTYP_0
        WHERE a.ENAFLG_0=2 AND a.FTPFLG_0=2
    
2025-08-17 09:52:41,340 - INFO - root - Com parâmetros: None
2025-08-17 09:52:53,169 - INFO - root - Conexão fechada.
2025-08-17 09:52:53,171 - INFO - root - Engine disposed.
2025-08-17 09:53:15,682 - INFO - src.services.provider_service - Encontrados 4 fornecedores ativos.
2025-08-17 09:53:21,372 - INFO - __main__ - Fornecedores carregados com sucesso:
2025-08-17 09:53:49,530 - INFO - src.services.transfer_service - A iniciar processamento para o fornecedor: 1510 com código de protocolo: 'ftp'
2025-08-17 09:54:51,747 - INFO - src.services.strategies - Fornecedor '1510' usará a classe de estratégia: BaseTransferStrategy
2025-08-17 09:55:30,179 - INFO - src.transfer.ftp_manager - A conectar ao servidor FTP em export.mlp.fr:21...
2025-08-17 09:55:30,383 - INFO - src.transfer.ftp_manager - Conexão FTP com 'export.mlp.fr' estabelecida com sucesso.
2025-08-17 09:56:19,857 - INFO - src.services.strategies - [1510] A executar a estratégia de transferência padrão.
2025-08-17 09:57:03,067 - INFO - src.transfer.ftp_manager - Listar ficheiros em '/Input'...
2025-08-17 09:57:47,166 - INFO - src.services.strategies - [1510] Encontrados 1 ficheiros para download em '/Input'.
2025-08-17 15:27:45,435 - INFO - src.config.logging - Logging configurado. Root level: DEBUG. Handlers: console, info_file, error_file
2025-08-17 15:27:45,436 - INFO - __main__ - Iniciando o backend de transferência de ficheiros...
2025-08-17 15:27:52,374 - INFO - src.services.provider_service - A buscar configurações de fornecedores ativos via ORM...
2025-08-17 15:27:58,057 - INFO - sqlalchemy.engine.Engine - select @@version
2025-08-17 15:27:58,057 - INFO - sqlalchemy.engine.Engine - [raw sql] {}
2025-08-17 15:27:58,077 - INFO - sqlalchemy.engine.Engine - SELECT schema_name()
2025-08-17 15:27:58,078 - INFO - sqlalchemy.engine.Engine - [generated in 0.00074s] {}
2025-08-17 15:27:58,143 - INFO - sqlalchemy.engine.Engine - SELECT CAST('test max support' AS NVARCHAR(max))
2025-08-17 15:27:58,143 - INFO - sqlalchemy.engine.Engine - [generated in 0.00067s] {}
2025-08-17 15:27:58,176 - INFO - sqlalchemy.engine.Engine - SELECT 1 FROM fn_listextendedproperty(default, default, default, default, default, default, default)
2025-08-17 15:27:58,176 - INFO - sqlalchemy.engine.Engine - [generated in 0.00086s] {}
2025-08-17 15:27:58,283 - INFO - sqlalchemy.engine.Engine - BEGIN (implicit)
2025-08-17 15:27:58,310 - INFO - sqlalchemy.engine.Engine - SELECT [INP].[ZEDIPAR].[BPRNUM_0] AS [INP_ZEDIPAR_BPRNUM_0], [INP].[ZEDIPAR].[BPRNAM_0] AS [INP_ZEDIPAR_BPRNAM_0], [INP].[ZEDIPAR].[ENAFLG_0] AS [INP_ZEDIPAR_ENAFLG_0], [INP].[ZEDIPAR].[BPRID_0] AS [INP_ZEDIPAR_BPRID_0], [INP].[ZEDIPAR].[FTPFLG_0] AS [INP_ZEDIPAR_FTPFLG_0], [INP].[ZEDIPAR].[FTPTYP_0] AS [INP_ZEDIPAR_FTPTYP_0], [INP].[ZEDIPAR].[FTPURL_0] AS [INP_ZEDIPAR_FTPURL_0], [INP].[ZEDIPAR].[FTPUSR_0] AS [INP_ZEDIPAR_FTPUSR_0], [INP].[ZEDIPAR].[FTPPSW_0] AS [INP_ZEDIPAR_FTPPSW_0], [INP].[ZEDIPAR].[FTPMOD_0] AS [INP_ZEDIPAR_FTPMOD_0], [INP].[ZEDIPAR].[FTPINP_0] AS [INP_ZEDIPAR_FTPINP_0], [INP].[ZEDIPAR].[FTPOUT_0] AS [INP_ZEDIPAR_FTPOUT_0], [INP].[ZEDIPAR].[FTPFOR_0] AS [INP_ZEDIPAR_FTPFOR_0], [INP].[ZEDIPAR].[FTPTRT_0] AS [INP_ZEDIPAR_FTPTRT_0], [INP].[ZEDIPAR].[FTPFIC_0] AS [INP_ZEDIPAR_FTPFIC_0], [INP].[ZEDIPAR].[FTPEXP_0] AS [INP_ZEDIPAR_FTPEXP_0], [INP].[ZEDIPAR].[FTPUNI_0] AS [INP_ZEDIPAR_FTPUNI_0], [INP].[ZEDIPAR].[DRTINP_0] AS [INP_ZEDIPAR_DRTINP_0], [INP].[ZEDIPAR].[EXTINP_0] AS [INP_ZEDIPAR_EXTINP_0], [INP].[ZEDIPAR].[DRTOUT_0] AS [INP_ZEDIPAR_DRTOUT_0], [INP].[ZEDIPAR].[EXTOUT_0] AS [INP_ZEDIPAR_EXTOUT_0], [INP].[ZEDIPAR].[FICEXT_0] AS [INP_ZEDIPAR_FICEXT_0], [INP].[ZEDIPAR].[FICSEP_0] AS [INP_ZEDIPAR_FICSEP_0], [INP].[ZEDIPAR].[FICFLG_0] AS [INP_ZEDIPAR_FICFLG_0], [INP].[ZEDIPAR].[FICFLG_1] AS [INP_ZEDIPAR_FICFLG_1], [INP].[ZEDIPAR].[FICFLG_2] AS [INP_ZEDIPAR_FICFLG_2], [INP].[ZEDIPAR].[FICFLG_3] AS [INP_ZEDIPAR_FICFLG_3], [INP].[ZEDIPAR].[FICFLG_4] AS [INP_ZEDIPAR_FICFLG_4], [INP].[ZEDIPAR].[FICFLG_5] AS [INP_ZEDIPAR_FICFLG_5], [INP].[ZEDIPAR].[FICFLG_6] AS [INP_ZEDIPAR_FICFLG_6], [INP].[ZEDIPAR].[FICFLG_7] AS [INP_ZEDIPAR_FICFLG_7], [INP].[ZEDIPAR].[FICFLG_8] AS [INP_ZEDIPAR_FICFLG_8], [INP].[ZEDIPAR].[FICFLG_9] AS [INP_ZEDIPAR_FICFLG_9], [INP].[ZEDIPAR].[FICPRE_0] AS [INP_ZEDIPAR_FICPRE_0], [INP].[ZEDIPAR].[FICPRE_1] AS [INP_ZEDIPAR_FICPRE_1], [INP].[ZEDIPAR].[FICPRE_2] AS [INP_ZEDIPAR_FICPRE_2], [INP].[ZEDIPAR].[FICPRE_3] AS [INP_ZEDIPAR_FICPRE_3], [INP].[ZEDIPAR].[FICPRE_4] AS [INP_ZEDIPAR_FICPRE_4], [INP].[ZEDIPAR].[FICPRE_5] AS [INP_ZEDIPAR_FICPRE_5], [INP].[ZEDIPAR].[FICPRE_6] AS [INP_ZEDIPAR_FICPRE_6], [INP].[ZEDIPAR].[FICPRE_7] AS [INP_ZEDIPAR_FICPRE_7], [INP].[ZEDIPAR].[FICPRE_8] AS [INP_ZEDIPAR_FICPRE_8], [INP].[ZEDIPAR].[FICPRE_9] AS [INP_ZEDIPAR_FICPRE_9], [INP].[ZEDIPAR].[FICCOU_0] AS [INP_ZEDIPAR_FICCOU_0], [INP].[ZEDIPAR].[FICCOU_1] AS [INP_ZEDIPAR_FICCOU_1], [INP].[ZEDIPAR].[FICCOU_2] AS [INP_ZEDIPAR_FICCOU_2], [INP].[ZEDIPAR].[FICCOU_3] AS [INP_ZEDIPAR_FICCOU_3], [INP].[ZEDIPAR].[FICCOU_4] AS [INP_ZEDIPAR_FICCOU_4], [INP].[ZEDIPAR].[FICCOU_5] AS [INP_ZEDIPAR_FICCOU_5], [INP].[ZEDIPAR].[FICCOU_6] AS [INP_ZEDIPAR_FICCOU_6], [INP].[ZEDIPAR].[FICCOU_7] AS [INP_ZEDIPAR_FICCOU_7], [INP].[ZEDIPAR].[FICCOU_8] AS [INP_ZEDIPAR_FICCOU_8], [INP].[ZEDIPAR].[FICCOU_9] AS [INP_ZEDIPAR_FICCOU_9], [INP].[ZEDIPAR].[FICDES_0] AS [INP_ZEDIPAR_FICDES_0], [INP].[ZEDIPAR].[FICDES_1] AS [INP_ZEDIPAR_FICDES_1], [INP].[ZEDIPAR].[FICDES_2] AS [INP_ZEDIPAR_FICDES_2], [INP].[ZEDIPAR].[FICDES_3] AS [INP_ZEDIPAR_FICDES_3], [INP].[ZEDIPAR].[FICDES_4] AS [INP_ZEDIPAR_FICDES_4], [INP].[ZEDIPAR].[FICDES_5] AS [INP_ZEDIPAR_FICDES_5], [INP].[ZEDIPAR].[FICDES_6] AS [INP_ZEDIPAR_FICDES_6], [INP].[ZEDIPAR].[FICDES_7] AS [INP_ZEDIPAR_FICDES_7], [INP].[ZEDIPAR].[FICDES_8] AS [INP_ZEDIPAR_FICDES_8], [INP].[ZEDIPAR].[FICDES_9] AS [INP_ZEDIPAR_FICDES_9], [INP].[ZEDIPAR].[FICPRO_0] AS [INP_ZEDIPAR_FICPRO_0], [INP].[ZEDIPAR].[FICPRO_1] AS [INP_ZEDIPAR_FICPRO_1], [INP].[ZEDIPAR].[FICPRO_2] AS [INP_ZEDIPAR_FICPRO_2], [INP].[ZEDIPAR].[FICPRO_3] AS [INP_ZEDIPAR_FICPRO_3], [INP].[ZEDIPAR].[FICPRO_4] AS [INP_ZEDIPAR_FICPRO_4], [INP].[ZEDIPAR].[FICPRO_5] AS [INP_ZEDIPAR_FICPRO_5], [INP].[ZEDIPAR].[FICPRO_6] AS [INP_ZEDIPAR_FICPRO_6], [INP].[ZEDIPAR].[FICPRO_7] AS [INP_ZEDIPAR_FICPRO_7], [INP].[ZEDIPAR].[FICPRO_8] AS [INP_ZEDIPAR_FICPRO_8], [INP].[ZEDIPAR].[FICPRO_9] AS [INP_ZEDIPAR_FICPRO_9], [INP].[ZEDIPAR].[FICDIR_0] AS [INP_ZEDIPAR_FICDIR_0], [INP].[ZEDIPAR].[FICDIR_1] AS [INP_ZEDIPAR_FICDIR_1], [INP].[ZEDIPAR].[FICDIR_2] AS [INP_ZEDIPAR_FICDIR_2], [INP].[ZEDIPAR].[FICDIR_3] AS [INP_ZEDIPAR_FICDIR_3], [INP].[ZEDIPAR].[FICDIR_4] AS [INP_ZEDIPAR_FICDIR_4], [INP].[ZEDIPAR].[FICDIR_5] AS [INP_ZEDIPAR_FICDIR_5], [INP].[ZEDIPAR].[FICDIR_6] AS [INP_ZEDIPAR_FICDIR_6], [INP].[ZEDIPAR].[FICDIR_7] AS [INP_ZEDIPAR_FICDIR_7], [INP].[ZEDIPAR].[FICDIR_8] AS [INP_ZEDIPAR_FICDIR_8], [INP].[ZEDIPAR].[FICDIR_9] AS [INP_ZEDIPAR_FICDIR_9], [INP].[ZEDIPAR].[FICDAT_0] AS [INP_ZEDIPAR_FICDAT_0], [INP].[ZEDIPAR].[FICDAT_1] AS [INP_ZEDIPAR_FICDAT_1], [INP].[ZEDIPAR].[FICDAT_2] AS [INP_ZEDIPAR_FICDAT_2], [INP].[ZEDIPAR].[FICDAT_3] AS [INP_ZEDIPAR_FICDAT_3], [INP].[ZEDIPAR].[FICDAT_4] AS [INP_ZEDIPAR_FICDAT_4], [INP].[ZEDIPAR].[FICDAT_5] AS [INP_ZEDIPAR_FICDAT_5], [INP].[ZEDIPAR].[FICDAT_6] AS [INP_ZEDIPAR_FICDAT_6], [INP].[ZEDIPAR].[FICDAT_7] AS [INP_ZEDIPAR_FICDAT_7], [INP].[ZEDIPAR].[FICDAT_8] AS [INP_ZEDIPAR_FICDAT_8], [INP].[ZEDIPAR].[FICDAT_9] AS [INP_ZEDIPAR_FICDAT_9], [INP].[ZEDIPAR].[FICDEL_0] AS [INP_ZEDIPAR_FICDEL_0], [INP].[ZEDIPAR].[FICDEL_1] AS [INP_ZEDIPAR_FICDEL_1], [INP].[ZEDIPAR].[FICDEL_2] AS [INP_ZEDIPAR_FICDEL_2], [INP].[ZEDIPAR].[FICDEL_3] AS [INP_ZEDIPAR_FICDEL_3], [INP].[ZEDIPAR].[FICDEL_4] AS [INP_ZEDIPAR_FICDEL_4], [INP].[ZEDIPAR].[FICDEL_5] AS [INP_ZEDIPAR_FICDEL_5], [INP].[ZEDIPAR].[FICDEL_6] AS [INP_ZEDIPAR_FICDEL_6], [INP].[ZEDIPAR].[FICDEL_7] AS [INP_ZEDIPAR_FICDEL_7], [INP].[ZEDIPAR].[FICDEL_8] AS [INP_ZEDIPAR_FICDEL_8], [INP].[ZEDIPAR].[FICDEL_9] AS [INP_ZEDIPAR_FICDEL_9], [INP].[ZEDIPAR].[FICFOR_0] AS [INP_ZEDIPAR_FICFOR_0], [INP].[ZEDIPAR].[FICFOR_1] AS [INP_ZEDIPAR_FICFOR_1], [INP].[ZEDIPAR].[FICFOR_2] AS [INP_ZEDIPAR_FICFOR_2], [INP].[ZEDIPAR].[FICFOR_3] AS [INP_ZEDIPAR_FICFOR_3], [INP].[ZEDIPAR].[FICFOR_4] AS [INP_ZEDIPAR_FICFOR_4], [INP].[ZEDIPAR].[FICFOR_5] AS [INP_ZEDIPAR_FICFOR_5], [INP].[ZEDIPAR].[FICFOR_6] AS [INP_ZEDIPAR_FICFOR_6], [INP].[ZEDIPAR].[FICFOR_7] AS [INP_ZEDIPAR_FICFOR_7], [INP].[ZEDIPAR].[FICFOR_8] AS [INP_ZEDIPAR_FICFOR_8], [INP].[ZEDIPAR].[FICFOR_9] AS [INP_ZEDIPAR_FICFOR_9], [INP].[ZEDIPAR].[FICNUM_0] AS [INP_ZEDIPAR_FICNUM_0], [INP].[ZEDIPAR].[FICNUM_1] AS [INP_ZEDIPAR_FICNUM_1], [INP].[ZEDIPAR].[FICNUM_2] AS [INP_ZEDIPAR_FICNUM_2], [INP].[ZEDIPAR].[FICNUM_3] AS [INP_ZEDIPAR_FICNUM_3], [INP].[ZEDIPAR].[FICNUM_4] AS [INP_ZEDIPAR_FICNUM_4], [INP].[ZEDIPAR].[FICNUM_5] AS [INP_ZEDIPAR_FICNUM_5], [INP].[ZEDIPAR].[FICNUM_6] AS [INP_ZEDIPAR_FICNUM_6], [INP].[ZEDIPAR].[FICNUM_7] AS [INP_ZEDIPAR_FICNUM_7], [INP].[ZEDIPAR].[FICNUM_8] AS [INP_ZEDIPAR_FICNUM_8], [INP].[ZEDIPAR].[FICNUM_9] AS [INP_ZEDIPAR_FICNUM_9], [INP].[ZEDIPAR].[PEREDI_0] AS [INP_ZEDIPAR_PEREDI_0], [INP].[ZEDIPAR].[PEREDI_1] AS [INP_ZEDIPAR_PEREDI_1], [INP].[ZEDIPAR].[PEREDI_2] AS [INP_ZEDIPAR_PEREDI_2], [INP].[ZEDIPAR].[PEREDI_3] AS [INP_ZEDIPAR_PEREDI_3], [INP].[ZEDIPAR].[PEREDI_4] AS [INP_ZEDIPAR_PEREDI_4], [INP].[ZEDIPAR].[PEREDI_5] AS [INP_ZEDIPAR_PEREDI_5], [INP].[ZEDIPAR].[PEREDI_6] AS [INP_ZEDIPAR_PEREDI_6], [INP].[ZEDIPAR].[PEREDI_7] AS [INP_ZEDIPAR_PEREDI_7], [INP].[ZEDIPAR].[PEREDI_8] AS [INP_ZEDIPAR_PEREDI_8], [INP].[ZEDIPAR].[PEREDI_9] AS [INP_ZEDIPAR_PEREDI_9], [INP].[ZEDIPAR].[PERIODI_0] AS [INP_ZEDIPAR_PERIODI_0], [INP].[ZEDIPAR].[PERIODI_1] AS [INP_ZEDIPAR_PERIODI_1], [INP].[ZEDIPAR].[PERIODI_2] AS [INP_ZEDIPAR_PERIODI_2], [INP].[ZEDIPAR].[PERIODI_3] AS [INP_ZEDIPAR_PERIODI_3], [INP].[ZEDIPAR].[PERIODI_4] AS [INP_ZEDIPAR_PERIODI_4], [INP].[ZEDIPAR].[PERIODI_5] AS [INP_ZEDIPAR_PERIODI_5], [INP].[ZEDIPAR].[PERIODI_6] AS [INP_ZEDIPAR_PERIODI_6], [INP].[ZEDIPAR].[PERIODI_7] AS [INP_ZEDIPAR_PERIODI_7], [INP].[ZEDIPAR].[PERIODI_8] AS [INP_ZEDIPAR_PERIODI_8], [INP].[ZEDIPAR].[PERIODI_9] AS [INP_ZEDIPAR_PERIODI_9], [INP].[ZEDIPAR].[MDL_0] AS [INP_ZEDIPAR_MDL_0], [INP].[ZEDIPAR].[MDL_1] AS [INP_ZEDIPAR_MDL_1], [INP].[ZEDIPAR].[MDL_2] AS [INP_ZEDIPAR_MDL_2], [INP].[ZEDIPAR].[MDL_3] AS [INP_ZEDIPAR_MDL_3], [INP].[ZEDIPAR].[MDL_4] AS [INP_ZEDIPAR_MDL_4], [INP].[ZEDIPAR].[MDLTIM_0] AS [INP_ZEDIPAR_MDLTIM_0], [INP].[ZEDIPAR].[MDLTIM_1] AS [INP_ZEDIPAR_MDLTIM_1], [INP].[ZEDIPAR].[MDLTIM_2] AS [INP_ZEDIPAR_MDLTIM_2], [INP].[ZEDIPAR].[MDLTIM_3] AS [INP_ZEDIPAR_MDLTIM_3], [INP].[ZEDIPAR].[MDLTIM_4] AS [INP_ZEDIPAR_MDLTIM_4], [INP].[ZEDIPAR].[PUBGES_0] AS [INP_ZEDIPAR_PUBGES_0], [INP].[ZEDIPAR].[PUBANA_0] AS [INP_ZEDIPAR_PUBANA_0], [INP].[ZEDIPAR].[FLGBAS_0] AS [INP_ZEDIPAR_FLGBAS_0], [INP].[ZEDIPAR].[FLGQTY_0] AS [INP_ZEDIPAR_FLGQTY_0], [INP].[ZEDIPAR].[FLGNUM_0] AS [INP_ZEDIPAR_FLGNUM_0], [INP].[ZEDIPAR].[FLGXLS_0] AS [INP_ZEDIPAR_FLGXLS_0], [INP].[ZEDIPAR].[FLGPAC_0] AS [INP_ZEDIPAR_FLGPAC_0], [INP].[ZEDIPAR].[COLOR_0] AS [INP_ZEDIPAR_COLOR_0], [INP].[ZEDIPAR].[DSCBPS_0] AS [INP_ZEDIPAR_DSCBPS_0], [INP].[ZEDIPAR].[ROWID] AS [INP_ZEDIPAR_ROWID], [INP].[ZEDIPAR].[CREUSR_0] AS [INP_ZEDIPAR_CREUSR_0], [INP].[ZEDIPAR].[UPDUSR_0] AS [INP_ZEDIPAR_UPDUSR_0], [INP].[ZEDIPAR].[CREDATTIM_0] AS [INP_ZEDIPAR_CREDATTIM_0], [INP].[ZEDIPAR].[UPDDATTIM_0] AS [INP_ZEDIPAR_UPDDATTIM_0], [INP].[ZEDIPAR].[AUUID_0] AS [INP_ZEDIPAR_AUUID_0], [INP].[ZEDIPAR].[UPDTICK_0] AS [INP_ZEDIPAR_UPDTICK_0] 
FROM [INP].[ZEDIPAR] 
WHERE [INP].[ZEDIPAR].[ENAFLG_0] = %(ENAFLG_0_1)s AND [INP].[ZEDIPAR].[FTPFLG_0] = %(FTPFLG_0_1)s
2025-08-17 15:27:58,312 - INFO - sqlalchemy.engine.Engine - [generated in 0.00147s] {'ENAFLG_0_1': <Chapter1.YES: 2>, 'FTPFLG_0_1': <Chapter1.YES: 2>}
2025-08-17 15:28:06,985 - INFO - src.services.provider_service - Encontrados 1 fornecedores ativos.
2025-08-17 15:28:09,826 - INFO - sqlalchemy.engine.Engine - ROLLBACK
2025-08-17 15:28:13,695 - INFO - __main__ - Fornecedores carregados com sucesso:
2025-08-17 15:28:20,950 - INFO - src.services.transfer_service - A iniciar processamento para o fornecedor: 1526 com código de protocolo: '1'
2025-08-17 15:28:53,989 - INFO - src.services.strategies - Fornecedor '1526' usará a classe de estratégia: FranceMessagerieStrategy
2025-08-17 15:29:12,229 - CRITICAL - src.services.transfer_service - Ocorreu um erro crítico não tratado durante o processamento do fornecedor 1526.
Traceback (most recent call last):
  File "d:\Python\Sage\INP\transfer-files\src\services\transfer_service.py", line 55, in process_provider_transfer
    with ManagerClass(
         ^^^^^^^^^^^^^
TypeError: FtpManager.__init__() got an unexpected keyword argument 'binary_mode'
2025-08-17 15:36:57,191 - INFO - src.config.logging - Logging configurado. Root level: DEBUG. Handlers: console, info_file, error_file
2025-08-17 15:36:57,191 - INFO - __main__ - Iniciando o backend de transferência de ficheiros...
2025-08-17 15:36:57,192 - INFO - src.services.provider_service - A buscar configurações de fornecedores ativos via ORM...
2025-08-17 15:36:57,395 - INFO - sqlalchemy.engine.Engine - select @@version
2025-08-17 15:36:57,395 - INFO - sqlalchemy.engine.Engine - [raw sql] {}
2025-08-17 15:36:57,410 - INFO - sqlalchemy.engine.Engine - SELECT schema_name()
2025-08-17 15:36:57,410 - INFO - sqlalchemy.engine.Engine - [generated in 0.00054s] {}
2025-08-17 15:36:57,478 - INFO - sqlalchemy.engine.Engine - SELECT CAST('test max support' AS NVARCHAR(max))
2025-08-17 15:36:57,478 - INFO - sqlalchemy.engine.Engine - [generated in 0.00041s] {}
2025-08-17 15:36:57,501 - INFO - sqlalchemy.engine.Engine - SELECT 1 FROM fn_listextendedproperty(default, default, default, default, default, default, default)
2025-08-17 15:36:57,501 - INFO - sqlalchemy.engine.Engine - [generated in 0.00045s] {}
2025-08-17 15:36:57,548 - INFO - sqlalchemy.engine.Engine - BEGIN (implicit)
2025-08-17 15:36:57,558 - INFO - sqlalchemy.engine.Engine - SELECT [INP].[ZEDIPAR].[BPRNUM_0] AS [INP_ZEDIPAR_BPRNUM_0], [INP].[ZEDIPAR].[BPRNAM_0] AS [INP_ZEDIPAR_BPRNAM_0], [INP].[ZEDIPAR].[ENAFLG_0] AS [INP_ZEDIPAR_ENAFLG_0], [INP].[ZEDIPAR].[BPRID_0] AS [INP_ZEDIPAR_BPRID_0], [INP].[ZEDIPAR].[FTPFLG_0] AS [INP_ZEDIPAR_FTPFLG_0], [INP].[ZEDIPAR].[FTPTYP_0] AS [INP_ZEDIPAR_FTPTYP_0], [INP].[ZEDIPAR].[FTPURL_0] AS [INP_ZEDIPAR_FTPURL_0], [INP].[ZEDIPAR].[FTPUSR_0] AS [INP_ZEDIPAR_FTPUSR_0], [INP].[ZEDIPAR].[FTPPSW_0] AS [INP_ZEDIPAR_FTPPSW_0], [INP].[ZEDIPAR].[FTPMOD_0] AS [INP_ZEDIPAR_FTPMOD_0], [INP].[ZEDIPAR].[FTPINP_0] AS [INP_ZEDIPAR_FTPINP_0], [INP].[ZEDIPAR].[FTPOUT_0] AS [INP_ZEDIPAR_FTPOUT_0], [INP].[ZEDIPAR].[FTPFOR_0] AS [INP_ZEDIPAR_FTPFOR_0], [INP].[ZEDIPAR].[FTPTRT_0] AS [INP_ZEDIPAR_FTPTRT_0], [INP].[ZEDIPAR].[FTPFIC_0] AS [INP_ZEDIPAR_FTPFIC_0], [INP].[ZEDIPAR].[FTPEXP_0] AS [INP_ZEDIPAR_FTPEXP_0], [INP].[ZEDIPAR].[FTPUNI_0] AS [INP_ZEDIPAR_FTPUNI_0], [INP].[ZEDIPAR].[DRTINP_0] AS [INP_ZEDIPAR_DRTINP_0], [INP].[ZEDIPAR].[EXTINP_0] AS [INP_ZEDIPAR_EXTINP_0], [INP].[ZEDIPAR].[DRTOUT_0] AS [INP_ZEDIPAR_DRTOUT_0], [INP].[ZEDIPAR].[EXTOUT_0] AS [INP_ZEDIPAR_EXTOUT_0], [INP].[ZEDIPAR].[FICEXT_0] AS [INP_ZEDIPAR_FICEXT_0], [INP].[ZEDIPAR].[FICSEP_0] AS [INP_ZEDIPAR_FICSEP_0], [INP].[ZEDIPAR].[FICFLG_0] AS [INP_ZEDIPAR_FICFLG_0], [INP].[ZEDIPAR].[FICFLG_1] AS [INP_ZEDIPAR_FICFLG_1], [INP].[ZEDIPAR].[FICFLG_2] AS [INP_ZEDIPAR_FICFLG_2], [INP].[ZEDIPAR].[FICFLG_3] AS [INP_ZEDIPAR_FICFLG_3], [INP].[ZEDIPAR].[FICFLG_4] AS [INP_ZEDIPAR_FICFLG_4], [INP].[ZEDIPAR].[FICFLG_5] AS [INP_ZEDIPAR_FICFLG_5], [INP].[ZEDIPAR].[FICFLG_6] AS [INP_ZEDIPAR_FICFLG_6], [INP].[ZEDIPAR].[FICFLG_7] AS [INP_ZEDIPAR_FICFLG_7], [INP].[ZEDIPAR].[FICFLG_8] AS [INP_ZEDIPAR_FICFLG_8], [INP].[ZEDIPAR].[FICFLG_9] AS [INP_ZEDIPAR_FICFLG_9], [INP].[ZEDIPAR].[FICPRE_0] AS [INP_ZEDIPAR_FICPRE_0], [INP].[ZEDIPAR].[FICPRE_1] AS [INP_ZEDIPAR_FICPRE_1], [INP].[ZEDIPAR].[FICPRE_2] AS [INP_ZEDIPAR_FICPRE_2], [INP].[ZEDIPAR].[FICPRE_3] AS [INP_ZEDIPAR_FICPRE_3], [INP].[ZEDIPAR].[FICPRE_4] AS [INP_ZEDIPAR_FICPRE_4], [INP].[ZEDIPAR].[FICPRE_5] AS [INP_ZEDIPAR_FICPRE_5], [INP].[ZEDIPAR].[FICPRE_6] AS [INP_ZEDIPAR_FICPRE_6], [INP].[ZEDIPAR].[FICPRE_7] AS [INP_ZEDIPAR_FICPRE_7], [INP].[ZEDIPAR].[FICPRE_8] AS [INP_ZEDIPAR_FICPRE_8], [INP].[ZEDIPAR].[FICPRE_9] AS [INP_ZEDIPAR_FICPRE_9], [INP].[ZEDIPAR].[FICCOU_0] AS [INP_ZEDIPAR_FICCOU_0], [INP].[ZEDIPAR].[FICCOU_1] AS [INP_ZEDIPAR_FICCOU_1], [INP].[ZEDIPAR].[FICCOU_2] AS [INP_ZEDIPAR_FICCOU_2], [INP].[ZEDIPAR].[FICCOU_3] AS [INP_ZEDIPAR_FICCOU_3], [INP].[ZEDIPAR].[FICCOU_4] AS [INP_ZEDIPAR_FICCOU_4], [INP].[ZEDIPAR].[FICCOU_5] AS [INP_ZEDIPAR_FICCOU_5], [INP].[ZEDIPAR].[FICCOU_6] AS [INP_ZEDIPAR_FICCOU_6], [INP].[ZEDIPAR].[FICCOU_7] AS [INP_ZEDIPAR_FICCOU_7], [INP].[ZEDIPAR].[FICCOU_8] AS [INP_ZEDIPAR_FICCOU_8], [INP].[ZEDIPAR].[FICCOU_9] AS [INP_ZEDIPAR_FICCOU_9], [INP].[ZEDIPAR].[FICDES_0] AS [INP_ZEDIPAR_FICDES_0], [INP].[ZEDIPAR].[FICDES_1] AS [INP_ZEDIPAR_FICDES_1], [INP].[ZEDIPAR].[FICDES_2] AS [INP_ZEDIPAR_FICDES_2], [INP].[ZEDIPAR].[FICDES_3] AS [INP_ZEDIPAR_FICDES_3], [INP].[ZEDIPAR].[FICDES_4] AS [INP_ZEDIPAR_FICDES_4], [INP].[ZEDIPAR].[FICDES_5] AS [INP_ZEDIPAR_FICDES_5], [INP].[ZEDIPAR].[FICDES_6] AS [INP_ZEDIPAR_FICDES_6], [INP].[ZEDIPAR].[FICDES_7] AS [INP_ZEDIPAR_FICDES_7], [INP].[ZEDIPAR].[FICDES_8] AS [INP_ZEDIPAR_FICDES_8], [INP].[ZEDIPAR].[FICDES_9] AS [INP_ZEDIPAR_FICDES_9], [INP].[ZEDIPAR].[FICPRO_0] AS [INP_ZEDIPAR_FICPRO_0], [INP].[ZEDIPAR].[FICPRO_1] AS [INP_ZEDIPAR_FICPRO_1], [INP].[ZEDIPAR].[FICPRO_2] AS [INP_ZEDIPAR_FICPRO_2], [INP].[ZEDIPAR].[FICPRO_3] AS [INP_ZEDIPAR_FICPRO_3], [INP].[ZEDIPAR].[FICPRO_4] AS [INP_ZEDIPAR_FICPRO_4], [INP].[ZEDIPAR].[FICPRO_5] AS [INP_ZEDIPAR_FICPRO_5], [INP].[ZEDIPAR].[FICPRO_6] AS [INP_ZEDIPAR_FICPRO_6], [INP].[ZEDIPAR].[FICPRO_7] AS [INP_ZEDIPAR_FICPRO_7], [INP].[ZEDIPAR].[FICPRO_8] AS [INP_ZEDIPAR_FICPRO_8], [INP].[ZEDIPAR].[FICPRO_9] AS [INP_ZEDIPAR_FICPRO_9], [INP].[ZEDIPAR].[FICDIR_0] AS [INP_ZEDIPAR_FICDIR_0], [INP].[ZEDIPAR].[FICDIR_1] AS [INP_ZEDIPAR_FICDIR_1], [INP].[ZEDIPAR].[FICDIR_2] AS [INP_ZEDIPAR_FICDIR_2], [INP].[ZEDIPAR].[FICDIR_3] AS [INP_ZEDIPAR_FICDIR_3], [INP].[ZEDIPAR].[FICDIR_4] AS [INP_ZEDIPAR_FICDIR_4], [INP].[ZEDIPAR].[FICDIR_5] AS [INP_ZEDIPAR_FICDIR_5], [INP].[ZEDIPAR].[FICDIR_6] AS [INP_ZEDIPAR_FICDIR_6], [INP].[ZEDIPAR].[FICDIR_7] AS [INP_ZEDIPAR_FICDIR_7], [INP].[ZEDIPAR].[FICDIR_8] AS [INP_ZEDIPAR_FICDIR_8], [INP].[ZEDIPAR].[FICDIR_9] AS [INP_ZEDIPAR_FICDIR_9], [INP].[ZEDIPAR].[FICDAT_0] AS [INP_ZEDIPAR_FICDAT_0], [INP].[ZEDIPAR].[FICDAT_1] AS [INP_ZEDIPAR_FICDAT_1], [INP].[ZEDIPAR].[FICDAT_2] AS [INP_ZEDIPAR_FICDAT_2], [INP].[ZEDIPAR].[FICDAT_3] AS [INP_ZEDIPAR_FICDAT_3], [INP].[ZEDIPAR].[FICDAT_4] AS [INP_ZEDIPAR_FICDAT_4], [INP].[ZEDIPAR].[FICDAT_5] AS [INP_ZEDIPAR_FICDAT_5], [INP].[ZEDIPAR].[FICDAT_6] AS [INP_ZEDIPAR_FICDAT_6], [INP].[ZEDIPAR].[FICDAT_7] AS [INP_ZEDIPAR_FICDAT_7], [INP].[ZEDIPAR].[FICDAT_8] AS [INP_ZEDIPAR_FICDAT_8], [INP].[ZEDIPAR].[FICDAT_9] AS [INP_ZEDIPAR_FICDAT_9], [INP].[ZEDIPAR].[FICDEL_0] AS [INP_ZEDIPAR_FICDEL_0], [INP].[ZEDIPAR].[FICDEL_1] AS [INP_ZEDIPAR_FICDEL_1], [INP].[ZEDIPAR].[FICDEL_2] AS [INP_ZEDIPAR_FICDEL_2], [INP].[ZEDIPAR].[FICDEL_3] AS [INP_ZEDIPAR_FICDEL_3], [INP].[ZEDIPAR].[FICDEL_4] AS [INP_ZEDIPAR_FICDEL_4], [INP].[ZEDIPAR].[FICDEL_5] AS [INP_ZEDIPAR_FICDEL_5], [INP].[ZEDIPAR].[FICDEL_6] AS [INP_ZEDIPAR_FICDEL_6], [INP].[ZEDIPAR].[FICDEL_7] AS [INP_ZEDIPAR_FICDEL_7], [INP].[ZEDIPAR].[FICDEL_8] AS [INP_ZEDIPAR_FICDEL_8], [INP].[ZEDIPAR].[FICDEL_9] AS [INP_ZEDIPAR_FICDEL_9], [INP].[ZEDIPAR].[FICFOR_0] AS [INP_ZEDIPAR_FICFOR_0], [INP].[ZEDIPAR].[FICFOR_1] AS [INP_ZEDIPAR_FICFOR_1], [INP].[ZEDIPAR].[FICFOR_2] AS [INP_ZEDIPAR_FICFOR_2], [INP].[ZEDIPAR].[FICFOR_3] AS [INP_ZEDIPAR_FICFOR_3], [INP].[ZEDIPAR].[FICFOR_4] AS [INP_ZEDIPAR_FICFOR_4], [INP].[ZEDIPAR].[FICFOR_5] AS [INP_ZEDIPAR_FICFOR_5], [INP].[ZEDIPAR].[FICFOR_6] AS [INP_ZEDIPAR_FICFOR_6], [INP].[ZEDIPAR].[FICFOR_7] AS [INP_ZEDIPAR_FICFOR_7], [INP].[ZEDIPAR].[FICFOR_8] AS [INP_ZEDIPAR_FICFOR_8], [INP].[ZEDIPAR].[FICFOR_9] AS [INP_ZEDIPAR_FICFOR_9], [INP].[ZEDIPAR].[FICNUM_0] AS [INP_ZEDIPAR_FICNUM_0], [INP].[ZEDIPAR].[FICNUM_1] AS [INP_ZEDIPAR_FICNUM_1], [INP].[ZEDIPAR].[FICNUM_2] AS [INP_ZEDIPAR_FICNUM_2], [INP].[ZEDIPAR].[FICNUM_3] AS [INP_ZEDIPAR_FICNUM_3], [INP].[ZEDIPAR].[FICNUM_4] AS [INP_ZEDIPAR_FICNUM_4], [INP].[ZEDIPAR].[FICNUM_5] AS [INP_ZEDIPAR_FICNUM_5], [INP].[ZEDIPAR].[FICNUM_6] AS [INP_ZEDIPAR_FICNUM_6], [INP].[ZEDIPAR].[FICNUM_7] AS [INP_ZEDIPAR_FICNUM_7], [INP].[ZEDIPAR].[FICNUM_8] AS [INP_ZEDIPAR_FICNUM_8], [INP].[ZEDIPAR].[FICNUM_9] AS [INP_ZEDIPAR_FICNUM_9], [INP].[ZEDIPAR].[PEREDI_0] AS [INP_ZEDIPAR_PEREDI_0], [INP].[ZEDIPAR].[PEREDI_1] AS [INP_ZEDIPAR_PEREDI_1], [INP].[ZEDIPAR].[PEREDI_2] AS [INP_ZEDIPAR_PEREDI_2], [INP].[ZEDIPAR].[PEREDI_3] AS [INP_ZEDIPAR_PEREDI_3], [INP].[ZEDIPAR].[PEREDI_4] AS [INP_ZEDIPAR_PEREDI_4], [INP].[ZEDIPAR].[PEREDI_5] AS [INP_ZEDIPAR_PEREDI_5], [INP].[ZEDIPAR].[PEREDI_6] AS [INP_ZEDIPAR_PEREDI_6], [INP].[ZEDIPAR].[PEREDI_7] AS [INP_ZEDIPAR_PEREDI_7], [INP].[ZEDIPAR].[PEREDI_8] AS [INP_ZEDIPAR_PEREDI_8], [INP].[ZEDIPAR].[PEREDI_9] AS [INP_ZEDIPAR_PEREDI_9], [INP].[ZEDIPAR].[PERIODI_0] AS [INP_ZEDIPAR_PERIODI_0], [INP].[ZEDIPAR].[PERIODI_1] AS [INP_ZEDIPAR_PERIODI_1], [INP].[ZEDIPAR].[PERIODI_2] AS [INP_ZEDIPAR_PERIODI_2], [INP].[ZEDIPAR].[PERIODI_3] AS [INP_ZEDIPAR_PERIODI_3], [INP].[ZEDIPAR].[PERIODI_4] AS [INP_ZEDIPAR_PERIODI_4], [INP].[ZEDIPAR].[PERIODI_5] AS [INP_ZEDIPAR_PERIODI_5], [INP].[ZEDIPAR].[PERIODI_6] AS [INP_ZEDIPAR_PERIODI_6], [INP].[ZEDIPAR].[PERIODI_7] AS [INP_ZEDIPAR_PERIODI_7], [INP].[ZEDIPAR].[PERIODI_8] AS [INP_ZEDIPAR_PERIODI_8], [INP].[ZEDIPAR].[PERIODI_9] AS [INP_ZEDIPAR_PERIODI_9], [INP].[ZEDIPAR].[MDL_0] AS [INP_ZEDIPAR_MDL_0], [INP].[ZEDIPAR].[MDL_1] AS [INP_ZEDIPAR_MDL_1], [INP].[ZEDIPAR].[MDL_2] AS [INP_ZEDIPAR_MDL_2], [INP].[ZEDIPAR].[MDL_3] AS [INP_ZEDIPAR_MDL_3], [INP].[ZEDIPAR].[MDL_4] AS [INP_ZEDIPAR_MDL_4], [INP].[ZEDIPAR].[MDLTIM_0] AS [INP_ZEDIPAR_MDLTIM_0], [INP].[ZEDIPAR].[MDLTIM_1] AS [INP_ZEDIPAR_MDLTIM_1], [INP].[ZEDIPAR].[MDLTIM_2] AS [INP_ZEDIPAR_MDLTIM_2], [INP].[ZEDIPAR].[MDLTIM_3] AS [INP_ZEDIPAR_MDLTIM_3], [INP].[ZEDIPAR].[MDLTIM_4] AS [INP_ZEDIPAR_MDLTIM_4], [INP].[ZEDIPAR].[PUBGES_0] AS [INP_ZEDIPAR_PUBGES_0], [INP].[ZEDIPAR].[PUBANA_0] AS [INP_ZEDIPAR_PUBANA_0], [INP].[ZEDIPAR].[FLGBAS_0] AS [INP_ZEDIPAR_FLGBAS_0], [INP].[ZEDIPAR].[FLGQTY_0] AS [INP_ZEDIPAR_FLGQTY_0], [INP].[ZEDIPAR].[FLGNUM_0] AS [INP_ZEDIPAR_FLGNUM_0], [INP].[ZEDIPAR].[FLGXLS_0] AS [INP_ZEDIPAR_FLGXLS_0], [INP].[ZEDIPAR].[FLGPAC_0] AS [INP_ZEDIPAR_FLGPAC_0], [INP].[ZEDIPAR].[COLOR_0] AS [INP_ZEDIPAR_COLOR_0], [INP].[ZEDIPAR].[DSCBPS_0] AS [INP_ZEDIPAR_DSCBPS_0], [INP].[ZEDIPAR].[ROWID] AS [INP_ZEDIPAR_ROWID], [INP].[ZEDIPAR].[CREUSR_0] AS [INP_ZEDIPAR_CREUSR_0], [INP].[ZEDIPAR].[UPDUSR_0] AS [INP_ZEDIPAR_UPDUSR_0], [INP].[ZEDIPAR].[CREDATTIM_0] AS [INP_ZEDIPAR_CREDATTIM_0], [INP].[ZEDIPAR].[UPDDATTIM_0] AS [INP_ZEDIPAR_UPDDATTIM_0], [INP].[ZEDIPAR].[AUUID_0] AS [INP_ZEDIPAR_AUUID_0], [INP].[ZEDIPAR].[UPDTICK_0] AS [INP_ZEDIPAR_UPDTICK_0] 
FROM [INP].[ZEDIPAR] 
WHERE [INP].[ZEDIPAR].[ENAFLG_0] = %(ENAFLG_0_1)s AND [INP].[ZEDIPAR].[FTPFLG_0] = %(FTPFLG_0_1)s
2025-08-17 15:36:57,562 - INFO - sqlalchemy.engine.Engine - [generated in 0.00161s] {'ENAFLG_0_1': <Chapter1.YES: 2>, 'FTPFLG_0_1': <Chapter1.YES: 2>}
2025-08-17 15:36:57,588 - INFO - src.services.provider_service - Encontrados 1 fornecedores ativos.
2025-08-17 15:36:57,588 - INFO - sqlalchemy.engine.Engine - ROLLBACK
2025-08-17 15:36:57,637 - INFO - __main__ - Fornecedores carregados com sucesso:
2025-08-17 15:37:04,975 - INFO - src.services.transfer_service - A iniciar processamento para o fornecedor: 1526 com código de protocolo: '1'
2025-08-17 15:37:15,257 - INFO - src.services.strategies - Fornecedor '1526' usará a classe de estratégia: FranceMessagerieStrategy
2025-08-17 15:37:39,799 - INFO - src.transfer.ftp_manager - A conectar ao servidor FTP em ftpexport.presstalis.fr:21...
2025-08-17 15:37:39,998 - INFO - src.transfer.ftp_manager - Conexão FTP com 'ftpexport.presstalis.fr' estabelecida com sucesso.
2025-08-17 15:38:00,961 - INFO - src.services.strategies - [1526] A executar a estratégia de transferência padrão.
2025-08-17 15:39:35,018 - INFO - src.transfer.ftp_manager - Listar ficheiros em '/'...
2025-08-17 15:40:34,194 - INFO - src.services.strategies - [1526] Filtro aplicado. Encontrados 1 ficheiros para download com o padrão F4010010.*.
2025-08-17 15:41:39,580 - INFO - src.services.strategies - [1526] A receber ficheiro: // -> [EDI]\IMPORT\1526
2025-08-17 15:46:02,992 - INFO - src.config.logging - Logging configurado. Root level: DEBUG. Handlers: console, info_file, error_file
2025-08-17 15:46:02,993 - INFO - __main__ - Iniciando o backend de transferência de ficheiros...
2025-08-17 15:46:02,993 - INFO - src.services.provider_service - A buscar configurações de fornecedores ativos via ORM...
2025-08-17 15:46:03,189 - INFO - sqlalchemy.engine.Engine - select @@version
2025-08-17 15:46:03,189 - INFO - sqlalchemy.engine.Engine - [raw sql] {}
2025-08-17 15:46:03,206 - INFO - sqlalchemy.engine.Engine - SELECT schema_name()
2025-08-17 15:46:03,206 - INFO - sqlalchemy.engine.Engine - [generated in 0.00076s] {}
2025-08-17 15:46:03,276 - INFO - sqlalchemy.engine.Engine - SELECT CAST('test max support' AS NVARCHAR(max))
2025-08-17 15:46:03,276 - INFO - sqlalchemy.engine.Engine - [generated in 0.00038s] {}
2025-08-17 15:46:03,294 - INFO - sqlalchemy.engine.Engine - SELECT 1 FROM fn_listextendedproperty(default, default, default, default, default, default, default)
2025-08-17 15:46:03,303 - INFO - sqlalchemy.engine.Engine - [generated in 0.00067s] {}
2025-08-17 15:46:03,349 - INFO - sqlalchemy.engine.Engine - BEGIN (implicit)
2025-08-17 15:46:03,364 - INFO - sqlalchemy.engine.Engine - SELECT [INP].[ZEDIPAR].[BPRNUM_0] AS [INP_ZEDIPAR_BPRNUM_0], [INP].[ZEDIPAR].[BPRNAM_0] AS [INP_ZEDIPAR_BPRNAM_0], [INP].[ZEDIPAR].[ENAFLG_0] AS [INP_ZEDIPAR_ENAFLG_0], [INP].[ZEDIPAR].[BPRID_0] AS [INP_ZEDIPAR_BPRID_0], [INP].[ZEDIPAR].[FTPFLG_0] AS [INP_ZEDIPAR_FTPFLG_0], [INP].[ZEDIPAR].[FTPTYP_0] AS [INP_ZEDIPAR_FTPTYP_0], [INP].[ZEDIPAR].[FTPURL_0] AS [INP_ZEDIPAR_FTPURL_0], [INP].[ZEDIPAR].[FTPUSR_0] AS [INP_ZEDIPAR_FTPUSR_0], [INP].[ZEDIPAR].[FTPPSW_0] AS [INP_ZEDIPAR_FTPPSW_0], [INP].[ZEDIPAR].[FTPMOD_0] AS [INP_ZEDIPAR_FTPMOD_0], [INP].[ZEDIPAR].[FTPINP_0] AS [INP_ZEDIPAR_FTPINP_0], [INP].[ZEDIPAR].[FTPOUT_0] AS [INP_ZEDIPAR_FTPOUT_0], [INP].[ZEDIPAR].[FTPFOR_0] AS [INP_ZEDIPAR_FTPFOR_0], [INP].[ZEDIPAR].[FTPTRT_0] AS [INP_ZEDIPAR_FTPTRT_0], [INP].[ZEDIPAR].[FTPFIC_0] AS [INP_ZEDIPAR_FTPFIC_0], [INP].[ZEDIPAR].[FTPEXP_0] AS [INP_ZEDIPAR_FTPEXP_0], [INP].[ZEDIPAR].[FTPUNI_0] AS [INP_ZEDIPAR_FTPUNI_0], [INP].[ZEDIPAR].[DRTINP_0] AS [INP_ZEDIPAR_DRTINP_0], [INP].[ZEDIPAR].[EXTINP_0] AS [INP_ZEDIPAR_EXTINP_0], [INP].[ZEDIPAR].[DRTOUT_0] AS [INP_ZEDIPAR_DRTOUT_0], [INP].[ZEDIPAR].[EXTOUT_0] AS [INP_ZEDIPAR_EXTOUT_0], [INP].[ZEDIPAR].[FICEXT_0] AS [INP_ZEDIPAR_FICEXT_0], [INP].[ZEDIPAR].[FICSEP_0] AS [INP_ZEDIPAR_FICSEP_0], [INP].[ZEDIPAR].[FICFLG_0] AS [INP_ZEDIPAR_FICFLG_0], [INP].[ZEDIPAR].[FICFLG_1] AS [INP_ZEDIPAR_FICFLG_1], [INP].[ZEDIPAR].[FICFLG_2] AS [INP_ZEDIPAR_FICFLG_2], [INP].[ZEDIPAR].[FICFLG_3] AS [INP_ZEDIPAR_FICFLG_3], [INP].[ZEDIPAR].[FICFLG_4] AS [INP_ZEDIPAR_FICFLG_4], [INP].[ZEDIPAR].[FICFLG_5] AS [INP_ZEDIPAR_FICFLG_5], [INP].[ZEDIPAR].[FICFLG_6] AS [INP_ZEDIPAR_FICFLG_6], [INP].[ZEDIPAR].[FICFLG_7] AS [INP_ZEDIPAR_FICFLG_7], [INP].[ZEDIPAR].[FICFLG_8] AS [INP_ZEDIPAR_FICFLG_8], [INP].[ZEDIPAR].[FICFLG_9] AS [INP_ZEDIPAR_FICFLG_9], [INP].[ZEDIPAR].[FICPRE_0] AS [INP_ZEDIPAR_FICPRE_0], [INP].[ZEDIPAR].[FICPRE_1] AS [INP_ZEDIPAR_FICPRE_1], [INP].[ZEDIPAR].[FICPRE_2] AS [INP_ZEDIPAR_FICPRE_2], [INP].[ZEDIPAR].[FICPRE_3] AS [INP_ZEDIPAR_FICPRE_3], [INP].[ZEDIPAR].[FICPRE_4] AS [INP_ZEDIPAR_FICPRE_4], [INP].[ZEDIPAR].[FICPRE_5] AS [INP_ZEDIPAR_FICPRE_5], [INP].[ZEDIPAR].[FICPRE_6] AS [INP_ZEDIPAR_FICPRE_6], [INP].[ZEDIPAR].[FICPRE_7] AS [INP_ZEDIPAR_FICPRE_7], [INP].[ZEDIPAR].[FICPRE_8] AS [INP_ZEDIPAR_FICPRE_8], [INP].[ZEDIPAR].[FICPRE_9] AS [INP_ZEDIPAR_FICPRE_9], [INP].[ZEDIPAR].[FICCOU_0] AS [INP_ZEDIPAR_FICCOU_0], [INP].[ZEDIPAR].[FICCOU_1] AS [INP_ZEDIPAR_FICCOU_1], [INP].[ZEDIPAR].[FICCOU_2] AS [INP_ZEDIPAR_FICCOU_2], [INP].[ZEDIPAR].[FICCOU_3] AS [INP_ZEDIPAR_FICCOU_3], [INP].[ZEDIPAR].[FICCOU_4] AS [INP_ZEDIPAR_FICCOU_4], [INP].[ZEDIPAR].[FICCOU_5] AS [INP_ZEDIPAR_FICCOU_5], [INP].[ZEDIPAR].[FICCOU_6] AS [INP_ZEDIPAR_FICCOU_6], [INP].[ZEDIPAR].[FICCOU_7] AS [INP_ZEDIPAR_FICCOU_7], [INP].[ZEDIPAR].[FICCOU_8] AS [INP_ZEDIPAR_FICCOU_8], [INP].[ZEDIPAR].[FICCOU_9] AS [INP_ZEDIPAR_FICCOU_9], [INP].[ZEDIPAR].[FICDES_0] AS [INP_ZEDIPAR_FICDES_0], [INP].[ZEDIPAR].[FICDES_1] AS [INP_ZEDIPAR_FICDES_1], [INP].[ZEDIPAR].[FICDES_2] AS [INP_ZEDIPAR_FICDES_2], [INP].[ZEDIPAR].[FICDES_3] AS [INP_ZEDIPAR_FICDES_3], [INP].[ZEDIPAR].[FICDES_4] AS [INP_ZEDIPAR_FICDES_4], [INP].[ZEDIPAR].[FICDES_5] AS [INP_ZEDIPAR_FICDES_5], [INP].[ZEDIPAR].[FICDES_6] AS [INP_ZEDIPAR_FICDES_6], [INP].[ZEDIPAR].[FICDES_7] AS [INP_ZEDIPAR_FICDES_7], [INP].[ZEDIPAR].[FICDES_8] AS [INP_ZEDIPAR_FICDES_8], [INP].[ZEDIPAR].[FICDES_9] AS [INP_ZEDIPAR_FICDES_9], [INP].[ZEDIPAR].[FICPRO_0] AS [INP_ZEDIPAR_FICPRO_0], [INP].[ZEDIPAR].[FICPRO_1] AS [INP_ZEDIPAR_FICPRO_1], [INP].[ZEDIPAR].[FICPRO_2] AS [INP_ZEDIPAR_FICPRO_2], [INP].[ZEDIPAR].[FICPRO_3] AS [INP_ZEDIPAR_FICPRO_3], [INP].[ZEDIPAR].[FICPRO_4] AS [INP_ZEDIPAR_FICPRO_4], [INP].[ZEDIPAR].[FICPRO_5] AS [INP_ZEDIPAR_FICPRO_5], [INP].[ZEDIPAR].[FICPRO_6] AS [INP_ZEDIPAR_FICPRO_6], [INP].[ZEDIPAR].[FICPRO_7] AS [INP_ZEDIPAR_FICPRO_7], [INP].[ZEDIPAR].[FICPRO_8] AS [INP_ZEDIPAR_FICPRO_8], [INP].[ZEDIPAR].[FICPRO_9] AS [INP_ZEDIPAR_FICPRO_9], [INP].[ZEDIPAR].[FICDIR_0] AS [INP_ZEDIPAR_FICDIR_0], [INP].[ZEDIPAR].[FICDIR_1] AS [INP_ZEDIPAR_FICDIR_1], [INP].[ZEDIPAR].[FICDIR_2] AS [INP_ZEDIPAR_FICDIR_2], [INP].[ZEDIPAR].[FICDIR_3] AS [INP_ZEDIPAR_FICDIR_3], [INP].[ZEDIPAR].[FICDIR_4] AS [INP_ZEDIPAR_FICDIR_4], [INP].[ZEDIPAR].[FICDIR_5] AS [INP_ZEDIPAR_FICDIR_5], [INP].[ZEDIPAR].[FICDIR_6] AS [INP_ZEDIPAR_FICDIR_6], [INP].[ZEDIPAR].[FICDIR_7] AS [INP_ZEDIPAR_FICDIR_7], [INP].[ZEDIPAR].[FICDIR_8] AS [INP_ZEDIPAR_FICDIR_8], [INP].[ZEDIPAR].[FICDIR_9] AS [INP_ZEDIPAR_FICDIR_9], [INP].[ZEDIPAR].[FICDAT_0] AS [INP_ZEDIPAR_FICDAT_0], [INP].[ZEDIPAR].[FICDAT_1] AS [INP_ZEDIPAR_FICDAT_1], [INP].[ZEDIPAR].[FICDAT_2] AS [INP_ZEDIPAR_FICDAT_2], [INP].[ZEDIPAR].[FICDAT_3] AS [INP_ZEDIPAR_FICDAT_3], [INP].[ZEDIPAR].[FICDAT_4] AS [INP_ZEDIPAR_FICDAT_4], [INP].[ZEDIPAR].[FICDAT_5] AS [INP_ZEDIPAR_FICDAT_5], [INP].[ZEDIPAR].[FICDAT_6] AS [INP_ZEDIPAR_FICDAT_6], [INP].[ZEDIPAR].[FICDAT_7] AS [INP_ZEDIPAR_FICDAT_7], [INP].[ZEDIPAR].[FICDAT_8] AS [INP_ZEDIPAR_FICDAT_8], [INP].[ZEDIPAR].[FICDAT_9] AS [INP_ZEDIPAR_FICDAT_9], [INP].[ZEDIPAR].[FICDEL_0] AS [INP_ZEDIPAR_FICDEL_0], [INP].[ZEDIPAR].[FICDEL_1] AS [INP_ZEDIPAR_FICDEL_1], [INP].[ZEDIPAR].[FICDEL_2] AS [INP_ZEDIPAR_FICDEL_2], [INP].[ZEDIPAR].[FICDEL_3] AS [INP_ZEDIPAR_FICDEL_3], [INP].[ZEDIPAR].[FICDEL_4] AS [INP_ZEDIPAR_FICDEL_4], [INP].[ZEDIPAR].[FICDEL_5] AS [INP_ZEDIPAR_FICDEL_5], [INP].[ZEDIPAR].[FICDEL_6] AS [INP_ZEDIPAR_FICDEL_6], [INP].[ZEDIPAR].[FICDEL_7] AS [INP_ZEDIPAR_FICDEL_7], [INP].[ZEDIPAR].[FICDEL_8] AS [INP_ZEDIPAR_FICDEL_8], [INP].[ZEDIPAR].[FICDEL_9] AS [INP_ZEDIPAR_FICDEL_9], [INP].[ZEDIPAR].[FICFOR_0] AS [INP_ZEDIPAR_FICFOR_0], [INP].[ZEDIPAR].[FICFOR_1] AS [INP_ZEDIPAR_FICFOR_1], [INP].[ZEDIPAR].[FICFOR_2] AS [INP_ZEDIPAR_FICFOR_2], [INP].[ZEDIPAR].[FICFOR_3] AS [INP_ZEDIPAR_FICFOR_3], [INP].[ZEDIPAR].[FICFOR_4] AS [INP_ZEDIPAR_FICFOR_4], [INP].[ZEDIPAR].[FICFOR_5] AS [INP_ZEDIPAR_FICFOR_5], [INP].[ZEDIPAR].[FICFOR_6] AS [INP_ZEDIPAR_FICFOR_6], [INP].[ZEDIPAR].[FICFOR_7] AS [INP_ZEDIPAR_FICFOR_7], [INP].[ZEDIPAR].[FICFOR_8] AS [INP_ZEDIPAR_FICFOR_8], [INP].[ZEDIPAR].[FICFOR_9] AS [INP_ZEDIPAR_FICFOR_9], [INP].[ZEDIPAR].[FICNUM_0] AS [INP_ZEDIPAR_FICNUM_0], [INP].[ZEDIPAR].[FICNUM_1] AS [INP_ZEDIPAR_FICNUM_1], [INP].[ZEDIPAR].[FICNUM_2] AS [INP_ZEDIPAR_FICNUM_2], [INP].[ZEDIPAR].[FICNUM_3] AS [INP_ZEDIPAR_FICNUM_3], [INP].[ZEDIPAR].[FICNUM_4] AS [INP_ZEDIPAR_FICNUM_4], [INP].[ZEDIPAR].[FICNUM_5] AS [INP_ZEDIPAR_FICNUM_5], [INP].[ZEDIPAR].[FICNUM_6] AS [INP_ZEDIPAR_FICNUM_6], [INP].[ZEDIPAR].[FICNUM_7] AS [INP_ZEDIPAR_FICNUM_7], [INP].[ZEDIPAR].[FICNUM_8] AS [INP_ZEDIPAR_FICNUM_8], [INP].[ZEDIPAR].[FICNUM_9] AS [INP_ZEDIPAR_FICNUM_9], [INP].[ZEDIPAR].[PEREDI_0] AS [INP_ZEDIPAR_PEREDI_0], [INP].[ZEDIPAR].[PEREDI_1] AS [INP_ZEDIPAR_PEREDI_1], [INP].[ZEDIPAR].[PEREDI_2] AS [INP_ZEDIPAR_PEREDI_2], [INP].[ZEDIPAR].[PEREDI_3] AS [INP_ZEDIPAR_PEREDI_3], [INP].[ZEDIPAR].[PEREDI_4] AS [INP_ZEDIPAR_PEREDI_4], [INP].[ZEDIPAR].[PEREDI_5] AS [INP_ZEDIPAR_PEREDI_5], [INP].[ZEDIPAR].[PEREDI_6] AS [INP_ZEDIPAR_PEREDI_6], [INP].[ZEDIPAR].[PEREDI_7] AS [INP_ZEDIPAR_PEREDI_7], [INP].[ZEDIPAR].[PEREDI_8] AS [INP_ZEDIPAR_PEREDI_8], [INP].[ZEDIPAR].[PEREDI_9] AS [INP_ZEDIPAR_PEREDI_9], [INP].[ZEDIPAR].[PERIODI_0] AS [INP_ZEDIPAR_PERIODI_0], [INP].[ZEDIPAR].[PERIODI_1] AS [INP_ZEDIPAR_PERIODI_1], [INP].[ZEDIPAR].[PERIODI_2] AS [INP_ZEDIPAR_PERIODI_2], [INP].[ZEDIPAR].[PERIODI_3] AS [INP_ZEDIPAR_PERIODI_3], [INP].[ZEDIPAR].[PERIODI_4] AS [INP_ZEDIPAR_PERIODI_4], [INP].[ZEDIPAR].[PERIODI_5] AS [INP_ZEDIPAR_PERIODI_5], [INP].[ZEDIPAR].[PERIODI_6] AS [INP_ZEDIPAR_PERIODI_6], [INP].[ZEDIPAR].[PERIODI_7] AS [INP_ZEDIPAR_PERIODI_7], [INP].[ZEDIPAR].[PERIODI_8] AS [INP_ZEDIPAR_PERIODI_8], [INP].[ZEDIPAR].[PERIODI_9] AS [INP_ZEDIPAR_PERIODI_9], [INP].[ZEDIPAR].[MDL_0] AS [INP_ZEDIPAR_MDL_0], [INP].[ZEDIPAR].[MDL_1] AS [INP_ZEDIPAR_MDL_1], [INP].[ZEDIPAR].[MDL_2] AS [INP_ZEDIPAR_MDL_2], [INP].[ZEDIPAR].[MDL_3] AS [INP_ZEDIPAR_MDL_3], [INP].[ZEDIPAR].[MDL_4] AS [INP_ZEDIPAR_MDL_4], [INP].[ZEDIPAR].[MDLTIM_0] AS [INP_ZEDIPAR_MDLTIM_0], [INP].[ZEDIPAR].[MDLTIM_1] AS [INP_ZEDIPAR_MDLTIM_1], [INP].[ZEDIPAR].[MDLTIM_2] AS [INP_ZEDIPAR_MDLTIM_2], [INP].[ZEDIPAR].[MDLTIM_3] AS [INP_ZEDIPAR_MDLTIM_3], [INP].[ZEDIPAR].[MDLTIM_4] AS [INP_ZEDIPAR_MDLTIM_4], [INP].[ZEDIPAR].[PUBGES_0] AS [INP_ZEDIPAR_PUBGES_0], [INP].[ZEDIPAR].[PUBANA_0] AS [INP_ZEDIPAR_PUBANA_0], [INP].[ZEDIPAR].[FLGBAS_0] AS [INP_ZEDIPAR_FLGBAS_0], [INP].[ZEDIPAR].[FLGQTY_0] AS [INP_ZEDIPAR_FLGQTY_0], [INP].[ZEDIPAR].[FLGNUM_0] AS [INP_ZEDIPAR_FLGNUM_0], [INP].[ZEDIPAR].[FLGXLS_0] AS [INP_ZEDIPAR_FLGXLS_0], [INP].[ZEDIPAR].[FLGPAC_0] AS [INP_ZEDIPAR_FLGPAC_0], [INP].[ZEDIPAR].[COLOR_0] AS [INP_ZEDIPAR_COLOR_0], [INP].[ZEDIPAR].[DSCBPS_0] AS [INP_ZEDIPAR_DSCBPS_0], [INP].[ZEDIPAR].[ROWID] AS [INP_ZEDIPAR_ROWID], [INP].[ZEDIPAR].[CREUSR_0] AS [INP_ZEDIPAR_CREUSR_0], [INP].[ZEDIPAR].[UPDUSR_0] AS [INP_ZEDIPAR_UPDUSR_0], [INP].[ZEDIPAR].[CREDATTIM_0] AS [INP_ZEDIPAR_CREDATTIM_0], [INP].[ZEDIPAR].[UPDDATTIM_0] AS [INP_ZEDIPAR_UPDDATTIM_0], [INP].[ZEDIPAR].[AUUID_0] AS [INP_ZEDIPAR_AUUID_0], [INP].[ZEDIPAR].[UPDTICK_0] AS [INP_ZEDIPAR_UPDTICK_0] 
FROM [INP].[ZEDIPAR] 
WHERE [INP].[ZEDIPAR].[ENAFLG_0] = %(ENAFLG_0_1)s AND [INP].[ZEDIPAR].[FTPFLG_0] = %(FTPFLG_0_1)s
2025-08-17 15:46:03,364 - INFO - sqlalchemy.engine.Engine - [generated in 0.00140s] {'ENAFLG_0_1': <Chapter1.YES: 2>, 'FTPFLG_0_1': <Chapter1.YES: 2>}
2025-08-17 15:46:03,392 - INFO - src.services.provider_service - Encontrados 1 fornecedores ativos.
2025-08-17 15:46:03,393 - INFO - sqlalchemy.engine.Engine - ROLLBACK
2025-08-17 15:46:03,438 - INFO - __main__ - Fornecedores carregados com sucesso:
2025-08-17 15:46:07,160 - INFO - src.services.transfer_service - A iniciar processamento para o fornecedor: 1526 com código de protocolo: '1'
2025-08-17 15:46:07,161 - INFO - src.services.strategies - Fornecedor '1526' usará a classe de estratégia: FranceMessagerieStrategy
2025-08-17 15:46:07,162 - INFO - src.transfer.ftp_manager - A conectar ao servidor FTP em ftpexport.presstalis.fr:21...
2025-08-17 15:46:07,364 - INFO - src.transfer.ftp_manager - Conexão FTP com 'ftpexport.presstalis.fr' estabelecida com sucesso.
2025-08-17 15:46:07,364 - INFO - src.services.strategies - [1526] A executar a estratégia de transferência padrão.
2025-08-17 15:46:44,689 - INFO - src.transfer.ftp_manager - Listar ficheiros em '/'...
2025-08-17 15:50:24,810 - INFO - src.config.logging - Logging configurado. Root level: DEBUG. Handlers: console, info_file, error_file
2025-08-17 15:50:24,810 - INFO - __main__ - Iniciando o backend de transferência de ficheiros...
2025-08-17 15:50:24,810 - INFO - src.services.provider_service - A buscar configurações de fornecedores ativos via ORM...
2025-08-17 15:50:25,009 - INFO - sqlalchemy.engine.Engine - select @@version
2025-08-17 15:50:25,009 - INFO - sqlalchemy.engine.Engine - [raw sql] {}
2025-08-17 15:50:25,024 - INFO - sqlalchemy.engine.Engine - SELECT schema_name()
2025-08-17 15:50:25,024 - INFO - sqlalchemy.engine.Engine - [generated in 0.00057s] {}
2025-08-17 15:50:25,092 - INFO - sqlalchemy.engine.Engine - SELECT CAST('test max support' AS NVARCHAR(max))
2025-08-17 15:50:25,093 - INFO - sqlalchemy.engine.Engine - [generated in 0.00045s] {}
2025-08-17 15:50:25,110 - INFO - sqlalchemy.engine.Engine - SELECT 1 FROM fn_listextendedproperty(default, default, default, default, default, default, default)
2025-08-17 15:50:25,110 - INFO - sqlalchemy.engine.Engine - [generated in 0.00038s] {}
2025-08-17 15:50:25,163 - INFO - sqlalchemy.engine.Engine - BEGIN (implicit)
2025-08-17 15:50:25,176 - INFO - sqlalchemy.engine.Engine - SELECT [INP].[ZEDIPAR].[BPRNUM_0] AS [INP_ZEDIPAR_BPRNUM_0], [INP].[ZEDIPAR].[BPRNAM_0] AS [INP_ZEDIPAR_BPRNAM_0], [INP].[ZEDIPAR].[ENAFLG_0] AS [INP_ZEDIPAR_ENAFLG_0], [INP].[ZEDIPAR].[BPRID_0] AS [INP_ZEDIPAR_BPRID_0], [INP].[ZEDIPAR].[FTPFLG_0] AS [INP_ZEDIPAR_FTPFLG_0], [INP].[ZEDIPAR].[FTPTYP_0] AS [INP_ZEDIPAR_FTPTYP_0], [INP].[ZEDIPAR].[FTPURL_0] AS [INP_ZEDIPAR_FTPURL_0], [INP].[ZEDIPAR].[FTPUSR_0] AS [INP_ZEDIPAR_FTPUSR_0], [INP].[ZEDIPAR].[FTPPSW_0] AS [INP_ZEDIPAR_FTPPSW_0], [INP].[ZEDIPAR].[FTPMOD_0] AS [INP_ZEDIPAR_FTPMOD_0], [INP].[ZEDIPAR].[FTPINP_0] AS [INP_ZEDIPAR_FTPINP_0], [INP].[ZEDIPAR].[FTPOUT_0] AS [INP_ZEDIPAR_FTPOUT_0], [INP].[ZEDIPAR].[FTPFOR_0] AS [INP_ZEDIPAR_FTPFOR_0], [INP].[ZEDIPAR].[FTPTRT_0] AS [INP_ZEDIPAR_FTPTRT_0], [INP].[ZEDIPAR].[FTPFIC_0] AS [INP_ZEDIPAR_FTPFIC_0], [INP].[ZEDIPAR].[FTPEXP_0] AS [INP_ZEDIPAR_FTPEXP_0], [INP].[ZEDIPAR].[FTPUNI_0] AS [INP_ZEDIPAR_FTPUNI_0], [INP].[ZEDIPAR].[DRTINP_0] AS [INP_ZEDIPAR_DRTINP_0], [INP].[ZEDIPAR].[EXTINP_0] AS [INP_ZEDIPAR_EXTINP_0], [INP].[ZEDIPAR].[DRTOUT_0] AS [INP_ZEDIPAR_DRTOUT_0], [INP].[ZEDIPAR].[EXTOUT_0] AS [INP_ZEDIPAR_EXTOUT_0], [INP].[ZEDIPAR].[FICEXT_0] AS [INP_ZEDIPAR_FICEXT_0], [INP].[ZEDIPAR].[FICSEP_0] AS [INP_ZEDIPAR_FICSEP_0], [INP].[ZEDIPAR].[FICFLG_0] AS [INP_ZEDIPAR_FICFLG_0], [INP].[ZEDIPAR].[FICFLG_1] AS [INP_ZEDIPAR_FICFLG_1], [INP].[ZEDIPAR].[FICFLG_2] AS [INP_ZEDIPAR_FICFLG_2], [INP].[ZEDIPAR].[FICFLG_3] AS [INP_ZEDIPAR_FICFLG_3], [INP].[ZEDIPAR].[FICFLG_4] AS [INP_ZEDIPAR_FICFLG_4], [INP].[ZEDIPAR].[FICFLG_5] AS [INP_ZEDIPAR_FICFLG_5], [INP].[ZEDIPAR].[FICFLG_6] AS [INP_ZEDIPAR_FICFLG_6], [INP].[ZEDIPAR].[FICFLG_7] AS [INP_ZEDIPAR_FICFLG_7], [INP].[ZEDIPAR].[FICFLG_8] AS [INP_ZEDIPAR_FICFLG_8], [INP].[ZEDIPAR].[FICFLG_9] AS [INP_ZEDIPAR_FICFLG_9], [INP].[ZEDIPAR].[FICPRE_0] AS [INP_ZEDIPAR_FICPRE_0], [INP].[ZEDIPAR].[FICPRE_1] AS [INP_ZEDIPAR_FICPRE_1], [INP].[ZEDIPAR].[FICPRE_2] AS [INP_ZEDIPAR_FICPRE_2], [INP].[ZEDIPAR].[FICPRE_3] AS [INP_ZEDIPAR_FICPRE_3], [INP].[ZEDIPAR].[FICPRE_4] AS [INP_ZEDIPAR_FICPRE_4], [INP].[ZEDIPAR].[FICPRE_5] AS [INP_ZEDIPAR_FICPRE_5], [INP].[ZEDIPAR].[FICPRE_6] AS [INP_ZEDIPAR_FICPRE_6], [INP].[ZEDIPAR].[FICPRE_7] AS [INP_ZEDIPAR_FICPRE_7], [INP].[ZEDIPAR].[FICPRE_8] AS [INP_ZEDIPAR_FICPRE_8], [INP].[ZEDIPAR].[FICPRE_9] AS [INP_ZEDIPAR_FICPRE_9], [INP].[ZEDIPAR].[FICCOU_0] AS [INP_ZEDIPAR_FICCOU_0], [INP].[ZEDIPAR].[FICCOU_1] AS [INP_ZEDIPAR_FICCOU_1], [INP].[ZEDIPAR].[FICCOU_2] AS [INP_ZEDIPAR_FICCOU_2], [INP].[ZEDIPAR].[FICCOU_3] AS [INP_ZEDIPAR_FICCOU_3], [INP].[ZEDIPAR].[FICCOU_4] AS [INP_ZEDIPAR_FICCOU_4], [INP].[ZEDIPAR].[FICCOU_5] AS [INP_ZEDIPAR_FICCOU_5], [INP].[ZEDIPAR].[FICCOU_6] AS [INP_ZEDIPAR_FICCOU_6], [INP].[ZEDIPAR].[FICCOU_7] AS [INP_ZEDIPAR_FICCOU_7], [INP].[ZEDIPAR].[FICCOU_8] AS [INP_ZEDIPAR_FICCOU_8], [INP].[ZEDIPAR].[FICCOU_9] AS [INP_ZEDIPAR_FICCOU_9], [INP].[ZEDIPAR].[FICDES_0] AS [INP_ZEDIPAR_FICDES_0], [INP].[ZEDIPAR].[FICDES_1] AS [INP_ZEDIPAR_FICDES_1], [INP].[ZEDIPAR].[FICDES_2] AS [INP_ZEDIPAR_FICDES_2], [INP].[ZEDIPAR].[FICDES_3] AS [INP_ZEDIPAR_FICDES_3], [INP].[ZEDIPAR].[FICDES_4] AS [INP_ZEDIPAR_FICDES_4], [INP].[ZEDIPAR].[FICDES_5] AS [INP_ZEDIPAR_FICDES_5], [INP].[ZEDIPAR].[FICDES_6] AS [INP_ZEDIPAR_FICDES_6], [INP].[ZEDIPAR].[FICDES_7] AS [INP_ZEDIPAR_FICDES_7], [INP].[ZEDIPAR].[FICDES_8] AS [INP_ZEDIPAR_FICDES_8], [INP].[ZEDIPAR].[FICDES_9] AS [INP_ZEDIPAR_FICDES_9], [INP].[ZEDIPAR].[FICPRO_0] AS [INP_ZEDIPAR_FICPRO_0], [INP].[ZEDIPAR].[FICPRO_1] AS [INP_ZEDIPAR_FICPRO_1], [INP].[ZEDIPAR].[FICPRO_2] AS [INP_ZEDIPAR_FICPRO_2], [INP].[ZEDIPAR].[FICPRO_3] AS [INP_ZEDIPAR_FICPRO_3], [INP].[ZEDIPAR].[FICPRO_4] AS [INP_ZEDIPAR_FICPRO_4], [INP].[ZEDIPAR].[FICPRO_5] AS [INP_ZEDIPAR_FICPRO_5], [INP].[ZEDIPAR].[FICPRO_6] AS [INP_ZEDIPAR_FICPRO_6], [INP].[ZEDIPAR].[FICPRO_7] AS [INP_ZEDIPAR_FICPRO_7], [INP].[ZEDIPAR].[FICPRO_8] AS [INP_ZEDIPAR_FICPRO_8], [INP].[ZEDIPAR].[FICPRO_9] AS [INP_ZEDIPAR_FICPRO_9], [INP].[ZEDIPAR].[FICDIR_0] AS [INP_ZEDIPAR_FICDIR_0], [INP].[ZEDIPAR].[FICDIR_1] AS [INP_ZEDIPAR_FICDIR_1], [INP].[ZEDIPAR].[FICDIR_2] AS [INP_ZEDIPAR_FICDIR_2], [INP].[ZEDIPAR].[FICDIR_3] AS [INP_ZEDIPAR_FICDIR_3], [INP].[ZEDIPAR].[FICDIR_4] AS [INP_ZEDIPAR_FICDIR_4], [INP].[ZEDIPAR].[FICDIR_5] AS [INP_ZEDIPAR_FICDIR_5], [INP].[ZEDIPAR].[FICDIR_6] AS [INP_ZEDIPAR_FICDIR_6], [INP].[ZEDIPAR].[FICDIR_7] AS [INP_ZEDIPAR_FICDIR_7], [INP].[ZEDIPAR].[FICDIR_8] AS [INP_ZEDIPAR_FICDIR_8], [INP].[ZEDIPAR].[FICDIR_9] AS [INP_ZEDIPAR_FICDIR_9], [INP].[ZEDIPAR].[FICDAT_0] AS [INP_ZEDIPAR_FICDAT_0], [INP].[ZEDIPAR].[FICDAT_1] AS [INP_ZEDIPAR_FICDAT_1], [INP].[ZEDIPAR].[FICDAT_2] AS [INP_ZEDIPAR_FICDAT_2], [INP].[ZEDIPAR].[FICDAT_3] AS [INP_ZEDIPAR_FICDAT_3], [INP].[ZEDIPAR].[FICDAT_4] AS [INP_ZEDIPAR_FICDAT_4], [INP].[ZEDIPAR].[FICDAT_5] AS [INP_ZEDIPAR_FICDAT_5], [INP].[ZEDIPAR].[FICDAT_6] AS [INP_ZEDIPAR_FICDAT_6], [INP].[ZEDIPAR].[FICDAT_7] AS [INP_ZEDIPAR_FICDAT_7], [INP].[ZEDIPAR].[FICDAT_8] AS [INP_ZEDIPAR_FICDAT_8], [INP].[ZEDIPAR].[FICDAT_9] AS [INP_ZEDIPAR_FICDAT_9], [INP].[ZEDIPAR].[FICDEL_0] AS [INP_ZEDIPAR_FICDEL_0], [INP].[ZEDIPAR].[FICDEL_1] AS [INP_ZEDIPAR_FICDEL_1], [INP].[ZEDIPAR].[FICDEL_2] AS [INP_ZEDIPAR_FICDEL_2], [INP].[ZEDIPAR].[FICDEL_3] AS [INP_ZEDIPAR_FICDEL_3], [INP].[ZEDIPAR].[FICDEL_4] AS [INP_ZEDIPAR_FICDEL_4], [INP].[ZEDIPAR].[FICDEL_5] AS [INP_ZEDIPAR_FICDEL_5], [INP].[ZEDIPAR].[FICDEL_6] AS [INP_ZEDIPAR_FICDEL_6], [INP].[ZEDIPAR].[FICDEL_7] AS [INP_ZEDIPAR_FICDEL_7], [INP].[ZEDIPAR].[FICDEL_8] AS [INP_ZEDIPAR_FICDEL_8], [INP].[ZEDIPAR].[FICDEL_9] AS [INP_ZEDIPAR_FICDEL_9], [INP].[ZEDIPAR].[FICFOR_0] AS [INP_ZEDIPAR_FICFOR_0], [INP].[ZEDIPAR].[FICFOR_1] AS [INP_ZEDIPAR_FICFOR_1], [INP].[ZEDIPAR].[FICFOR_2] AS [INP_ZEDIPAR_FICFOR_2], [INP].[ZEDIPAR].[FICFOR_3] AS [INP_ZEDIPAR_FICFOR_3], [INP].[ZEDIPAR].[FICFOR_4] AS [INP_ZEDIPAR_FICFOR_4], [INP].[ZEDIPAR].[FICFOR_5] AS [INP_ZEDIPAR_FICFOR_5], [INP].[ZEDIPAR].[FICFOR_6] AS [INP_ZEDIPAR_FICFOR_6], [INP].[ZEDIPAR].[FICFOR_7] AS [INP_ZEDIPAR_FICFOR_7], [INP].[ZEDIPAR].[FICFOR_8] AS [INP_ZEDIPAR_FICFOR_8], [INP].[ZEDIPAR].[FICFOR_9] AS [INP_ZEDIPAR_FICFOR_9], [INP].[ZEDIPAR].[FICNUM_0] AS [INP_ZEDIPAR_FICNUM_0], [INP].[ZEDIPAR].[FICNUM_1] AS [INP_ZEDIPAR_FICNUM_1], [INP].[ZEDIPAR].[FICNUM_2] AS [INP_ZEDIPAR_FICNUM_2], [INP].[ZEDIPAR].[FICNUM_3] AS [INP_ZEDIPAR_FICNUM_3], [INP].[ZEDIPAR].[FICNUM_4] AS [INP_ZEDIPAR_FICNUM_4], [INP].[ZEDIPAR].[FICNUM_5] AS [INP_ZEDIPAR_FICNUM_5], [INP].[ZEDIPAR].[FICNUM_6] AS [INP_ZEDIPAR_FICNUM_6], [INP].[ZEDIPAR].[FICNUM_7] AS [INP_ZEDIPAR_FICNUM_7], [INP].[ZEDIPAR].[FICNUM_8] AS [INP_ZEDIPAR_FICNUM_8], [INP].[ZEDIPAR].[FICNUM_9] AS [INP_ZEDIPAR_FICNUM_9], [INP].[ZEDIPAR].[PEREDI_0] AS [INP_ZEDIPAR_PEREDI_0], [INP].[ZEDIPAR].[PEREDI_1] AS [INP_ZEDIPAR_PEREDI_1], [INP].[ZEDIPAR].[PEREDI_2] AS [INP_ZEDIPAR_PEREDI_2], [INP].[ZEDIPAR].[PEREDI_3] AS [INP_ZEDIPAR_PEREDI_3], [INP].[ZEDIPAR].[PEREDI_4] AS [INP_ZEDIPAR_PEREDI_4], [INP].[ZEDIPAR].[PEREDI_5] AS [INP_ZEDIPAR_PEREDI_5], [INP].[ZEDIPAR].[PEREDI_6] AS [INP_ZEDIPAR_PEREDI_6], [INP].[ZEDIPAR].[PEREDI_7] AS [INP_ZEDIPAR_PEREDI_7], [INP].[ZEDIPAR].[PEREDI_8] AS [INP_ZEDIPAR_PEREDI_8], [INP].[ZEDIPAR].[PEREDI_9] AS [INP_ZEDIPAR_PEREDI_9], [INP].[ZEDIPAR].[PERIODI_0] AS [INP_ZEDIPAR_PERIODI_0], [INP].[ZEDIPAR].[PERIODI_1] AS [INP_ZEDIPAR_PERIODI_1], [INP].[ZEDIPAR].[PERIODI_2] AS [INP_ZEDIPAR_PERIODI_2], [INP].[ZEDIPAR].[PERIODI_3] AS [INP_ZEDIPAR_PERIODI_3], [INP].[ZEDIPAR].[PERIODI_4] AS [INP_ZEDIPAR_PERIODI_4], [INP].[ZEDIPAR].[PERIODI_5] AS [INP_ZEDIPAR_PERIODI_5], [INP].[ZEDIPAR].[PERIODI_6] AS [INP_ZEDIPAR_PERIODI_6], [INP].[ZEDIPAR].[PERIODI_7] AS [INP_ZEDIPAR_PERIODI_7], [INP].[ZEDIPAR].[PERIODI_8] AS [INP_ZEDIPAR_PERIODI_8], [INP].[ZEDIPAR].[PERIODI_9] AS [INP_ZEDIPAR_PERIODI_9], [INP].[ZEDIPAR].[MDL_0] AS [INP_ZEDIPAR_MDL_0], [INP].[ZEDIPAR].[MDL_1] AS [INP_ZEDIPAR_MDL_1], [INP].[ZEDIPAR].[MDL_2] AS [INP_ZEDIPAR_MDL_2], [INP].[ZEDIPAR].[MDL_3] AS [INP_ZEDIPAR_MDL_3], [INP].[ZEDIPAR].[MDL_4] AS [INP_ZEDIPAR_MDL_4], [INP].[ZEDIPAR].[MDLTIM_0] AS [INP_ZEDIPAR_MDLTIM_0], [INP].[ZEDIPAR].[MDLTIM_1] AS [INP_ZEDIPAR_MDLTIM_1], [INP].[ZEDIPAR].[MDLTIM_2] AS [INP_ZEDIPAR_MDLTIM_2], [INP].[ZEDIPAR].[MDLTIM_3] AS [INP_ZEDIPAR_MDLTIM_3], [INP].[ZEDIPAR].[MDLTIM_4] AS [INP_ZEDIPAR_MDLTIM_4], [INP].[ZEDIPAR].[PUBGES_0] AS [INP_ZEDIPAR_PUBGES_0], [INP].[ZEDIPAR].[PUBANA_0] AS [INP_ZEDIPAR_PUBANA_0], [INP].[ZEDIPAR].[FLGBAS_0] AS [INP_ZEDIPAR_FLGBAS_0], [INP].[ZEDIPAR].[FLGQTY_0] AS [INP_ZEDIPAR_FLGQTY_0], [INP].[ZEDIPAR].[FLGNUM_0] AS [INP_ZEDIPAR_FLGNUM_0], [INP].[ZEDIPAR].[FLGXLS_0] AS [INP_ZEDIPAR_FLGXLS_0], [INP].[ZEDIPAR].[FLGPAC_0] AS [INP_ZEDIPAR_FLGPAC_0], [INP].[ZEDIPAR].[COLOR_0] AS [INP_ZEDIPAR_COLOR_0], [INP].[ZEDIPAR].[DSCBPS_0] AS [INP_ZEDIPAR_DSCBPS_0], [INP].[ZEDIPAR].[ROWID] AS [INP_ZEDIPAR_ROWID], [INP].[ZEDIPAR].[CREUSR_0] AS [INP_ZEDIPAR_CREUSR_0], [INP].[ZEDIPAR].[UPDUSR_0] AS [INP_ZEDIPAR_UPDUSR_0], [INP].[ZEDIPAR].[CREDATTIM_0] AS [INP_ZEDIPAR_CREDATTIM_0], [INP].[ZEDIPAR].[UPDDATTIM_0] AS [INP_ZEDIPAR_UPDDATTIM_0], [INP].[ZEDIPAR].[AUUID_0] AS [INP_ZEDIPAR_AUUID_0], [INP].[ZEDIPAR].[UPDTICK_0] AS [INP_ZEDIPAR_UPDTICK_0] 
FROM [INP].[ZEDIPAR] 
WHERE [INP].[ZEDIPAR].[ENAFLG_0] = %(ENAFLG_0_1)s AND [INP].[ZEDIPAR].[FTPFLG_0] = %(FTPFLG_0_1)s
2025-08-17 15:50:25,178 - INFO - sqlalchemy.engine.Engine - [generated in 0.00156s] {'ENAFLG_0_1': <Chapter1.YES: 2>, 'FTPFLG_0_1': <Chapter1.YES: 2>}
2025-08-17 15:50:25,200 - INFO - src.services.provider_service - Encontrados 1 fornecedores ativos.
2025-08-17 15:50:25,200 - INFO - sqlalchemy.engine.Engine - ROLLBACK
2025-08-17 15:50:25,250 - INFO - __main__ - Fornecedores carregados com sucesso:
2025-08-17 15:50:28,617 - INFO - src.services.transfer_service - A iniciar processamento para o fornecedor: 1526 com código de protocolo: '1'
2025-08-17 15:50:28,617 - INFO - src.services.strategies - Fornecedor '1526' usará a classe de estratégia: FranceMessagerieStrategy
2025-08-17 15:50:28,617 - INFO - src.transfer.ftp_manager - A conectar ao servidor FTP em ftpexport.presstalis.fr:21...
2025-08-17 15:50:28,819 - INFO - src.transfer.ftp_manager - Conexão FTP com 'ftpexport.presstalis.fr' estabelecida com sucesso.
2025-08-17 15:50:28,819 - INFO - src.services.strategies - [1526] A executar a estratégia de transferência padrão.
2025-08-17 15:50:34,074 - INFO - src.transfer.ftp_manager - Listar ficheiros em '/'...
2025-08-17 15:51:11,696 - INFO - src.services.strategies - [1526] Filtro aplicado. Encontrados 1 ficheiros para download com o padrão "F4010010.*".
2025-08-17 15:52:43,446 - INFO - src.services.strategies - [1526] A receber ficheiro: //F4010010.37 -> [EDI]\IMPORT\1526\F4010010.37
2025-08-17 15:52:50,832 - INFO - src.transfer.ftp_manager - Iniciar download de '//F4010010.37' para '[EDI]\IMPORT\1526\F4010010.37'...
2025-08-17 15:52:51,150 - INFO - src.transfer.ftp_manager - Download concluído com sucesso.
2025-08-17 15:53:08,643 - INFO - src.services.strategies - [1526] Download de //F4010010.37 bem-sucedido. A remover ficheiro remoto.
2025-08-17 15:53:36,197 - INFO - src.transfer.ftp_manager - A remover ficheiro remoto: //F4010010.37
2025-08-17 15:53:58,558 - INFO - src.transfer.ftp_manager - Ficheiro '//F4010010.37' removido com sucesso.
2025-08-17 15:54:03,816 - INFO - src.services.strategies - [1526] Ficheiro remoto '' removido com sucesso.
2025-08-17 15:54:27,837 - WARNING - src.services.strategies - [1526] Diretório de output local não encontrado: [EDI]\EXPORT\1526
2025-08-17 15:54:58,003 - INFO - src.transfer.ftp_manager - Conexão FTP com 'ftpexport.presstalis.fr' fechada.
2025-08-17 15:54:59,616 - INFO - src.services.transfer_service - Processamento para o fornecedor 1526 concluído com sucesso.
